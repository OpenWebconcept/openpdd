var ReadSpeaker;(ReadSpeaker=void 0===ReadSpeaker?{}:ReadSpeaker).FormReader=function(){function n(){this.findFieldSet=function(e,r){var t=null;if(r){var a=!/FORM/.test(r.nodeName)&&r.ownerDocument;if(e&&a){var n=r.ownerDocument;if(n)for(var s=r;e!==s&&n!==s;){if(/FIELDSET/.test(s.nodeName)){t=s;break}s=s.parentNode}}}return t},this.getLegend=function(e){if(rspkr.item("formReader.customLegend"))return rspkr.item("formReader.customLegend",void 0,!0).apply(window,[e]);var r="",e=e.querySelector("legend");return e&&(r=rspkr.Util.explodeTitle(e.innerHTML,"abbr","title"),rspkr.formReader.highlight.markup(e)),r}}rspkr.features.formreader=!0;var v=Object.freeze({INPUT_BUTTON:"button",INPUT_CHECKBOX:"checkbox",INPUT_DATALIST:"textDatalist",INPUT_GENERIC:"input",INPUT_RADIO:"radio",INPUT_RANGE:"range",INPUT_RESET:"reset",INPUT_SUBMIT:"submit",SELECT:"select",BUTTON:"button",TEXTAREA:"textarea"});function s(l,c,d,s){var u=[],o=null,f=!1,p=null;function m(e){g(e.target)}function g(e){var r=k(e);if(r)switch(r){case v.INPUT_CHECKBOX:e.addEventListener("focus",i),e.addEventListener("change",i);break;case v.INPUT_RADIO:case v.SELECT:e.addEventListener("change",n),e.addEventListener("focus",n);break;case v.INPUT_GENERIC:case v.INPUT_DATALIST:e.addEventListener("change",a),e.addEventListener("focus",a);break;case v.BUTTON:e.addEventListener("focus",t)}}function t(e){!f&&h(e.target)&&r(l,e.target,function(e,r,t){s.sayInputStart(e,"",t)})}function a(n){rspkr.log("FormReader::inputCallback, event of "+n.target.name+"1"),!f&&h(n.target)&&r(l,n.target,function(e,r,t,a){/focus/.test(n.type)?(n.target.oldValue=e,s.sayInputStart(e,r,t,a)):e.trim().length&&(n.target.oldValue,s.sayInputEnd(e,r,t,a))})}function n(a){rspkr.log("selectCallback, event of "+a.target.name,"1"),rspkr.formReader.highlight.kill(),!f&&h(a.target)&&r(l,a.target,function(e,r,t){/focus/.test(a.type)?s.saySelectStart(e,r,t):s.saySelectEnd(e,r,t)})}function i(a){rspkr.log("checkboxCallback, event of "+a.target.name,"1"),!f&&h(a.target)&&(/change/.test(a.type)&&(o=null),r(l,a.target,function(e,r,t){/focus/.test(a.type)?s.sayCheckStart(e,r,t):s.sayCheckEnd(e,r,t)}))}function r(e,r,t){rspkr.formReader.highlight.kill();var a=d.findFieldSet(e,r),n="";!a||o&&a===o||(n=d.getLegend(a)),o=a;a=c.getLabelText(r,!0);t(function(e,r){var t="";switch(k(r)){case v.SELECT:var a=r.selectedIndex;if(0<=a)if(r.selectedOptions)for(var n=0;n<r.selectedOptions.length;n++)t+=r.selectedOptions[n].innerText+", ";else t=r.options[a].innerText;break;case v.INPUT_RADIO:var a=d.findFieldSet(e,r),s=[];s=a?a.querySelectorAll('input[type="'+r.type+'"]:checked'):(a=r.name,e.querySelectorAll('input[name="'+a+'"]:checked'));for(var o=0;o<s.length;o++){var i=s[o];t+=c.getLabelText(i,!1)}break;case v.INPUT_CHECKBOX:!0===r.checked&&(t+=c.getLabelText(r,!1));break;case v.BUTTON:t=r.innerText;break;case v.INPUT_DATALIST:case v.INPUT_GENERIC:default:t=r.value}return t}(e,r),a,n,r)}function h(e){var r=[rspkr.cls.skip,rspkr.cls.skipalways];if(!$rs.arraySearch(Array.from(e.classList),r)){e=d.findFieldSet(e.form,e);return e&&$rs.arraySearch(Array.from(e.classList),r)?void 0:1}}function k(e){var r="";return/INPUT/.test(e.nodeName)?r=/radio/i.test(e.type)?v.INPUT_RADIO:/checkbox/i.test(e.type)?v.INPUT_CHECKBOX:e.list?v.INPUT_DATALIST:v.INPUT_GENERIC:/TEXTAREA/i.test(e.nodeName)?r=v.INPUT_GENERIC:/SELECT/i.test(e.nodeName)?r=v.SELECT:/BUTTON/i.test(e.nodeName)&&(r=v.BUTTON),r}this.enable=function(){rspkr.log("FormReader::enable","1");for(var e=l.elements||l.querySelectorAll("input, select, textarea"),r=l.querySelectorAll("button"),t=0;t<r.length;t++){for(var a=r[t],n=!1,s=0;s<e.length;s++)a===e[s]&&(n=!0);n||u.push(a)}for(var o=0;o<e.length;o++)u.push(e[o]);for(var i=0;i<u.length;i++)g(u[i]);f=!1,void 0!==window.MutationObserver?(p=new MutationObserver(function(e){for(var r=0;r<e.length;r++)for(var t=e[r],a=0;a<t.addedNodes.length;a++)g(t.addedNodes[a])})).observe(l,{attributes:!1,childList:!0,subtree:!0}):(console.warn("MutationObserver is not supported"),l.addEventListener("DOMNodeInserted",m,!1))},this.disable=function(){rspkr.log("FormReader::disable","1");for(var e=0;e<u.length;e++){var r=u[e];switch(k(r)){case v.INPUT_CHECKBOX:case v.INPUT_RADIO:case v.SELECT:r.removeEventListener("change",n);break;case v.INPUT_GENERIC:case v.INPUT_DATALIST:}}p&&(p.disconnect(),p=null),l.removeEventListener("DOMNodeInserted",m)},this.pause=function(){f=!0},this.resume=function(){f=!1}}function o(s,o,i,l){var c=[],e=[],r=[],t=this,a=i;this.Player=function(){return a},this.enableForSelector=function(a){rspkr.log("FormReaderService::enableForSelector "+a,"1");var n=[];$rs.getReadingFrames().forEach(function(e){try{for(var r=e.document.querySelectorAll(a),t=0;t<r.length;t++)n.push(r[t])}catch(e){}}),n.forEach(function(e){for(var r,t=!1,a=0;a<c.length;a++)if(c[a]===e){t=!0;break}t||((r=new l(e,o,s,i)).enable(),c.push(r))}),e.forEach(function(e){e()})},this.enableForAllForms=function(){t.enableForSelector("form")},this.pause=function(){rspkr.log("FormReaderService::pause ","1"),c.forEach(function(e){e.pause()})},this.resume=function(){rspkr.log("FormReaderService::resume ","1"),c.forEach(function(e){e.resume()})},this.disable=function(){rspkr.log("FormReaderService::disable ","1"),c.forEach(function(e){e.disable()}),c=[],r.forEach(function(e){e()})},this.isEnabled=function(){return 0<c.length},this.highlight={init:function(){rspkr.Common.addEvent("onAPIStop",rspkr.formReader.highlight.clean),rspkr.Common.addEvent("onUIClosePlayer",rspkr.formReader.highlight.clean)},markup:function(e){e.classList.add("rs-fr-highlight")},go:function(){document.querySelectorAll(".rs-fr-highlight").forEach(function(e){var r=e.style.backgroundColor;r&&e.setAttribute("data-rs-fr-originalColor",r),e.style.backgroundColor=rspkr.st.get("hlsent"),e.classList.remove("rs-fr-highlight"),e.classList.add("rs-fr-highlighted")})},clean:function(){document.querySelectorAll(".rs-fr-highlighted").forEach(function(e){var r=e.getAttribute("data-rs-fr-originalColor");r?e.style.backgroundColor=r:e.style.removeProperty("background-color")})},kill:function(){rspkr.formReader.highlight.clean(),document.querySelectorAll(".rs-fr-highlighted").forEach(function(e){e.classList.remove("rs-fr-highlighted")})}}}function i(){this.getLabelText=function(e,r){if(rspkr.item("formReader.customLabel"))return rspkr.item("formReader.customLabel",void 0,!0).apply(window,[e]);var t="";return function(e,r){var t=[];if(r.labels&&Array.from)t=Array.from(r.labels);else{var a=r.ownerDocument,n=e.getElementsByTagName("label");if(a)for(var s=0;s<n.length;s++){var o=n[s],i=o.htmlFor;i.trim().length&&(i=a.getElementById(i),r===i&&t.push(o))}if(0===t.length)for(var l=0;l<n.length;l++)for(var c=n[l],d=0;d<c.children.length;d++){var u=c.children[d];r===u&&t.push(c)}}return t}(e.form,e).forEach(function(e){t+=rspkr.Util.explodeTitle(e.innerHTML,"abbr","title")+" ",r&&rspkr.formReader.highlight.markup(e)}),t=t.substring(0,t.length-1)}}function l(){function n(e,r){rspkr.formReader.messageQueue||(rspkr.formReader.messageQueue=[]),rspkr.formReader.messageQueue.push([e,r]),rspkr.formReader.messageQueue.sort(function(e,r){return e[1]-r[1]}),clearTimeout(rspkr.formReader.queueTimer),rspkr.formReader.queueTimer=setTimeout(function(){var e=$rs.createElm("div",{content:rspkr.formReader.messageQueue.map(function(e){return $rs.createElm("div",{content:e[0]}).outerHTML+". "}).join("")});rspkr.formReader.messageQueue.length=0,function(e){var r=document.querySelector("#fr-message");r=r||$rs.createElm("hidden",{id:"fr-message",cls:"rs-no-scroll",parent:document.body,attributes:{style:"position: absolute; left: -10000px; width: 0px; height: 0px;"}});r.innerHTML=e,rspkr.c.data.selectedHTML="",rspkr.c.data.selectedText="";e=rspkr.findHref();e=rspkr.setParam("readclass","",e),e=rspkr.setParam("readid","fr-message",e),e=rspkr.setParam("dict",rspkr.item("formReader.dict")||"forms",e),e=rspkr.setParam("stattype",rspkr.item("formReader.stattype")||"formReader",e),rspkr.pl.releaseAdapter(),rspkr.item("ui.preventPlaybackFocus",!0),rspkr.formReader.highlight.go(),window.readpage(e,void 0,{source:"formreader",usePost:!0,noCleanUp:!0})}(e.outerHTML)},100)}this.sayInputStart=function(e,r,t,a){rspkr.log("Player::sayInputStart- value: "+e+", label:"+r+", fieldset:"+t,"1"),n(a.disabled||a.readOnly?t+": "+rspkr.Lang.getPhrase("formreader-disabled")+": "+r+": "+(e||""):"password"===a.getAttribute("type")?t+": "+r+": "+rspkr.Lang.getPhrase("formreader-protected"):t+": "+rspkr.Lang.getPhrase("formreader-pleaseenter")+" "+r+" "+(e||""),2)},this.sayInputEnd=function(e,r,t,a){rspkr.log("Player::sayInputEnd- value: "+e+", label:"+r+", fieldset:"+t,"1"),n("password"===a.getAttribute("type")?rspkr.Lang.getPhrase("formreader-protected"):rspkr.Lang.getPhrase("formreader-youwrote")+" "+e,1)},this.saySelectStart=function(e,r,t){rspkr.log("Player::saySelectStart- value: "+e+", label:"+r+", fieldset:"+t,"1"),n(t+", "+rspkr.Lang.getPhrase("formreader-pleaseselect")+": "+r,1)},this.saySelectEnd=function(e,r,t){rspkr.log("Player::saySelectEnd- value: "+e+", label:"+r+", fieldset:"+t,"1"),n(rspkr.Lang.getPhrase("formreader-youselected")+": "+e,2)},this.sayCheckStart=function(e,r,t){rspkr.log("Player::saySelectStart- value: "+e+", label:"+r+", fieldset:"+t,"1"),n(t+", "+r,2)},this.sayCheckEnd=function(e,r,t){rspkr.log("Player::saySelectEnd- value: "+e+", label:"+r+", fieldset:"+t,"1"),n(e.trim().length?t+", "+rspkr.Lang.getPhrase("formreader-youchecked")+": "+r:t+", "+rspkr.Lang.getPhrase("formreader-youunchecked")+": "+r,1)}}return{FieldSetProducer:n,FormElementType:v,FormReader:s,FormReaderService:o,FormReaderServiceBuilder:function(){var e,r,t,a;this.build=function(){return e=e||new l,t=t||s,r=r||new n,a=a||new i,new o(r,a,e,t)}},LabelProducer:i,Player:l}}(),rspkr.formReader=(new ReadSpeaker.FormReader.FormReaderServiceBuilder).build(),rspkr.formReader.highlight.init(),ReadSpeaker&&ReadSpeaker.q&&ReadSpeaker.q(function(){function e(e){for(var r=e?[e]:document.querySelectorAll(".rsbtn_toolpanel"),t=0;t<r.length;t++)if(!r[t].querySelector(".rsbtn_tool_formreader")){var a=$rs.createElm("li",{cls:"rsbtn_tool_formreader",content:$rs.createElm("button",{cls:"rsbtn_tool",attributes:{"data-rslang":"title/arialabel:formreader-formreading","data-rs-tool":"formreader","data-rsshortcut":"formreading"},content:[$rs.createElm("span",{cls:"rsicn rsicn-formreader",attributes:{"aria-hidden":"true"}}),$rs.createElm("span",{cls:"rsbtn_btnlabel",attributes:{"data-rslang":"content:formreader-formreading"}})]})});rspkr.RTL&&(a=rspkr.RTL.transformMenuItem(a));for(var n=[".rsbtn_tool_enlarge",".rsbtn_tool_click_listen",".rsbtn_tool_download"],s=0;s<n.length;s++){var o=r[t].querySelector(n[s]);if(o&&o.nextElementSibling){o.parentNode.insertBefore(a,o.nextElementSibling);break}}a.parentNode||r[t].querySelector("ul").appendChild(a),rspkr.st.get(c)===d&&a.querySelector("button").classList.add("active"),!0!==rspkr.item("ui.toolbar.horizontal")&&rspkr.ui.utils.addMiniToggler(a.querySelector("button")),rspkr.Lang.updateUi(r[t]),a.querySelector("button").addEventListener("click",function(e){rspkr.preventDefault(e),this.classList.contains("active")?(this.classList.remove("active"),l()):(this.classList.add("active"),i())})}}function i(){rspkr.st.set(c,d);var e=rspkr.item("formReader.formSelector");rspkr.formReader.isEnabled()||(e?rspkr.formReader.enableForSelector(e):rspkr.formReader.enableForAllForms()),rspkr.formReader.resume()}function l(){rspkr.st.set(c,t),rspkr.formReader.isEnabled()&&rspkr.formReader.pause()}var r,c="fr",d="fron",t="froff";rspkr.mobile()?(r={phrase:"ph_formreader-formreading",type:"radio",info:"ph_frinfo",options:[{value:d,phrase:"ph_on"},{value:t,phrase:"ph_off"}]},rspkr.cfg.getSettingsConf().general.items.fr=r,ReadSpeaker.Common.addEvent("onSettingsChanged",function(e,r){e===c&&(r===d?i:l)()})):(rspkr.evt("onBeforeMenuInserted",e),e());var a,n="",s=rspkr.FormReader.FormElementType;for(a in s)s.hasOwnProperty(a)&&(n+=","+s[a]);rspkr.item("general.preserveElements",rspkr.item("general.preserveElements")+n),(rspkr.st.get(c)===d?i:l)()});