ReadSpeaker.Common=function(){function e(){var e,t=rspkr.item("extraMods")||[],r=0,s=0;for(e in t)t.hasOwnProperty(e)&&(rspkr.mobile()&&!1===t[e].mobile||(s++,rspkr.log("[rspkr.c.loadExtraMods] Loading in additional mod: "+e),rspkr.rsload.load({id:"rsmod_"+e,type:"js"===t[e].type?"text/javascript":"text/css",src:(t[e].revDir?rspkr.revPath:"")+rspkr.rootNS+"."+e+"."+t[e].type,cb:function(){++r===s&&window.rspkr.devt("onAfterExtraModsLoaded",window)},async:!0})))}function t(e,t,r){r&&a(e,t);for(var s=0,n=(t=!$rs.isArray(t)?[t]:t).length;s<n;s++)o[e].push(t[s])}function a(e,t){if(/function|object/i.test(typeof t)){for(var r,s=0,n=(t=!$rs.isArray(t)?[t]:t).length;s<n;s++)if(r=t[s],o[e])for(var a=o[e].length-1;0<=a;a--)r===o[e][a]&&o[e].splice(a,1)}else o[e]&&(o[e]=[])}var o={onAdapterReady:[],onInit:[],onCoreLoaded:[],onModsLoaded:[],onAfterModsLoaded:[],onAfterExtraModsLoaded:[],onConfigLoaded:[],onLangLoaded:[],onNativeLoaded:[],onLangUpdated:[],onUiUpdated:[],onDOMReady:[],onReady:[],onSelectedText:[],onDeselectedText:[],onBeforeQueueExecuted:[],onAfterQueueExecuted:[],onBeforeSettingsOpened:[],onSettingsInitialized:[],onSettingsChanged:[],onSettingsLoaded:[],onSettingsClosed:[],onSpeedChanged:[],onVolumeChanged:[],onVoiceChanged:[],onBeforeMenuInserted:[],onBeforeLightboxOpened:[],onAfterLightboxOpened:[],onLightboxClosed:[],onLightboxFontChanged:[],onTextModeLoaded:[],onDialogTabChanged:[],onTextSettingChanged:[],onVoiceParamsSet:[],onPageMaskOpened:[],onPageMaskClosed:[],onDownloadLoaded:[],onUIInitialized:[],onUIBeforePlay:[],onUIAfterPlay:[],onUIPause:[],onUIStop:[],onUIShowPlayer:[],onUIClosePlayer:[],onUIAfterControlPanel:[],onResized:[],onDragDropFinished:[],onResizeFinished:[],onAPIPlay:[],onAPIPause:[],onAPIStop:[],onAPIVolumeUp:[],onAPIVolumeDown:[],onAPIMute:[],onAPIFastForward:[],onAPIRewind:[],onAPISetProgress:[],onAPIGetProgress:[],onAPIInitAdapter:[],onAPIReleaseAdapter:[],onLazyLoadFinished:[],onBeforeSyncInit:[],onAfterSyncInit:[],onBeforeSync:[],onAfterSync:[],onBeforeSyncExit:[],onAfterSyncExit:[],onBeforeContentChange:[],onAfterContentChange:[],onBeforeGetAudioLink:[],onBeforeParamsSet:[],onAfterParamsSet:[],onAudioLoadError:[],onVolumeAdjusted:[],onChunkResume:[],onBeforeToolsOpen:[],onAfterToolsOpen:[],onBeforeToolsClose:[],onAfterToolsClose:[],onToolsInitialized:[],onToolClicked:[]},i={speed:function(e,t){if(!isNaN(parseInt(e)))return parseInt(e);var r=parseInt(t||rspkr.item("general.defaultSpeedValue")||100),s=parseInt(rspkr.item("general.defaultSlowSpeedValue")||r-25),n=parseInt(rspkr.item("general.defaultFastSpeedValue")||r+25);switch(e){case"slow":return s;case"medium":return r;case"fast":return n;default:return r}}},p={audioLink:null,params:{},tempParams:{},postContent:"",postLink:null,processedDocument:null,saveLink:null,selectedHTML:"",selectedText:"",selectedRange:null,selectedDocument:document,sync:"wordsent",syncLink:null,browser:{name:"",version:"",OS:"",html5AudioFormat:"",html5Support:!1,html5Priority:!1,syncContainer:""},setParams:function(e){if(rspkr.log("[rspkr.c.data.setParams] "+e),"string"==typeof(e=e||rspkr.findHref())){this.params={};e=e.split("?");rspkr.item("general.servercall",e[0]);for(var t=e[1].split(/[;&]/),r=0;r<t.length;r++)if((a=t[r].split("="))&&2===a.length){var s=decodeURIComponent(a[0]),n=decodeURIComponent(a[1]),a=decodeURIComponent(a[1]);if("url"!==s||a.length){if("url"===s)n=encodeURIComponent(decodeURIComponent(a));else if("lang"===s&&2===a.length)p.params.lang=rspkr.Lang.formatLangCode(a);else if("readid"===s||"readclass"===s){for(var o=n.split(","),i=[],l=0;l<o.length;l++)-1===function(e,t){for(var r=0,s=e.length;r<s;r++)if(e[r]===t)return r;return-1}(i,o[l])&&i.push(o[l]);n=i.join(",")}}else n=encodeURIComponent(document.location.href);this.params[s]=n}this.params.rsjs_ver=rspkr.getVersion(),this.params.synccontainer=this.browser.syncContainer,this.params.url||(this.params.url=encodeURIComponent(document.location.href)),this.params.readid=this.params.readid||"",!this.params.ignoreUserVoice&&rspkr.item("general.userDefinedLang")&&(this.params.lang=rspkr.item("general.userDefinedLang")),!this.params.ignoreUserVoice&&rspkr.item("general.userDefinedVoice")&&(this.params.voice=rspkr.item("general.userDefinedVoice")),delete this.params.ignoreUserVoice,(rspkr.c.data.selectedText||rspkr.c.data.selectedHTML)&&(delete this.params.readid,delete this.params.readclass),rspkr.Common.dispatchEvent("onAfterParamsSet")}},setRegion:function(){var e=rspkr.getRSBtns(),t=e.length?e[0]:void 0;t&&(e=$rs.findIn(t,".rsbtn_play"),t=$rs.isArray(e)?$rs.getAttr(e[0],"href"):$rs.getAttr(e,"href"),e=document.createElement("a"),$rs.setAttr(e,"href",t),1<(t=e.hostname.split(".")[0].split("-")).length&&"readspeaker"===e.hostname.split(".")[1]&&(rspkr.item("general.region",t[1]),rspkr.log("[rspkr.c.data.setRegion] Setting region to "+t[1])))},setWrapiUrl:function(){if(!rspkr.item("general.wrapiUrl")){var e=rspkr.item("general.region"),e="https://app-%REGION%.readspeaker.com/webreader/v1/".replace("%REGION%",e||"eu");return rspkr.item("general.wrapiUrl",e),rspkr.log("[rspkr.c.data.setWrapiUrl] Setting Wrapi URL to "+e),e}},mergeTempParams:function(e){return Object.size(p.tempParams)&&(rspkr.cfg.mergeObj(p.tempParams,e),p.tempParams=[]),e},setDefaultValues:function(){rspkr.log("[rspkr.c.data.setDefaultValues] Called!"),rspkr.Common.data.selectedHTML="",rspkr.Common.data.saveLink=null},setPostContent:function(e){"string"==typeof e&&(e="textsel"===e?this.selectedHTML:!0===rspkr.item("general.postSettings.useExistingMarkup")?p.getReadingContent(!1):p.getReadingContent(rspkr.hl&&rspkr.hl.Restore.hasMarkup()),this.postContent=r.encode(e))},searchLangAttr:function(e){if(e.hasAttribute&&(e.hasAttribute("lang")||e.hasAttribute("xml:lang")))return e.getAttribute("lang");for(var t=$rs.parent(e),r=document.getElementsByTagName("body")[0];t&&t!==r;){if(t.hasAttribute&&t.hasAttribute("lang"))return t.getAttribute("lang");if(t.hasAttribute&&t.hasAttribute("xml:lang"))return t.getAttribute("xml:lang");t=$rs.parent(t)}return""},searchVoiceAttr:function(e){return e.getAttribute&&/voice-family/i.test(e.getAttribute("style"))?e.getAttribute("style"):$rs.parent(e)&&$rs.parent(e)!==document.body?this.searchVoiceAttr($rs.parent(e)):""},searchButtonByReadArea:function(e){for(var t,r=[],s=0,n=rspkr.getRSBtns();t=n[s];s++){var a=rspkr.findHref(t,{scopedSearch:!0});if(a){var o=rspkr.getParam("readid",a),a=rspkr.getParam("readclass",a);if(o)for(var i=0,l=o.split(",");c=l[i];i++){var c=document.querySelector("#"+c);c&&c.contains(e)&&r.push(t)}if(a)for(var p,d=0,u=a.split(",");p=u[d];d++)for(var h,g=document.querySelectorAll("."+p),m=0;h=g[m];m++)h.contains(e)&&r.push(t)}}return r},getDefaultReadElements:function(){var r=[],t=[];rspkr.c.data.params.hasOwnProperty("readid")&&rspkr.c.data.params.readid&&rspkr.c.data.params.readid.length&&(t=t.concat(("#"+rspkr.c.data.params.readid.split(",").filter(function(e){return e.length}).join(",#")).split(","))),rspkr.c.data.params.hasOwnProperty("readclass")&&rspkr.c.data.params.readclass.length&&(t=t.concat(("."+rspkr.c.data.params.readclass.split(",").filter(function(e){return e.length}).join(",.")).split(",")));var e=$rs.getReadingFrames(window);rspkr.item("general.readidOrder")&&rspkr.item("general.usePost")?t.forEach(function(t){e.forEach(function(e){try{r=r.concat($rs.arr(t,e.document))}catch(e){}})}):e.forEach(function(e){try{r=r.concat($rs.arr(t.join(","),e.document))}catch(e){}});for(var s=r.length-1;0<=s;s--)for(var n=0;n<r.length;n++)r[s]!==r[n]&&r[n].contains(r[s])&&r.splice(s,1);return rspkr.math&&rspkr.math.check(r),r},getReadingContent:function(e){var t=[],r="";!0===e&&!0!==rspkr.hl.engine.useTextNodeMarkup&&rspkr.hl.sync.fullCleanUp(),t=p.getDefaultReadElements(),$rs.isArray(t)||(t=[t]);for(var s,n=0;s=t[n];n++){for(var a=s.nodeName&&"TABLE"===s.nodeName?"TABLE":"DIV",o=s.attributes,i="",l=o.length;l--;){var c=o[l];"data-"!==c.name.substr(0,5)&&(i+=" "+c.name+'="'+c.value+'"')}rspkr.shadowDOM.active()&&(s=$rs.createElm("div",{content:rspkr.shadowDOM.expandHTML(s)}).childNodes[0]),r+="<"+a+i+">"+(rspkr.Util.xhtml.detect()?rspkr.Util.xhtml.innerHTML(s):s.innerHTML)+"</"+a+">"}return r=p.cleanSkippedContent(r),r=p.cleanSecretContent(r)},cleanSkippedContent:function(e,t){t=t||{};var r=document.createElement("div");r.innerHTML=e.replace(/style=/gi,"rs_ztylez=").replace(/ font-family:.*?;/gi,"");e=rspkr.selector.skip+rspkr.selector.preserve;t.cleanAlwaysSkipped&&(e=rspkr.selector.skipalways),t.cleanAllSkipped&&(e=rspkr.selector.skip+", "+rspkr.selector.skipalways);var s=$rs.findIn(r,e);$rs.isArray(s)||(s=[s]);for(var n,a,o=0;n=s[o];o++)n.innerHTML="";return(t.cleanHidden||!0!==rspkr.hl.engine.useTextNodeMarkup&&rspkr.item("general.skipHiddenContent"))&&(r.style.position="absolute",r.style.left="10000px",document.body.appendChild(r),(a=function(e){for(var t,r=e.childNodes,s=0;t=r[s];s++)rspkr.hl.clientMarkup.skipHidden(t)?t.innerHTML="":a(t)})(r),document.body.removeChild(r)),r.innerHTML.replace(/rs_ztylez=/gi,"style=")},cleanSecretContent:function(e){if(!e)return e;for(var t=$rs.createElm("div",{content:e}),r=rspkr.selector.secret+", "+rspkr.selector.secret+"_tmp";t.querySelector(r);){var s=t.querySelector(r);$rs.parent(s).removeChild(s)}return $rs.removeClass($rs.arr(rspkr.selector.secret+"_tmp"),rspkr.cls.secret+"_tmp"),t.innerHTML},cleanTextMarkup:function(e,o){(o=o||{}).selector||(o.selector=""),o.purgeSelector||(o.purgeSelector=""),o.removeEmpty||(o.removeEmpty=!1);e=$rs.createElm("div",{content:e});return function e(t,r){if(0<(r=r||0)&&t.nodeType===Node.ELEMENT_NODE&&t.matches(o.purgeSelector)||o.removeEmpty&&0===t.textContent.trim().length)return $rs.parent(t).removeChild(t),1;if(t.nodeType===Node.TEXT_NODE&&(t.textContent=t.textContent.trim()+" "),t.nodeType===Node.ELEMENT_NODE){for(var s=t.childNodes,n=0;n<s.length;n++)e(s[n],r+1)&&n--;if(0<r){if(!t.matches(o.selector)){for(var a=$rs.parent(t);t.firstChild;)a.insertBefore(t.firstChild,t);return a.removeChild(t),1}for(;0<t.attributes.length;)t.removeAttributeNode(t.attributes[0])}}}(e),e.innerHTML},clearSelectedText:function(){$rs.getReadingFrames(window).forEach(function(e){try{e.getSelection&&e.getSelection().removeAllRanges(),e.document.selection&&e.document.selection.empty()}catch(e){}}),this.selectedHTML="",this.selectedText="",this.selectedRange=null,this.selectedDocument=document},setSelectedText:function(e){this.selectedText="";var t,r,s,n,a,o=e&&e.view?e.view.document:this.getDocumentElement(),i=o.getSelection();(!i.isCollapsed||11===o.nodeType&&i.rangeCount)&&(i.getRangeAt?(r=i.getRangeAt(0),s=i.getRangeAt(i.rangeCount-1),(t=document.createRange()).setStart(r.startContainer,r.startOffset),t.setEnd(s.endContainer,s.endOffset)):((t=document.createRange()).setStart(i.anchorNode,i.anchorOffset),t.setEnd(i.focusNode,i.focusOffset)),t?(r=t.cloneContents(),(s=document.createElement("div")).appendChild(r.cloneNode(!0)),this.selectedText=s.innerHTML,rspkr.math&&rspkr.math.check([s])):this.selectedText=i),this.selectedRange=t,rspkr.hl.engine.useTextNodeMarkup&&t?(this.selectionBackupData={startContainer:t.startContainer,endContainer:t.endContainer,startOffset:t.startOffset,endOffset:t.endOffset},$rs.parent(this.selectedRange.startContainer).className===rspkr.cls.textnode&&1<$rs.parent(this.selectedRange.startContainer).childNodes.length&&(this.selectionBackupData.startNodePosition=Array.prototype.indexOf.call($rs.parent($rs.parent(this.selectedRange.startContainer)).childNodes,$rs.parent(this.selectedRange.startContainer))),this.selectedRange.endContainer!==this.selectedRange.startContainer&&$rs.parent(this.selectedRange.endContainer).className===rspkr.cls.textnode&&1<$rs.parent($rs.parent(this.selectedRange.endContainer)).childNodes.length&&(this.selectionBackupData.endNodePosition=Array.prototype.indexOf.call($rs.parent($rs.parent(this.selectedRange.endContainer)).childNodes,$rs.parent(this.selectedRange.endContainer))),n=function(e,t){t&&(rspkr.c.data.tmpNodeOffset=0);var r=e.childNodes;if(r&&r.length)for(var s=0;s<r.length;s++)3===r[s].nodeType?(r[s]===rspkr.c.data.selectedRange.startContainer&&(rspkr.c.data.selectionBackupData.startOffsetNormalized=rspkr.c.data.tmpNodeOffset+rspkr.c.data.selectedRange.startOffset),r[s]===rspkr.c.data.selectedRange.endContainer&&(rspkr.c.data.selectionBackupData.endOffsetNormalized=rspkr.c.data.tmpNodeOffset+rspkr.c.data.selectedRange.endOffset),rspkr.c.data.tmpNodeOffset+=r[s].textContent.length):n(r[s])},$rs.parent(this.selectedRange.startContainer).nodeName.toLowerCase()===rspkr.c.data.browser.syncContainer.toLowerCase()&&(a=$rs.closest(this.selectedRange.startContainer,rspkr.selector.textnode),this.selectionBackupData.startNodePosition=Array.prototype.indexOf.call($rs.parent(a).childNodes,a),n(a,!0)),this.selectedRange.endContainer!==this.selectedRange.startContainer&&$rs.parent(this.selectedRange.endContainer).nodeName.toLowerCase()===rspkr.c.data.browser.syncContainer.toLowerCase()&&(a=$rs.closest(this.selectedRange.endContainer,rspkr.selector.textnode),this.selectionBackupData.endNodePosition=Array.prototype.indexOf.call($rs.parent(a).childNodes,a),n(a,!0)),delete rspkr.c.data.tmpNodeOffset):delete this.selectionBackupData,0<o.getSelection().rangeCount?this.selectedText.length&&o.getSelection().getRangeAt&&o.getSelection().getRangeAt(0)&&o.getSelection().getRangeAt(0).toString().length&&e?(this.selectedDocument=o,c("onSelectedText",o.defaultView,[e])):(this.selectedText="",c("onDeselectedText",o.defaultView,["empty"])):this.selectedText.length&&e?(this.selectedDocument=o,c("onSelectedText",o.defaultView,[e])):c("onDeselectedText",o.defaultView,["empty"]),rspkr.log("[rspkr.c.setSelectedText] Selected text length is "+this.selectedText.length)},getDocumentElement:function(){var e=document.getSelection();if(e.isCollapsed||e.rangeCount<1){for(var t=rspkr.shadowDOM.getShadows(),r=t.length-1;0<=r;r--)if(t[r].shadowRoot.getSelection&&0<t[r].shadowRoot.getSelection().rangeCount)return t[r].shadowRoot;for(var s=$rs.getReadingFrames(window),n=0;n<s.length;n++)try{if(s[n].getSelection&&0<s[n].getSelection().rangeCount&&!s[n].getSelection().isCollapsed)return s[n].document}catch(e){rspkr.error("Error getting document: "+e)}}return window.document},getParam:function(e){return this.params&&this.params[e]&&void 0!==this.params[e]?this.params[e]:null},getParams:function(){return this.params},getPostContent:function(){return this.postContent},getSelectedText:function(){return this.selectedText},getParamObject:function(e){var t,r,s={};for(t in this.params)this.params.hasOwnProperty(t)&&(s[t]=this.params[t]);for(t in e)e.hasOwnProperty(t)&&(s[t]=e[t]);return r=this.getSpeedParam(s.speed),isNaN(r)||(s.speed=r),s},getSpeedParam:function(e){var t=i.speed(rspkr.Common.Settings.get("hlspeed"),e||void 0);return e=100!==t?t:e},getAudioLink:function(e,t,r){rspkr.devt("onBeforeGetAudioLink",window),t=t||rspkr.HL,this.audioLink=null;var s=!1;if(rspkr.math&&rspkr.math.found()&&rspkr.math.addParams(),!0!==rspkr.hl.engine.useTextNodeMarkup||this.selectedText.length||this.selectedHTML.length)this.selectedText.length?(t.clientMarkup.preProcess.init(),e.sync="user",e.syncalignuser=rspkr.st.get("hl"),this.setPostContent("textsel"),(s=!0)!==r&&(this.audioLink=d.issuePost(this.getParamObject(e)))):!0===rspkr.item("general.premarkup")?(e.sync="user",this.setPostContent("nosel"),s=!0===rspkr.pub.Config.item("general.usePost"),!0!==r&&(!0===rspkr.pub.Config.item("general.usePost")?this.audioLink=d.issuePost(this.getParamObject(e)):this.audioLink=l(this.getParamObject(e)))):!0===rspkr.pub.Config.item("general.usePost")?(rspkr.mobile()&&!0===rspkr.item("general.postSettings.useExistingMarkup")?(e.sync="user",""!==this.selectedHTML||""!==this.selectedText?this.setPostContent("textsel"):this.setPostContent("nosel")):(e.sync="wordsent",this.setPostContent("nosel")),(s=!0)!==r&&(this.audioLink=d.issuePost(this.getParamObject(e)))):(e.sync="wordsent",!0!==r&&(this.audioLink=l(this.getParamObject(e))));else if(t.clientMarkup.preProcess.init(),e.sync="user",this.setPostContent("nosel"),(s=!0)!==r)return this.audioLink=d.issuePost(this.getParamObject(e)),{link:this.audioLink,params:this.getParamObject(e),usePost:!0};return rspkr.log("[rspkr.c.data.getAudioLink] Audio link: "+this.audioLink),!0===r?(this.audioLink=l(this.getParamObject(e)),{link:this.audioLink,params:this.getParamObject(e),usePost:s}):this.audioLink},setSettingsChanged:function(e){"hlspeed"===e&&(rspkr.c.data.settingsChanged=!0)},settingsChanged:!1,getSaveData:function(e,t){rspkr.log("[rspkr.c.data.getSaveData]"),e=e||"link",t=t||!1;var r,s=this.saveLink;if(!this.saveLink||this.settingsChanged||t){t&&rspkr.c.data.setParams(t),rspkr.c.data.params.customerid||(r=$rs.get(rspkr.rsbtnClass(!0)),(r=$rs.isArray(r)&&r.length?r[0]:r)&&rspkr.c.data.setParams($rs.getAttr($rs.findIn(r,".rsbtn_play"),"href")));var n,a={},o={audioformat:"mp3"};for(n in this.settingsChanged=!1,"iOS"!==this.browser.OS&&"dialog"===e&&(o.save="1"),this.params)this.params.hasOwnProperty(n)&&(a[n]=this.params[n]);for(n in o)o.hasOwnProperty(n)&&(a[n]=o[n]);a.speed=i.speed(rspkr.st.get("hlspeed"),a.speed),s=this.selectedHTML.length?(this.setPostContent("textsel"),d.issuePost(a)):!0===rspkr.item("general.usePost")?(this.setPostContent("nosel"),d.issuePost(a)):l(a),t||(this.saveLink=s)}return s}},l=function(e){var t,r,s="";for(r in s=void 0!==rspkr.item("general.servercall")?rspkr.item("general.servercall")+"?":(t=$rs.get(rspkr.rsbtnClass(!0)),t=$rs.isArray(t)?t[0]:t,$rs.getAttr($rs.findIn(t,".rsbtn_play"),"href").split("?")[0]+"?"),e)e.hasOwnProperty(r)&&e[r]&&(s+=r+"="+e[r]+"&");return s=s.substr(0,s.length-1),s=e.useProxy?rspkr.item("general.wrapiUrl")+"?cat="+e.useProxy+"&pl="+encodeURIComponent(s):s,rspkr.item("general.customProxy")?rspkr.item("general.customProxy")+encodeURIComponent(s):s},c=function(e,t,r){if(o[e]){if(r=r||[],rspkr.displog[e]=rspkr.displog[e]?++rspkr.displog[e]:1,!o[e].length)return rspkr.log("[rspkr.c] Dispatched event: "+e+" - no handlers to call.",1),!0;rspkr.log("[rspkr.c] Dispatching event: "+e,1);for(var s=o[e].length-1;0<=s;s--)if(o[e].hasOwnProperty(s)&&"function"==typeof o[e][s])try{"__self__"===t&&(t=o[e][s]),o[e][s].apply(t,r)}catch(e){rspkr.error("[rspkr.c._dispatchEvent] Error: "+e.message),this.isok=!1}else if("object"==typeof o[e][s])try{var n=o[e][s];n.func.apply(n.context||window,n.params||r)}catch(e){this.isok=!1}}else rspkr.error("[rspkr.c] Undefined event: "+e)},d={getPostData:function(e){e=p.mergeTempParams(e);var t,r=rspkr.c.post.getRsCall(!1),s=[];for(t in e[p.getSelectedText().length?"selectedhtml_base64":"html_base64"]=p.getPostContent(),e)e.hasOwnProperty(t)&&s.push(t+"="+encodeURIComponent(decodeURIComponent(e[t])));return{rsCall:r,params:e,data:s.join("&")}},getRsCall:function(e,t){var r,s=t,n=rspkr.c.data.params,t=void 0!==rspkr.item("general.servercall")?rspkr.item("general.servercall")+"?":(a=$rs.get(rspkr.rsbtnClass(!0)),a=$rs.isArray(a)?a[0]:a,$rs.getAttr($rs.findIn(a,".rsbtn_play"),"href").split("?")[0]+"?"),a=("string"==typeof(a=t)&&a.length?a.split("/").pop():rspkr.pub.Config.item("general.rsent")).replace("?","");return t=t&&t.match(/[^\/]*\/\/[^\/]*/),!0===e?(r=rspkr.item("general.iframeproxy")?rspkr.item("general.iframeproxy"):"/enterprise/iframeproxy.php",r=t?t.pop()+r+"?rsent="+a+"&version="+rspkr.pub.Config.item("general.proxyVersion"):rspkr.pub.Config.item("general.protocol")+"//"+rspkr.pub.Config.item("general.subdomain")+"."+rspkr.pub.Config.item("general.domain")+r+"?rsent="+rspkr.pub.Config.item("general.rsent")+"&version="+rspkr.pub.Config.item("general.proxyVersion"),r+="&randid="+s,n.customerid&&(r+="&customerid="+n.customerid)):(r=t.pop()+"/cgi-bin/"+a,r+="?logid="+n.customerid+"&ver="+rspkr.meta.version),r+=n.wrc?"&wrc="+n.wrc:"",r=n.useProxy?rspkr.item("general.wrapiUrl")+"?cat="+n.useProxy+"&pl="+encodeURIComponent(r):r,rspkr.item("general.customProxy")?rspkr.item("general.customProxy")+encodeURIComponent(r):r},issuePost:function(e){rspkr.log("[rspkr.c] Using POST"),document.getElementById("ReadSpeakerPostIframe")||this.createIframe(),e=p.mergeTempParams(e);var t=Math.random(),r=this.createForm(e),s=rspkr.c.post.getRsCall(!0,t);r.action=s;e=document.createElement("textarea");return 1<p.getSelectedText().length?e.setAttribute("name","selectedhtml_base64"):e.setAttribute("name","html_base64"),e.innerHTML=p.getPostContent(),r.appendChild(e),setTimeout(function(){document.body.appendChild(r),r.submit(),document.body.removeChild(r)},0),s+"&listen=1&randid="+t},createForm:function(e){var t,r,s=document.createElement("form");for(t in s.target="ReadSpeakerPostIframe"+rspkr.item("general.random"),s.method="post",e)e.hasOwnProperty(t)&&((r=document.createElement("input")).setAttribute("name",t),"url"===t?r.setAttribute("value",decodeURIComponent(e[t])):r.setAttribute("value",e[t]),s.appendChild(r));var n=document.createElement("input");return n.setAttribute("name","output"),n.setAttribute("value","audiolink"),s.appendChild(n),s},createIframe:function(){if(!rspkr.item("general.random")){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;r<20;r++)e+=t.charAt(Math.floor(Math.random()*t.length));rspkr.item("general.random",e)}var s=null;if(document.selection)try{s=document.createElement('<iframe name="ReadSpeakerPostIframe'+rspkr.item("general.random")+'">')}catch(e){s=document.createElement("iframe")}else s=document.createElement("iframe");s.setAttribute("name","ReadSpeakerPostIframe"+rspkr.item("general.random")),s.setAttribute("id","ReadSpeakerPostIframe"),s.style.display="none",s.style.position="absolute",s.setAttribute("sandbox","allow-scripts"),s.style.display="none";var n=document.getElementsByTagName("body"),a=null;(a=n.length?n.item(0):a)&&a.appendChild(s)},removeIframe:function(){document.getElementById("ReadSpeakerPostIframe")}},r={encode:function(e){if("function"==typeof btoa)return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}));for(var t=encodeURIComponent(e),r=0,s=0,n=[];r<t.length;r++)t.charCodeAt(r)!=="%".charCodeAt(0)?n[s]=t.charCodeAt(r):(n[s]=parseInt("0x"+t.charAt(r+1)+t.charAt(r+2)),r+=2),s++;for(var e=n.length,a="",o=parseInt(e/3),e=e-3*o,r=0;r<3*o;r+=3)a+=this.chars(n[r]>>2),a+=this.chars((3&n[r])<<4|n[r+1]>>4),a+=this.chars((15&n[r+1])<<2|n[r+2]>>6),a+=this.chars(63&n[r+2]);return 1==e&&(a+=this.chars(n[r]>>2),a+=this.chars((3&n[r])<<4),a+="=",a+="="),2==e&&(a+=this.chars(n[r]>>2),a+=this.chars((3&n[r])<<4|n[r+1]>>4),a+=this.chars((15&n[r+1])<<2),a+="="),a},decode:function(e){if("function"==typeof atob)return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));for(var t="",r="",s=0,n=0,a=e.length;s<a;)if(-1!==this.value(e[s])){for(var o=e.substring(s,s+4),n=0,i=0;i<4;i++)"="===o[i]&&n++;for(i=0;i<3-n;i++){0===i?r=this.value(o[0])<<2|(48&this.value(o[1]))>>4:1===i?r=(15&this.value(o[1]))<<4|(60&this.value(o[2]))>>2:2===i&&(r=(3&this.value(o[2]))<<6|this.value(o[3]));var l=r.toString(16);t+="%"+(l=1===l.length?"0"+l:l)}s+=4}else s++;return decodeURIComponent(t)},value:function(e){e=e.charCodeAt(0);return e>="A".charCodeAt(0)&&e<="Z".charCodeAt(0)?e-"A".charCodeAt(0):e>="a".charCodeAt(0)&&e<="z".charCodeAt(0)?e-"a".charCodeAt(0)+26:e>="0".charCodeAt(0)&&e<="9".charCodeAt(0)?e-"0".charCodeAt(0)+52:e==="+".charCodeAt(0)?62:e==="/".charCodeAt(0)?63:-1},chars:function(e){return e<26?String.fromCharCode(e+"A".charCodeAt(0)):e<52?String.fromCharCode(e+"a".charCodeAt(0)-26):e<62?String.fromCharCode(e+"0".charCodeAt(0)-52):62===e?"+":63===e?"/":String.fromCharCode(0)}};return{meta:{revision:"2489"},init:function(){c("onInit",window),o.onInit=[],t("onUIShowPlayer",rspkr.Common.data.setDefaultValues),t("onSettingsChanged",rspkr.Common.data.setSettingsChanged),t("onAfterModsLoaded",e)},addEvent:t,clearEvent:a,base64:r,buildReadSpeakerCall:function(e){return l(e)},data:p,Detect:{init:function(){rspkr.br.init(),p.browser=rspkr.br.info}},dispatchEvent:function(e,t,r){c(e,t,r)},post:d,cookie:{create:function(e,t,r,s,n){if(rspkr.item("general.noCookie"))return!1;-1===r||(r=rspkr.item("general.cookieLifetime")||""),s=s||rspkr.cfg?rspkr.item("general.cookiePath"):"",n=n||rspkr.cfg?rspkr.item("general.cookieDomain"):"";n=e+"="+t+(r?((t=new Date).setTime(t.getTime()+r),"; expires="+t.toGMTString()):"")+(s?"; path="+s:"")+(n?"; domain="+n:"");"https:"===document.location.protocol?n+="; SameSite=None; Secure":n+="; SameSite=Lax";try{return document.cookie=n}catch(e){return!1}},read:function(e){if(rspkr.item("general.noCookie"))return!1;var t,r=e+"=";try{t=document.cookie.split(";")}catch(e){return}for(var s=0;s<t.length;s++){for(var n=t[s];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(r))return n.substring(r.length,n.length)}},readKey:function(e,t){if(rspkr.item("general.noCookie"))return!1;var r,s=this.read(e);if(s)for(var n=0,a=(s=s.split("&")).length;n<a;n++)if((r=s[n].split("="))[0]===t)return r[1]},readKeyAll:function(e){if(rspkr.item("general.noCookie"))return!1;var t,r={};if(s=this.read(e)){for(var s,n=0,a=(s=s.split("&")).length;n<a;n++)r[(t=s[n].split("="))[0]]=t[1];return r}},createSub:function(e,t,r,s,n){if("object"==typeof t){var a,o=[];for(a in t)t.hasOwnProperty(a)&&o.push(a+"="+t[a]);return this.create(e,o.join("&"),r,s,n)}this.create(e,t.toString(),r,s,n)},updateKey:function(e,t,r,s,n,a){if(rspkr.item("general.noCookie"))return!1;if(r=r&&r.toString()){for(var o={},i=!1,l=(l=decodeURIComponent(this.read(e)))&&"null"!==l&&"undefined"!==l?l.split("&"):[],c=0;c<l.length;c++){var p=l[c].split("=");p[0]===t?(i=!0,o[p[0]]=r):o[p[0]]=p[1]}return i||(o[t]=r),this.createSub(e,o,s,n,a)}},deleteKey:function(e,t,r,s,n){if(rspkr.item("general.noCookie"))return!1;var a={},o=!1;if(!(i=decodeURIComponent(this.read(e)))||"null"===i||"undefined"===i)return!1;for(var i=i.split("&"),l=0;l<i.length;l++){var c=i[l].split("=");c[0]!==t?a[c[0]]=c[1]:o=!0}return this.createSub(e,a,r,s,n),o},erase:function(e,t,r){this.create(e,"",-1,t,r)}},converter:i,sorting:{sortArrayByObjKey:function(e,r,s){return e instanceof window.Array&&"string"==typeof r?(s=s||"asc",e.sort(function(e,t){e=e[r].toLowerCase(),t=t[r].toLowerCase();return e<t?"asc"===s?-1:1:t<e?"asc"===s?1:-1:0}),e):null}},findFirstRSButton:function(e){e=e||document.body;for(var t=$rs.get("a, .rsbtn_play"),r=0,s=(t=$rs.isArray(t)?t:[t]).length;r<s;r++){if($rs.hasClass(t[r],"rsbtn_play"))return t[r];if($rs.getAttr(t[r],"href")&&-1!==$rs.getAttr(t[r],"href").indexOf(rspkr.pub.Config.item("general.domain")+"/cgi-bin/"+rspkr.pub.Config.item("general.rsent")))return t[r];if($rs.getAttr(t[r],"href")&&/customerid=/i.test($rs.getAttr(t[r],"href"))&&/lang=/i.test($rs.getAttr(t[r],"href"))&&/(readid|readclass)/i.test($rs.getAttr(t[r],"href")))return t[r]}return!1},decodeEntities:function(e){var t=document.createElement("p");return t.innerHTML=e,e=t.textContent||t.innerText,t=null,e},e:o,createShortcuts:function(){var e=window.ReadSpeaker;e.Common&&(e.c=e.Common),e.c&&(e.evt=e.c.addEvent,e.devt=e.c.dispatchEvent,e.cevt=e.c.clearEvent),e.c&&e.c.Settings&&(e.c.s=e.c.Settings),e.c.s&&(e.st=e.c.s),e.lib&&(e.l=e.lib),e.l&&e.lib.Facade&&(e.l.f=e.lib.Facade),e.l&&e.l.f&&e.l.f.adapter&&(e.l.f.a=e.l.f.adapter),e.modmap&&(e.m=e.modmap),e.PlayerAPI&&(e.pl=e.PlayerAPI),e.HL&&(e.hl=e.HL),e.ui&&(e.u=e.ui),e.ui&&e.ui.DragDrop&&(e.u.dd=e.ui.DragDrop),e.ui&&e.ui.Tools&&(e.u.t=e.ui.Tools)},fileExists:function(e,t,r){var s=this,n=!1;r=r||[],window.XMLHttpRequest?s.xmlHttpReq=new XMLHttpRequest:window.ActiveXObject&&(s.xmlHttpReq=new window.ActiveXObject("Microsoft.XMLHTTP")),s.xmlHttpReq.open("HEAD",e,!0),s.xmlHttpReq.onreadystatechange=function(){4===s.xmlHttpReq.readyState&&(200===s.xmlHttpReq.status&&(n=!0),"function"==typeof t&&(r.unshift(n,e),t.apply(window,r)))},s.xmlHttpReq.send()},useLegacy:function(e){rspkr.Legacy?e():(rspkr.log("[rspkr.c] Loading ReadSpeaker.Legacy.js"),$rs.createElm("script",{attributes:{src:rspkr.baseUrl+rspkr.revPath+"ReadSpeaker.Legacy.js",type:"text/javascript"},parent:document.head}).addEventListener("load",e),$rs.createElm("link",{attributes:{rel:"stylesheet",href:rspkr.baseUrl+rspkr.revPath+"ReadSpeaker.Legacy.css"},parent:document.head}))}}}(),ReadSpeaker.modmap={products:{all:[],custom:function(){var e=[];return e.push(["Custom","text/javascript",!0]),e},customCss:function(){var e=[];return e.push(["Custom","text/css",!0]),e},dr:function(){var e=[];return e.push(["DocReader.AutoAdd","text/javascript"]),e},fr:function(){var e=[];return e.push(["formReader","text/javascript"]),e},expl:function(){var e=this.all;return e.push(["PlayerAPI","text/javascript"],["XP","text/javascript"],["ui","text/javascript",["ui","ui.Slider"]]),e},wr:function(){return this.all},embhl:function(){return this.wr.call(this)},combined:function(){return[]}}},rspkr.shadowDOM=function(){function r(){var e=rspkr.item("general.shadowDomSelector");try{return document.querySelector(e),!0}catch(e){}return!1}var s=["noscript","style","script"];return{active:function(){return r()&&rspkr.hl.engine.useTextNodeMarkup},getShadows:function(e,t){return r()?(e=e||document,t=t||[],e.querySelectorAll(rspkr.item("general.shadowDomSelector")).forEach(function(e){e.shadowRoot&&(t.push(e),rspkr.shadowDOM.getShadows(e.shadowRoot,t))}),t):[]},expandHTML:function(e){if(!this.active())return e.outerHTML;if(3===e.nodeType)return e.textContent;if(8===e.nodeType)return"";if(0<=s.indexOf(e.nodeName.toLowerCase()))return"";if(this.isShadow(e)){var t="";return e.shadowRoot.childNodes.forEach(function(e){t+=rspkr.shadowDOM.expandHTML(e)}),(r=e.cloneNode(!1)).innerHTML=t,r.outerHTML}if(e.querySelector(rspkr.item("general.shadowDomSelector"))){var r,t="";return e.childNodes.forEach(function(e){t+=rspkr.shadowDOM.expandHTML(e)}),(r=e.cloneNode(!1)).innerHTML=t,r.outerHTML}return e.outerHTML},isShadow:function(e){return this.active()&&e.shadowRoot&&e.matches(rspkr.item("general.shadowDomSelector"))}}}(),ReadSpeaker.PlayerAPI=function(){function e(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}var t={html5:{prioritize:!0,audioFormat:null,check:function(){return!!rspkr.c.data.browser.html5Support&&(this.audioFormat=rspkr.c.data.browser.html5AudioFormat,this.prioritize=rspkr.c.data.browser.html5Priority,!0)}},webAudio:{prioritize:!0,audioFormat:"flv",check:function(){return!(!window.AudioContext&&!window.webkitAudioContext)&&(!("Firefox"===rspkr.Browser.info.name&&rspkr.Browser.info.version<40)&&(window.AudioContext||window.webkitAudioContext))}}},r="",s={meta:{revision:"2489"},init:function(){rspkr.log("[rspkr.pl] Initialized!"),rspkr.Common.addEvent("onModsLoaded",function(){rspkr.Common.Detect.init(),rspkr.PlayerAPI.setAdapter()})},setAdapter:function(){r=document.documentMode&&document.documentMode<=9?"fallback":t.webAudio.check()&&t.webAudio.prioritize?"webAudio":t.html5.check()&&t.html5.prioritize?"html5":t.webAudio.check()?"webAudio":t.html5.check()?"html5":"fallback","html5"===rspkr.params.forceAdapter&&(r="html5"),"webAudio"===rspkr.params.forceAdapter&&(r="webAudio"),rspkr.pl[r]&&rspkr.pl[r].adapter?(rspkr.log("[rspkr.pl] Using adapter "+r,1),e(s,rspkr.pl[r].adapter)):(rspkr.error("[rspkr.pl] No adapter detected - using fallback!"),e(s,rspkr.pl.fallback.adapter)),"function"==typeof rspkr.pl[r].init&&rspkr.pl[r].init()},getProduct:function(){return ReadSpeaker.HL||ReadSpeaker.XP||!1}};return s}(),rspkr.PlayerAPI.fallback={init:function(){ReadSpeaker.log("PlayerAPI.fallback heartbeat!")},adapter:{adapter:"fallback"}},ReadSpeaker.Common.Settings=function(){function s(e){return rspkr.Common.cookie.readKey(rspkr.item("general.cookieName"),e)||rspkr.item("settings."+e)||rspkr.cfg.customerDefault("settings."+e)}var e={highlighting:{phrase:"ph_highlighting",icon:"highlighting",tabId:"highlighting",order:1,restore:!0,items:{hltoggle:{phrase:"ph_showhighlighting",type:"radio",info:"ph_info-hltoggle",options:[{value:"hlon",phrase:"ph_on"},{value:"hloff",phrase:"ph_off",dims:["hl","hlword","hlsent","hltext"]}]},hl:{phrase:"ph_highlightingoptions",type:"select",info:"ph_info-hloptions",groupId:"hl-group",options:[{value:"wordsent",phrase:"ph_wordsent"},{value:"sent",phrase:"ph_sentonly",dims:["hlword"]},{value:"word",phrase:"ph_wordonly",dims:["hlsent"]},{value:"none",phrase:"ph_nohighlighting",dims:["hlword","hlsent","hltext"]}]},hlword:{phrase:"ph_wordcolor",type:"colorpicker",info:"ph_info-hlword",groupId:"hl-group",options:[{value:"#beffd6",phrase:"ph_lightgreen"},{value:"#a4cbff",phrase:"ph_lightblue"},{value:"#ffffcc",phrase:"ph_lightyellow"},{value:"#ffff00",phrase:"ph_yellow"},{value:"#ffffff",phrase:"ph_white"},{value:"#000000",phrase:"ph_black"},{value:"#770000",phrase:"ph_darkred"},{value:"#ED0000",phrase:"ph_red"},{value:"underline",phrase:"ph_underline",cls:"underline"},{value:"none",phrase:"ph_none",cls:"none"}]},hlsent:{phrase:"ph_sentcolor",type:"colorpicker",info:"ph_info-hlsent",groupId:"hl-group",options:[{value:"#beffd6",phrase:"ph_lightgreen"},{value:"#a4cbff",phrase:"ph_lightblue"},{value:"#ffffcc",phrase:"ph_lightyellow"},{value:"#ffff00",phrase:"ph_yellow"},{value:"#ffffff",phrase:"ph_white"},{value:"#000000",phrase:"ph_black"},{value:"#770000",phrase:"ph_darkred"},{value:"#ED0000",phrase:"ph_red"},{value:"underline",phrase:"ph_underline",cls:"underline"},{value:"none",phrase:"ph_none",cls:"none"}]},hltext:{phrase:"ph_textcolor",type:"colorpicker",info:"ph_info-hltext",groupId:"hl-group",options:[{value:"#003f00",phrase:"ph_darkgreen"},{value:"#0000aa",phrase:"ph_darkblue"},{value:"#ffff00",phrase:"ph_yellow"},{value:"#ffffff",phrase:"ph_white"},{value:"#000000",phrase:"ph_black"},{value:"#a4cbff",phrase:"ph_lightblue"}]},hlpreview:{phrase:"preview",type:"preview"}}},general:{phrase:"ph_settings-group-misc",tabId:"other",icon:"controls",order:3,restore:!0,items:{hlscroll:{phrase:"ph_autoscroll",type:"radio",info:"ph_info-hlscroll",options:[{value:"scrollon",phrase:"ph_on"},{value:"scrolloff",phrase:"ph_off"}]},hlicon:{phrase:"ph_popupbutton",type:"radio",info:"ph_info-hlicon",groupId:"popup-group",options:[{value:"iconon",phrase:"ph_on"},{value:"iconoff",phrase:"ph_off",dims:["popupclose","popupclosetime"]}],mobile:!1},popupclose:{type:"radio",groupId:"popup-group",phrase:"ph_popupclose",info:"ph_info-popupclose",class:"rs_popupclose",options:[{value:"popupcloseon",phrase:"ph_popupcloseon"},{value:"popupcloseoff",phrase:"ph_popupcloseoff",dims:["popupclosetime"]}],mobile:!1},popupclosetime:{type:"number",groupId:"popup-group",phrase:"popupclosetime",phrase_before:"ph_popupclosetime",phrase_after:"ph_popupclosetimeseconds",class:"rs_popupclosetime",min:1,step:1,unitfactor:1e3,mobile:!1}}},reading:{phrase:"ph_reading",tabId:"reading",icon:"voice",order:2,restore:!0,items:{hlspeed:{phrase:"ph_speed",type:"slider_h",info:"ph_info-hlspeed",options:{dir:"h",max:200,min:5,step:5,initval:100,labelStart:"ph_slow",labelEnd:"ph_fast"}},langvoice:{phrase:"readingvoice",type:"voicePicker",required:"voicesettings",info:"info-langvoice"}},desktop:!1},shortcuts:{tabId:"shortcuts",phrase:"settings-group-shortcuts",icon:"keyboard",order:4,restore:!0,items:{shortcuts:{type:"radio",phrase:"shortcuts-enable",info:"info-shortcuts",groupId:"shortcuts-group",options:[{value:"on",phrase:"yes"},{value:"off",phrase:"no",dims:["keyboard"]}]},keyboard:{type:"shortcutEditor",phrase:"settings-group-shortcuts",info:"info-shortcuts-editing",infoPos:"top",groupId:"shortcuts-group",actionGroups:[{groupPhrase:"shortcuts-group-player",actions:[{action:"play",phrase:"play"},{action:"pause",phrase:"pause"},{action:"stop",phrase:"stop"},{action:"playerfocus",phrase:"shortcuts-item-playerfocus"}]},{groupPhrase:"shortcuts-group-tools",actions:[{action:"menu",phrase:"shortcuts-item-menu"},{action:"settings",phrase:"settings"},{action:"readingvoice",phrase:"readingvoice"},{action:"clicklisten",phrase:"clicklisten"},{action:"enlarge",phrase:"enlargetext"},{action:"formreading",phrase:"formreader-formreading"},{action:"textmode",phrase:"textmode"},{action:"pagemask",phrase:"pagemask"},{action:"download",phrase:"download"},{action:"help",phrase:"help"},{action:"dictionary",phrase:"dictionary"},{action:"translation",phrase:"translation"}]},{groupPhrase:"shortcuts-group-misc",actions:[{action:"controlpanel",phrase:"shortcuts-item-controlpanelfocus"},{action:"fontsizeplus",phrase:"fontsizeplus"},{action:"fontsizeminus",phrase:"fontsizeminus"}]}]}},mobile:!1,legacy:!1},restore:{tabId:"restore",phrase:"ph_restoredefault",phrase_tab:"restore",icon:"restore",order:6,items:{restore:{phrase:"ph_restore",titlephrase:"ph_restoredefault",info:"ph_info-restore",type:"restore"}}},textsettings:{display:!1,items:{lbfontsize:{phrase:"ph_fontsize",type:"select",options:[{value:"0.8",phrase:"-1"},{value:"1.0",phrase:"ph_normal"},{value:"1.2",phrase:"+1"},{value:"1.4",phrase:"+2"},{value:"1.6",phrase:"+3"},{value:"1.8",phrase:"+4"},{value:"2.0",phrase:"+5"},{value:"2.2",phrase:"+6"},{value:"2.4",phrase:"+7"}]},fontface:{phrase:"ph_fontface",type:"select",options:[{value:"serif",phrase:"Times New Roman"},{value:"sansserif",phrase:"Arial"},{value:"cursive",phrase:"Comic Sans"},{value:"monospace",phrase:"Courier New"},{value:"dyslexic",phrase:"Open Dyslexic"}]},textstyle:{phrase:"ph_textstyle",type:"select",options:[{value:"blackyellow",phrase:"ph_blackyellow"},{value:"blackwhite",phrase:"ph_blackwhite"},{value:"blackblue",phrase:"ph_blackblue"},{value:"blackpink",phrase:"ph_blackpink"},{value:"redyellow",phrase:"ph_redyellow"},{value:"redwhite",phrase:"ph_redwhite"},{value:"redblue",phrase:"ph_redblue"},{value:"blueyellow",phrase:"ph_blueyellow"},{value:"bluewhite",phrase:"ph_bluewhite"},{value:"bluepink",phrase:"ph_bluepink"},{value:"yellowblack",phrase:"ph_yellowblack"},{value:"blueblack",phrase:"ph_blueblack"}]},textspacing:{afterload:!0,phrase:"ph_textspacing",type:"slider_h",options:{container:"rs-textspacing",dir:"h",max:4,min:0,step:1,initval:0,labelStart:"Normal",labelEnd:"+4"}}}}};return{meta:{revision:"2489"},get:s,set:function(e,t){if(t===s(e))return null;var r=rspkr.c.cookie.updateKey(rspkr.item("general.cookieName"),e,t);return rspkr.item("settings."+e,t),rspkr.devt("onSettingsChanged",window,[e,t]),r||t},delete:function(e){rspkr.c.cookie.deleteKey(rspkr.item("general.cookieName"),e);var t=rspkr.cfg.default("settings."+e);void 0!==t&&rspkr.item("settings."+e,t)},getSettingsConf:function(){return e}}}(),ReadSpeaker.Preferences=function(){function o(e,t){(e=(e=e instanceof window.NodeList?Array.from(e):e).nodeType?[e]:e).forEach(function(e){e.addEventListener(t||"change",r)})}function r(){var e,t=this.getAttribute("data-pref-key");rspkr.log("[rspkr.Preferences] Setting updated: "+t+" | New value: "+this.value),(a(this)?p:d)(this),"langvoice"===t?(rspkr.item("general.saveLangVoice")?n("langvoice",this.value,this):rspkr.item("general.sessionLangVoice",this.value),e=this.value.split(","),rspkr.Voice.setVoice(e[0],e[1])):(e=(e=this.getAttribute("data-unit-conversion-factor"))&&!isNaN(this.value)?Number(e*this.value):this.value,n(t,e)),"hlword"!==t&&"hlsent"!==t&&"hltext"!==t||rspkr.hl.settings.setHL(),"hlscroll"===t&&rspkr.ui.ControlPanel&&rspkr.ui.ControlPanel.toggle(void 0,this.value)}function i(e){var t=[];(e=e||{}).panels?e.panels.forEach(function(e){t.push.apply(t,e.querySelectorAll("[data-pref-key]"))}):t=Array.from(document.querySelectorAll(".rs-dialog-content [data-pref-key]")),t.forEach(function(e){var t,r=e.getAttribute("data-pref-key"),s=rspkr.st.get(r);"keyboard"===r?h.populateInput(e.querySelector("button.edit-shortcut"),e.getAttribute("data-shortcut-action")):"INPUT"===e.nodeName.toUpperCase()&&"radio"===e.getAttribute("type")&&e.value===s?(e.checked=!0,a(e)&&p(e),!$rs.isVisible(e)&&e.id&&((t=document.querySelector('label[for="%id"]'.replace("%id",e.id)))&&t.setAttribute("aria-selected",!0),t&&t.setAttribute("tabIndex",0))):"INPUT"===e.nodeName.toUpperCase()&&"number"===e.getAttribute("type")?e.value=s/(e.getAttribute("data-unit-conversion-factor")||1):"INPUT"===e.nodeName.toUpperCase()&&"range"===e.getAttribute("type")?e.value=s:"SELECT"===e.nodeName.toUpperCase()&&(e.value=s,a(e)&&p(e)),"langvoice"!==r||(r=rspkr.Voice.getVoice())&&(e.value=r.lang+","+r.voice)})}function l(e,t){var r,s;e.phrase&&(r=t.querySelector("legend")||t.classList.contains("rs-joined-pref")?"label":"legend",s=$rs.createElm(r,{cls:["rs-pref-header",rspkr.cls.content],attributes:{"data-rslang":"content/title/arialabel:"+rspkr.Util.legacyPhrase(e.titlephrase||e.phrase)}}),"label"==r&&s.setAttribute("for",e.prefId),("label"==r?t:t.closest("fieldset")).prepend(s),"label"==r&&t.classList.add("no-legend"))}function s(e){rspkr.preventDefault(e);var t=this.closest(".rs-pref").querySelector("aside"),e="flex"!==t.style.display;t.style.display=e?"flex":"none",t.hidden=!e,this.setAttribute("aria-expanded",e)}function c(e,t){var r;e.info&&($rs.createElm("button",{cls:["rs-pref-info",rspkr.hl.engine.useTextNodeMarkup?"":rspkr.cls.preserve],attributes:{"data-rslang":"title/arialabel:"+rspkr.Util.legacyPhrase(e.phrase),"data-rslangfilter":"prefInfoToggler","aria-expanded":"false"},click:s,parent:t}),(r=$rs.createElm("aside",{cls:rspkr.cls.preserve,content:'<div class="rsicn rsicn-info pseudo-content"></div><div data-rslang="content:%p"></div>'.replace("%p",rspkr.Util.legacyPhrase(e.info))})).hidden=!0,"top"===e.infoPos?(e=t.querySelector(".rs-pref-header"))?t.insertBefore(r,e.nextSibling):t.prepend(r):t.append(r))}var e=function(){rspkr.cevt("onDialogTabChanged",g.clearLog),rspkr.cevt("onDialogTabChanged",g.updateSummaries),rspkr.cevt("onTextSettingChanged",g.updateSummaries),rspkr.cevt("onVolumeChanged",g.updateSummaries),rspkr.cevt("onSpeedChanged",g.updateSummaries),rspkr.cevt("onLightboxClosed",e)},n=function(e,t){t!==rspkr.st.get(e)&&(rspkr.st.set(e,t),rspkr.item("settings."+e,t))},a=function(e){return e.getAttribute("data-dims")||e.options&&-1!==e.selectedIndex&&e.options[e.selectedIndex].getAttribute("data-dims")||void 0},p=function(r){d(r),a(r).split(",").forEach(function(e){document.querySelectorAll('.rs-dialog-esque [data-pref-key="$"]'.replace("$",e)).forEach(function(e){e.disabled=!0;var t=e.closest("fieldset");t.classList.add("dimmed"),t.hasAttribute("data-dimmed-by")?(e=t.getAttribute("data-dimmed-by").split(" ")).includes(r.getAttribute("data-pref-key"))||(e.push(r.getAttribute("data-pref-key")),t.setAttribute("data-dimmed-by",e.join(" "))):t.setAttribute("data-dimmed-by",r.getAttribute("data-pref-key"))})})},d=function(e){var r=e.getAttribute("data-pref-key");document.querySelectorAll('.dimmed[data-dimmed-by~="$"]'.replace("$",e.getAttribute("data-pref-key"))).forEach(function(e){var t=e.getAttribute("data-dimmed-by").split(" ");t.splice(t.indexOf(r),1),t.length?e.setAttribute("data-dimmed-by",t.join(" ")):(e.removeAttribute("data-dimmed-by"),e.classList.remove("dimmed"),e.querySelectorAll("[disabled]").forEach(function(e){e.disabled=!1}))})},u={_createColorpicker:function(r,e){r.prefId=rspkr.Util.randomString(),l(r,e);var s=$rs.createElm("div",{cls:"rs-pref-colorpicker",parent:e,attributes:{role:"radiogroup"}});r.options.forEach(function(e){var t=rspkr.Util.randomString();$rs.createElm("input",{cls:["rs-pref-color",e.cls||""],id:t,attributes:{type:"radio",name:r.prefId,value:e.value,"data-pref-key":r.pref,"aria-hidden":"true"},parent:s}).addEventListener("change",function(){this.parentElement.querySelector('label[aria-selected="true"]').setAttribute("aria-selected",!1);var e=this.parentElement.querySelector('label[for="%id"]'.replace("%id",this.id));e.setAttribute("aria-selected",!0),e.setAttribute("tabindex",0),(e=this).parentElement.querySelectorAll("label").forEach(function(e){e.setAttribute("tabindex","-1")}),e.parentElement.querySelector('label[for="%id"]'.replace("%id",e.id)).setAttribute("tabindex","0")}),$rs.createElm("label",{cls:["rs-pref-color","pseudo-content",e.cls||""],attributes:{for:t,"data-rslang":(e.cls?"title/arialabel/content:":"title/arialabel:")+rspkr.Util.legacyPhrase(e.phrase),style:"background-color:"+e.value,tabindex:"-1",role:"radio",name:r.prefId,"aria-selected":"false"},buttonesque:!0,click:function(e){rspkr.preventDefault(e),this.parentElement.querySelector("#"+this.getAttribute("for")).click(e)},parent:s}).addEventListener("keydown",function(e){var t,r;"ArrowLeft"!==e.code&&"ArrowRight"!==e.code||(r=(t=Array.from(this.parentNode.querySelectorAll("label"))).indexOf(this),(r=t["ArrowLeft"===e.code?--r:++r])&&r.click(),r&&r.focus())})}),c(r,e),o(e.querySelectorAll("input"))},_createNumber:function(e,t){e.prefId=rspkr.Util.randomString(),l(e,t);var r=$rs.createElm("div",{cls:"rs-pref-option",parent:t});e.phrase_before&&$rs.createElm("label",{cls:rspkr.cls.content,attributes:{"data-rslang":"content/title/arialabel:"+rspkr.Util.legacyPhrase(e.phrase_before),for:e.prefId},parent:r}),$rs.createElm("input",{id:e.prefId,attributes:{type:"number",min:e.min,step:e.step,"data-unit-conversion-factor":e.unitfactor,"data-pref-key":e.pref,"data-rslang":"title/arialabel:"+rspkr.Util.legacyPhrase(e.phrase)},parent:r}),e.phrase_after&&$rs.createElm("label",{cls:rspkr.cls.content,attributes:{"data-rslang":"content/title/arialabel:"+rspkr.Util.legacyPhrase(e.phrase_after),for:e.prefId},parent:r}),c(e,t),o(t.querySelector("input"))},_createRadio:function(n,a){n.prefId=rspkr.Util.randomString(),l(n,a),n.options.forEach(function(e){var t=rspkr.Util.randomString(),r=$rs.createElm("div",{cls:"rs-pref-option",parent:a}),s=$rs.createElm("label",{cls:rspkr.cls.content,attributes:{"data-rslang":"content/title/arialabel:"+(e.forceLegacyKey?e.phrase:rspkr.Util.legacyPhrase(e.phrase)),for:t},parent:r}),r=$rs.createElm("input",{id:t,cls:rspkr.cls.skip,attributes:{type:"radio",name:n.prefId,value:e.value,"data-rslang":"title/arialabel:"+(e.forceLegacyKey?e.phrase:rspkr.Util.legacyPhrase(e.phrase)),"data-pref-key":n.pref},parent:r});e.filter&&s.setAttribute("data-rslangfilter",e.filter),e.filter&&r.setAttribute("data-rslangfilter",e.filter),e.dims&&r.setAttribute("data-dims",e.dims.join(","))}),c(n,a),o(a.querySelectorAll("input"))},_createRestore:function(e,t){g.createRestorePanel(e,t)},_createSelect:function(e,t){e.prefId=rspkr.Util.randomString(),l(e,t);var r=$rs.createElm("select",{id:e.prefId,cls:rspkr.cls.content,parent:t,attributes:{"data-pref-key":e.pref},click:function(e){rspkr.preventDefault(e)}});e.options.forEach(function(e){e.attributes||(e.attributes={}),e.attributes["data-rslang"]="content/title/arialabel:"+(e.forceLegacyKey?e.phrase:rspkr.Util.legacyPhrase(e.phrase)),e.attributes.value=e.value,e.filter&&(e.attributes["data-rslangfilter"]=e.filter),e.dims&&(e.attributes["data-dims"]=e.dims.join(",")),$rs.createElm("option",{attributes:e.attributes,parent:r})}),c(e,t),o(t.querySelector("select"))},_createVoicePicker:function(e,t){var r,s=rspkr.item("general.readingLangs"),n=[];for(r in s)if(s.hasOwnProperty(r))for(var a,o=0;a=s[r][o];o++){var i=a.voice,l=a.customlang||a.lang||r,c=a.customgender||a.gender,p=a.attributes;n.push({value:r+","+a.voice,phrase:a.phrase,forceLegacyKey:!0,filter:"voiceLabel",attributes:{"voice-name":i,"voice-lang":l,"voice-gender":c,"voice-attr":p.join("")}})}e.options=n,u._createSelect(e,t)},_createSlider:function(e,t){e.prefId=rspkr.Util.randomString(),l(e,t),new rspkr.ui.Slider({container:t,direction:"h",min:e.options.min,max:e.options.max,labelStart:rspkr.Util.legacyPhrase(e.options.labelStart),labelEnd:rspkr.Util.legacyPhrase(e.options.labelEnd),step:e.options.step,value:e.options.initVal,attributes:{"data-pref-key":e.pref}}),c(e,t),o(t.querySelector("input"))},_createShortcutEditor:function(t,r){r.classList.add("shortcuts"),t.prefId=rspkr.Util.randomString(),l(t,r),t.actionGroups.forEach(function(e){$rs.createElm("h2",{attributes:{"data-rslang":"content:"+e.groupPhrase},parent:r}),e.actions.forEach(function(e){$rs.createElm("div",{cls:["rs-pref-shortcut"],attributes:{"data-pref-key":t.pref,"data-shortcut-action":e.action},content:[$rs.createElm("label",{cls:rspkr.cls.content,attributes:{for:"rs-shortcut-input-%id".replace("%id",e.action),"data-rslang":"content/title/arialabel:%p".replace("%p",e.phrase)}}),$rs.createElm("button",{cls:"edit-shortcut unselectable",id:"rs-shortcut-input-%a".replace("%a",e.action),attributes:{"data-rs-shortcut-phrase":e.phrase,"data-rs-shortcut-action":e.action,"data-rslang":"title/arialabel:shortcuts-input","data-rslangfilter":"shortcutAction"},click:h.startInput}),$rs.createElm("button",{cls:"clear-shortcut",attributes:{"data-rslang":"title/arialabel:shortcuts-clear"},click:h.clearInput})],parent:r})})}),c(t,r)},_createPreview:function(e,t){m.createPreview(e,t)}},h={populateInput:function(e,t){e.innerHTML="",$rs.createElm("span",{cls:"key",parent:e});t=rspkr.Keyboard.getShortcut(t);if(t&&t.key){rspkr.Keyboard.insertMappedKey(t.key,e.querySelector(".key"));for(var r,s=0,n=Object.keys(t);r=n[s];s++)"key"!==r&&$rs.createElm("span",{cls:["modifier",r],parent:e})}e.classList.toggle("unset",!t.key)},startInput:function(e){rspkr.preventDefault(e),h.endInput(),this.classList.remove("unset","error"),this.classList.add("waiting"),rspkr.Keyboard.blocked=!0,document.addEventListener("keydown",h.endInput),document.addEventListener("click",h.endInput),this.addEventListener("blur",h.blurInput)},blurInput:function(){this.classList.remove("waiting","error"),this.removeEventListener("blur",h.blurInput),h.populateInput(this,this.getAttribute("data-rs-shortcut-action"))},endInput:function(e){e&&rspkr.preventDefault(e);var t,r=e&&e instanceof window.KeyboardEvent,s=r&&1===e.key.length&&" "!==e.key;r&&!s||(document.removeEventListener("keydown",h.endInput),document.removeEventListener("click",h.endInput),rspkr.Keyboard.blocked=!1,(t=document.querySelector(".rs-pref button.waiting"))&&t.classList.remove("waiting","unset"),t&&e&&e instanceof window.KeyboardEvent&&(r=t.getAttribute("data-rs-shortcut-action"),(s={}).key=e.code,e.shiftKey&&(s.shift=!0),e.altKey&&(s.alt=!0),e.ctrlKey&&(s.ctrl=!0),(e=rspkr.Keyboard.getAction(s))?e===r||t.classList.add("error"):(rspkr.Keyboard.setShortcut(r,s),h.populateInput(t,r))))},clearInput:function(){var e=this.parentElement.querySelector(".edit-shortcut"),t=e.getAttribute("data-rs-shortcut-action");e.classList.remove("waiting","error"),rspkr.Keyboard.setShortcut(t,{}),h.populateInput(e,t)}},g={createRestorePanel:function(e,t){e.prefId=rspkr.Util.randomString(),l(e,t),$rs.createElm("div",{cls:"rs-restore-options",content:['<label data-rslang="content/title/arialabel:restore-what"></label>',"<div>",'\t<input type="checkbox" id="restore-all" data-type="all" />','\t<label for="restore-all" data-rslang="content/title/arialabel:restore-all"></label>',"</div>","<div>",'\t<input type="checkbox" id="restore-textsettings" data-type="textsettings" />','\t<label for="restore-textsettings" class="rsicn rsicn-text-settings pseudo-content"></label>','\t<label for="restore-textsettings" class="restore-label" data-rslang="content/title/arialabel:textsettings"></label>',"</div>","<div>",'\t<input type="checkbox" id="restore-highlighting" data-type="highlighting" />','\t<label for="restore-highlighting" class="rsicn rsicn-highlighting pseudo-content"></label>','\t<label for="restore-highlighting" class="restore-label" data-rslang="content/title/arialabel:settings-group-highlighting"></label>',"</div>","<div>",'\t<input type="checkbox" id="restore-reading" data-type="reading" />','\t<label for="restore-reading" class="rsicn rsicn-voice pseudo-content"></label>','\t<label for="restore-reading" class="restore-label" data-rslang="content/title/arialabel:settings-group-reading"></label>',"</div>","<div>",'\t<input type="checkbox" id="restore-other" data-type="other" />','\t<label for="restore-other" class="rsicn rsicn-controls pseudo-content"></label>','\t<label for="restore-other" class="restore-label" data-rslang="content/title/arialabel:settings-group-misc"></label>',"</div>","<div>",'\t<input type="checkbox" id="restore-shortcuts" data-type="shortcuts" data-mobile="false" />','\t<label for="restore-shortcuts" class="rsicn rsicn-keyboard pseudo-content"></label>','\t<label for="restore-shortcuts" class="restore-label" data-rslang="content/title/arialabel:settings-group-shortcuts"></label>',"</div>"].join(""),parent:t}),rspkr.mobile()&&t.querySelectorAll('[data-mobile="false"]').forEach(function(e){e=e.closest("div");e.parentElement.removeChild(e)}),$rs.createElm("button",{parent:t,cls:["rs-pref-button",rspkr.cls.preserve],attributes:{"data-rslang":"content/title/arialabel:"+rspkr.Util.legacyPhrase(e.phrase),"data-pref-key":e.pref},click:function(){g.restore.bind(this)()}}),$rs.createElm("div",{id:"restore-log",attributes:{"data-rslang":"content/arialabel/title:restore-result","data-rslangfilter":"restoreResult"},content:" ",parent:t}),t.querySelectorAll("input").forEach(function(e){e.addEventListener("change",g.onChange)}),c(e,t)},onChange:function(){g.clearLog();var e,t,r=document.querySelector(".rs-dialog-esque .rs-restore-options"),s=r.querySelectorAll('[data-type]:not([data-type="all"])').length;this.nodeName&&"all"===this.getAttribute("data-type")?(t=this.checked,r.querySelectorAll("input").forEach(function(e){e.checked=t}),e=t?s:0):(e=r.querySelectorAll('[data-type]:not([data-type="all"]):checked').length,r.querySelector('[data-type="all"]').checked=e===s);r=r.parentElement.querySelector("button");r.classList.toggle("disabled",0===e),r.disabled=0===e},clearLog:function(){var e=document.querySelector(".rs-dialog-esque #restore-log");e&&e.classList.remove("active")},updateSummaries:function(){var e=document.querySelector(".rs-dialog-esque > nav li.active");e&&"restore"!==e.getAttribute("data-tab-id")||(g.restore(!0),g.onChange())},restorePanel:function(e,t,s){var n=0;if("shortcuts"===t&&e)rspkr.st.get("shortcuts")!==rspkr.cfg.customerDefault("settings.shortcuts")&&(n++,s||rspkr.st.delete("shortcuts")),e.querySelectorAll("button.edit-shortcut").forEach(function(e){var t=e.getAttribute("data-rs-shortcut-action"),e=rspkr.st.get("kb."+t);rspkr.cfg.customerDefault("settings.kb."+t)!==e&&(n++,s||rspkr.st.delete("kb."+t))}),s||rspkr.Keyboard.restoreShortcuts({toDefault:!0});else if("textsettings"===t)["lbfontsize","fontface","textstyle","textspacing"].forEach(function(e,t){var r=rspkr.st.get(e);rspkr.cfg.customerDefault("settings."+e)!==r&&(n++,s||(rspkr.st.delete(e),rspkr.Dialog["update"+["FontSize","FontFace","TextColor","TextSpacing"][t]]()))});else if("reading"===t){var a=!1;rspkr.mobile()||void 0===rspkr.st.get("hlvol")||100===parseInt(rspkr.st.get("hlvol"))||(n++,s||(rspkr.st.delete("hlvol"),rspkr.conf("settings.hlvol",100),rspkr.pl.setVolume(100),rspkr.Common.dispatchEvent("onVolumeChanged"),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.VOLUMECHANGED,void 0,100))),rspkr.st.get("hlspeed")!==rspkr.cfg.customerDefault("settings.hlspeed")&&(n++,s||(rspkr.st.delete("hlspeed"),rspkr.devt("onSpeedChanged"),a=!0));var r=rspkr.getRSBtns(),o=rspkr.Voice.getVoice(r.length?r[0]:void 0),i=!1;if(document.querySelectorAll("[data-rs-lang],[data-rs-voice]").forEach(function(e){var t=e.getAttribute("data-rs-lang"),r=e.getAttribute("data-rs-voice");o.lang===t&&o.voice===r||(s||(t&&(e.href=rspkr.setParam("lang",t,e.href)),e.href=r?rspkr.setParam("voice",r,e.href):rspkr.deleteParam("voice",e.href)),a=i=!0)}),!s&&i){rspkr.item("general.userDefinedLang",null),rspkr.item("general.userDefinedVoice",null);for(var l,c,p=rspkr.getRSBtns(),d=0;d<p.length;d++){var u=rspkr.findHref(p[d]);if(u){rspkr.c.data.setParams(u);break}}p.length&&(l=(c=p[0].querySelector(".rsbtn_play")).getAttribute("data-rs-lang"),r=c.getAttribute("data-rs-voice"),rspkr.Voice.setVoice(l,r),(c=e.querySelector('[data-pref-key="langvoice"]'))&&(c.value=l+","+r)),rspkr.devt("onVoiceChanged")}i&&n++,!s&&a&&rspkr.Common.Player.empty()}else e&&e.querySelectorAll(".rs-pref").forEach(function(e){var t;e.querySelector("[data-pref-key]")&&(t=e.querySelector("[data-pref-key]").getAttribute("data-pref-key"),e=rspkr.st.get(t),rspkr.cfg.customerDefault("settings."+t)!==e&&(n++,s||rspkr.st.delete(t)))});return s||"highlighting"!==t||(m.updatePreview(void 0,void 0,!0),rspkr.hl.settings.setHL()),n},restore:function(s){var t,n=0,a=[],e=document.querySelector(".rs-dialog-esque .rs-restore-options");g.clearLog(),(s?e.querySelectorAll('[data-type]:not([data-type="all"])'):e.querySelectorAll('[data-type]:not([data-type="all"]):checked')).forEach(function(e){var t=e.getAttribute("data-type"),r=document.querySelector('.rs-dialog-esque > nav li[data-tab-id="$type"]'.replace("$type",t)),r=r?document.querySelector('.rs-dialog-esque #rs-dialog-main [id="$cId"]'.replace("$cId",r.getAttribute("data-content-id"))):void 0;r&&a.push(r);t=g.restorePanel(r,t,s);n+=t,s&&(e.checked=t,(e.parentElement.querySelector(".summary")||$rs.createElm("span",{cls:"summary",parent:e.parentElement.querySelector(".restore-label")})).innerText="($n)".replace("$n",t))}),s||(t=[],(e=(e={panels:a})||{}).panels?e.panels.forEach(function(e){t.push.apply(t,e.querySelectorAll("[data-dimmed-by]"))}):t=Array.from(document.querySelectorAll(".rs-dialog-content [data-dimmed-by]")),t.forEach(function(e){e.removeAttribute("data-dimmed-by"),e.classList.remove("dimmed"),e.querySelectorAll("[disabled]").forEach(function(e){e.disabled=!1})}),i({panels:a}),setTimeout(function(){var e=document.querySelector(".rs-dialog-esque #restore-log");e.setAttribute("data-result",n),e.classList.toggle("success",0<n),rspkr.Lang.updateUi(e),e.classList.add("active")},200),g.updateSummaries())}},m={createPreview:function(e,t){$rs.createElm("h2",{cls:["rs-pref-header",rspkr.cls.content],parent:t,attributes:{"data-rslang":"content/title/arialabel:"+rspkr.Util.legacyPhrase(e.titlephrase||e.phrase)}}),t.classList.add("rs-dialog-preview"),$rs.createElm("div",{content:'Lorem ipsum dolor sit amet, consectetur adipiscing elit. <span class="preview-sent">Pellentesque sed enim <span class="preview-word">varius</span> enim posuere porta</span>. Praesent libero quam, cursus nec nulla vitae, cursus gravida leo. Aenean tempor elit nec efficitur viverra.',parent:t}),rspkr.evt("onSettingsChanged",m.updatePreview,!0)},updatePreview:function(e,t,r){var s,n;!0!==r&&!["hltoggle","hl","hlword","hlsent","hltext"].includes(e)||(s=document.querySelector(".rs-dialog-esque .preview-word"),(n=document.querySelector(".rs-dialog-esque .preview-sent"))&&s&&(n.removeAttribute("style"),s.removeAttribute("style"),r=rspkr.st.get("hl"),"sent"!==(r="hltoggle"===e&&"hloff"===t?"none":r)&&"wordsent"!==r||("underline"===(t=rspkr.st.get("hlsent"))&&(n.style.textDecoration="underline"),"#"===t.substr(0,1)&&(n.style.background=t),n.style.color=rspkr.st.get("hltext")),"word"!==r&&"wordsent"!==r||("underline"===(r=rspkr.st.get("hlword"))&&(s.style.textDecoration="underline"),"#"===r.substr(0,1)&&(s.style.background=r),s.style.color=rspkr.st.get("hltext"))))}};return{open:function(){if(rspkr.with.explorer())return rspkr.ui.LoadIndicator.show(),void rspkr.c.useLegacy(function(){rspkr.Legacy.openLegacySettings()});rspkr.c.dispatchEvent("onBeforeSettingsOpened",window,[]),rspkr.Dialog.open({icon:"settings",titleKey:"settings",height:600,tabs:function(){var e=rspkr.st.getSettingsConf(),t=[],r;for(r in e)if(e.hasOwnProperty(r)){if(e[r].display===false)continue;if(e[r].desktop===false&&!rspkr.mobile())continue;if(e[r].mobile===false&&rspkr.mobile())continue;if(e.required&&rspkr.features[e.required]===false)continue;var s=e[r],n=$rs.createElm("div",{cls:"rs-prefs"});for(var a in s.items)if(s.items.hasOwnProperty(a)){var o=s.items[a];o.pref=a;if(o.desktop===false&&!rspkr.mobile())continue;if(o.mobile===false&&rspkr.mobile())continue;if(o.required&&rspkr.features[o.required]===false)continue;o.groupId&&!n.querySelector("#"+o.groupId)&&$rs.createElm("fieldset",{id:o.groupId,parent:n});var i=$rs.createElm("fieldset",{parent:o.groupId?n.querySelector("#"+o.groupId):n});o.type.substr(-2)==="_h"&&(o.type=o.type.substring(0,o.type.length-2));var l=$rs.createElm("div",{cls:"rs-pref",parent:i});o.joined&&l.classList.add("rs-joined-pref");u["_create"+o.type.charAt(0).toUpperCase()+o.type.substr(1)](o,l);o.class&&l.classList.add(o.class)}t.push({name:r,nameKey:s.phrase,tabKey:s.phrase_tab||s.phrase,tabId:s.tabId||"",icon:s.icon,order:s.order,content:n})}return t.sort(function(e,t){return e.order-t.order}),t}(),mode:"settings",trigger:this,ariaExpand:!0}),i(),m.updatePreview(void 0,void 0,!0),rspkr.evt("onDialogTabChanged",g.clearLog,!0),rspkr.evt("onDialogTabChanged",g.updateSummaries,!0),rspkr.evt("onTextSettingChanged",g.updateSummaries,!0),rspkr.evt("onVolumeChanged",g.updateSummaries,!0),rspkr.evt("onSpeedChanged",g.updateSummaries,!0),rspkr.evt("onLightboxClosed",e,!0),rspkr.c.dispatchEvent("onSettingsLoaded",window,[]),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.SETTINGSOPENED)}}}(),window.ReadSpeaker.Common.Player=function(){function t(e){e=e||{};var t,r=rspkr.ui.getActivePlayer();(r||e.forceOpen)&&(r&&"rs-dialog-player"===r.id||(t=!e.forceOpen&&r&&r.getHref()||rspkr.findHref(),rspkr.HL.clean(),rspkr.pl.releaseAdapter(),e.preventPlay=!0,window.readpage(t,void 0,e),rspkr.Common.Player.setStateClass("rsidle"),rspkr.features.progressbar&&rspkr.ui.LoadIndicator.update({player:r}),rspkr.mobile()||!r||rspkr.item("ui.preventPlaybackFocus")||r.getContainer().querySelector(".rsbtn_pause").focus()))}return{empty:t,expandEmpty:function(e){(e=e||{}).forceOpen=!0,t(e)},setStateClass:function(e,t){var r=[];if((t=t||{}).global)r=r.concat([].slice.call(rspkr.getRSBtns()));else{var s=rspkr.ui.getActivePlayer();if(!s)return;t=s.getContainer?s.getContainer():void 0;!t||t instanceof Array||r.push(s.getContainer())}rspkr.mobile()&&r.push(rspkr.ui.getActivePlayer().getMobileContainer()),$rs.removeClass(r,"rsloading rspaused rsstopped rsplaying rsidle"),e&&$rs.addClass(r,e)}}}(),rspkr.Lang=function(){var r,n=["native","ar_ar","ca_es","cy_gb","da_dk","de_de","en_us","en_uk","es_es","eu_es","fi_fi","fo_fo","fr_fr","fr_be","fr_ca","gl_es","is_is","it_it","ja_jp","ko_kr","lv_lv","nl_nl","no_nb","pl_pl","pt_pt","pt_br","sv_se","uk_ua","zh_cn","zh_tw"],a={},o={},S={},i=function(){return rspkr.item("general.fallbacklang")||"en_us"},s=function(e){if(2===(e="nb_no"===(e="en_gb"===(e="sv"===(e="es"===(e="en"===(e=e.toLowerCase().replace("-","_"))?"en_us":e)?"es_es":e)?"sv_se":e)?"en_uk":e)?"no_nb":e).length&&0<=n.indexOf(e+"_"+e)&&(e=e+"_"+e),-1===n.indexOf(e))for(var t=0;t<n.length;t++)if(n[t].substring(0,2)===e.substring(0,2)){e=n[t];break}return e=-1===n.indexOf(e)?i():e},l=function(e){switch(e.toLowerCase()){case"en_sc":case"en_au":return"en_uk";case"es_co":case"es_mx":case"es_us":return"es_es";case"nl_be":return"nl_nl";case"sv_fi":return"sv_se";case"zh_hk":return"zh_tw";default:return e}},E=function(e){if(5!==e.length)return"";switch(e){case"ar_ar":e="ar-SA";break;case"en_uk":e="en-GB";break;case"nb_no":case"no_nb":e="no-NO"}return e.substring(0,2)+"-"+e.substr(-2).toUpperCase()},x=function(t,r){if(!o[t])if(S[t])r.updateUi&&u(r.container,t);else{if(-1===n.indexOf(t)||rspkr.item("general.disableJSON"))return c(t),p(t),S[t]=!0,void(r.updateUi&&u(r.container,t));var s;o[t]=!0,window.XMLHttpRequest&&(s=new XMLHttpRequest),window.ActiveXObject&&(s=new window.ActiveXObject("Microsoft.XMLHTTP"));var e=rspkr.baseUrl+rspkr.revPath+"lang/"+t+".json";s.open("GET",e,!0),s.onreadystatechange=function(){if(4===s.readyState&&200===s.status)try{var e={};e[t]=JSON.parse(s.response||s.responseText),d(e),c(t),p(t),o[t]=!1,S[t]=!0,"native"===t?rspkr.devt("onNativeLoaded"):rspkr.devt("onLangLoaded",window,[t]),r.updateUi&&u(r.container,t),r.fallbacking&&rspkr.Lang.updateUi(document,t,!0)}catch(e){rspkr.error("[rspkr.Lang.loadLang] Could not load language: "+t),o[t]=!1}else 4===s.readyState&&404===s.status&&(rspkr.error("[rspkr.Lang.loadLang] Could not load language: "+t),o[t]=!1,t!==i()&&g(i(),{load:!0}))},s.send()}},c=function(e){if(e&&rspkr.phrases){a.hasOwnProperty(e)||(a[e]={});for(var t=0;t<100;t++){var r=rspkr.mapPhrase((t+10).toString(36)),s=rspkr.getPhrase(r,e,!0);if(!s)break;a[e][r]=s}}},p=function(e){var t,r=rspkr.item("phrases."+e);r&&"object"==typeof r&&((t={})[e]=r,d(t))},d=function(e){for(var t in e)if(e.hasOwnProperty(t))for(var r in a.hasOwnProperty(t)||(a[t]={}),e[t])e[t].hasOwnProperty(r)&&(a[t][r]=e[t][r])},u=function(e,t,r){var s=!!t;if(t=t||P(),"string"!=typeof(e="string"==typeof e&&$rs.arr(e).length?$rs.arr(e):e)){if(e=e||document,!S[t])return x(t,{updateUi:!0,container:e}),!0;e instanceof Array||(e=[e]);for(var n=[],a=r?"[data-rslang-untranslated]":"native"===t?'[data-rslang-native="true"]':"[data-rslang]",o=0;o<e.length;o++)e[o].matches&&e[o].matches(a)&&n.push(e[o]),n.push.apply(n,e[o].querySelectorAll(a));for(var i,l=0;i=n[l];l++){var c=i.getAttribute("data-rslang").split(","),p=i.getAttribute("data-rslangfilter"),d={general:{filter:"default"}};if(p)if(1===(p=p.split(",")).length)d.general.filter=p[0];else for(var u=0;u<p.length;u++){var h=p[u].split(":"),g=h[0].split("/");2!==h.length&&rspkr.error("[rspkr.Lang.updateUi] Malformed filter attribute: "+p[u]);for(var m=0;m<g.length;m++)d[g[m]]||(d[g[m]]={}),d[g[m]].filter=h[1]}for(var k,f,y,b,v=0;v<c.length;v++){var C=c[v].split(":"),A=C[0].split("/");2!==C.length&&rspkr.error("[rspkr.Lang.updateUi] Malformed data attribute: "+c[v]);for(var w=0;A[w];w++)d[A[w]]||(d[A[w]]={}),d[A[w]].key=C[1]}for(k in d)d.hasOwnProperty(k)&&d[k].key&&(f="native"===(b=rspkr.conf("general.nativeLanguages")&&i.hasAttribute("data-rslang-native")?"native":t)?d[k].key+"_native":d[k].key,y=d[k].filter||d.general.filter||"default",b=rspkr.Lang.filters[y]({str:L(f,b,i),key:f,lang:b,elm:i}),"alt"===k&&i.setAttribute("alt",b),"title"===k&&i.setAttribute("title",b),"arialabel"===k&&i.setAttribute("aria-label",b),"content"===k&&(i.innerHTML=b),b?i.removeAttribute("data-rslang-untranslated"):i.setAttribute("data-rslang-untranslated","true"))}r||e.forEach(function(e){rspkr.getRSBtns(void 0,e).forEach(function(e){e.setAttribute("lang",E(t))}),(e.parentElement||e).querySelectorAll("#rs-controlpanel, #rslightbox_contentcontainer, #rsbtn_popup").forEach(function(e){e.setAttribute("lang",E(t))})}),rspkr.devt("onUiUpdated"),s&&rspkr.devt("onLangUpdated",window,[e,t])}else rspkr.warn('[rspkr.Lang.updateUi] Can\'t find element(s) "$0"'.replace("$0",e))},h=function(){if(rspkr.item("general.uiLang"))return rspkr.item("general.uiLang");var e,t=rspkr.findHref();return t&&(e=rspkr.getParam("uilang",t))||t&&(e=rspkr.getParam("lang",t))?e:i()},P=function(){return r||g()},g=function(e,t){if(!1!==(t=t||{}).force||!r)return r=e&&!0===t.force?e:s(l(e||h())).toLowerCase(),!0===t.force&&!1===t.load&&(p(e),S[e]=!0,t.updateUi&&u(t.container,e)),!1!==t.load&&x(r,t),rspkr.item("general.uiLang",r),r},L=function(e,t,r){t=t||P();var s=a[t]?"*"===e?a[t]:a[t][e]:void 0;if(s)return s;s=i();if(t!==s)if("native"!==t||S.native){if(S[s])return L(e,s);r&&r.setAttribute&&r.setAttribute("data-rslang-untranslated","true"),x(s,{updateUi:!1,fallbacking:!0})}else x("native",{updateUi:!1,key:e,lang:"native"})};return{dependency:["pub.Config"],bcp47:E,extendPhrases:d,flag:function(e){switch(e){case"ca_es":case"eu_es":case"gl_es":case"es_us":case"es_co":case"es_mx":return"noflag";case"fy_nl":return"nl";case"en_sc":return"scotland";case"ar_ar":return"arabic";case"cy_cy":return"wales"}var t=e.split(/[-_]/);switch(t=t[1]||t[0]){case"uk":case"en":return"gb";case"nn":case"nb":return"no";default:return t}},formatLangCode:s,getFallbackLang:i,getPhrase:L,getUiLang:P,init:function(){void 0===r&&(window.ReadSpeaker.Common.addEvent("onReady",function(){g(void 0,{load:!0,updateUi:!0,force:!1})}),window.ReadSpeaker.Common.addEvent("onNativeLoaded",function(){u(document,"native")}))},mapUiLang:l,setUiLang:g,updateUi:u}}(),rspkr.Lang.filters=function(){rspkr.log("[rspkr.Lang.filters] Heartbeat!");return{default:function(e){if(e.str)return e.str},legacyExpandPhrase:function(e){if(e.key){var t=e.key.match(/ph_[a-z_0-9]*/gi),r=e.key;if(t){for(var s=0,n=t.length;s<n;s++)t[s]=[t[s],rspkr.Lang.getPhrase(rspkr.Util.legacyPhrase(t[s]))];for(s=0;s<t.length;s++)r=r.replace(t[s][0],t[s][1])}return r}},prefInfoToggler:function(e){return rspkr.Lang.getPhrase("togglehelpfor",e.lang)+": "+e.str},restoreResult:function(e){e.str&&0<=e.str.indexOf("$")||(e.str="$ setting(s) restored");var t=e.elm.getAttribute("data-result");return e.str.replace("$",t)},shortcutAction:function(e){if(e.str){var t=e.elm.getAttribute("data-rs-shortcut-phrase");return e.str.replace("$a",rspkr.Lang.getPhrase(t,e.lang))}},skipBtns:function(e){if(e.str){var t=parseInt(rspkr.item("general.skipIntervalSec"))||5;if("ja_jp"===e.lang)for(var r=String(t).split(""),t="",s=0;s<r.length;s++)t+=String.fromCharCode(parseInt("FF1"+r[s],16));return e.str.replace("$s",t)}},speechEnabledLink:function(e){var t=$rs.createElm("div",{content:e.str}),e=t.querySelector("a");return e&&(e.href="https://www.readspeaker.com/?ref="+encodeURIComponent(document.location.href)),e&&e.setAttribute("target","_blank"),t.innerHTML},speechEnabledTitle:function(e){return $rs.createElm("div",{content:e.str+" (%nw)".replace("%nw",rspkr.Lang.getPhrase("newwindow",e.lang))}).textContent},translationProvider:function(e){if(e.str){var t=document.querySelector(".rslightbox-trmessage"),t=t?t.getAttribute("data-translation-provider"):"";return e.str.replace("$p",t)}},transWordNotFound:function(e){if(e.str){var t=e.elm.getAttribute("data-word");return e.str.replace("%s",t)}},voiceLabel:function(e){return rspkr.Voice.getVoiceLabel(e.elm)}}}(),rspkr.Voice=function(){function h(){return rspkr.conf("general.voiceTemplate")||"{{flag}}{{lang}} - {{voice}}{{ - attr}}"}return{getVoice:function(e){if(!e&&rspkr.item("general.saveLangVoice")&&rspkr.st.get("langvoice"))return{lang:rspkr.st.get("langvoice").split(",").shift(),voice:rspkr.st.get("langvoice").split(",").pop()};if(!e&&rspkr.item("general.userDefinedVoice"))return{lang:rspkr.item("general.userDefinedLang"),voice:rspkr.item("general.userDefinedVoice")};if(!e&&rspkr.c&&rspkr.c.data.params.voice)return{lang:rspkr.c.data.params.lang,voice:rspkr.c.data.params.voice};var t;if(!e||(t=e.querySelector(".rsbtn_play"))&&t.href&&(s=t.href),s=s||rspkr.findHref()){var r=rspkr.getParam("lang",s),s=rspkr.getParam("voice",s);if(!r)return;if(s||e)return{lang:r,voice:s};var n,a=rspkr.item("general.readingLangs"),o=rspkr.Lang.formatLangCode(r);for(n in a)if(a.hasOwnProperty(n))if(a[n].customlang===r||a[n].customlang===o||n===r||n===o)return{lang:r,voice:(a[n]instanceof Array?a[n][0]:a[n]).voice}}},getVoiceLabel:function(e){for(var t=h(),r=e.getAttribute("voice-name"),s=e.getAttribute("voice-lang"),n=e.getAttribute("voice-gender"),a=e.hasAttribute("voice-attr")&&e.getAttribute("voice-attr").split?e.getAttribute("voice-attr").split(","):void 0;/{{/.test(t);){var o=t.indexOf("{{"),i=t.indexOf("}}");if(i<o){console.error("[rspkr.VoiceSettings] Broken voice option template.");break}for(var l,c=t.substring(o+2,i),p={flag:"",voice:r,lang:rspkr.Lang.getPhrase(s)||s,gender:rspkr.Lang.getPhrase(n),attr:a&&a.map?a.map(function(e){return-1!==("string"==typeof window.rspkr.conf("general.voiceAttributes")?window.rspkr.conf("general.voiceAttributes"):"slow").split(",").indexOf(e)?window.rspkr.Lang.getPhrase("voice-"+e)||e:void 0}).join(", "):void 0},d=Object.keys(p),u=0;l=d[u];u++)new RegExp(l,"i").test(c)&&(c=p[l]?c.replace(l,p[l]):"");t=t.substring(0,o)+c+t.substring(i+2)}return t},getVoiceTemplate:h,setVoice:function(c,p,e){var t,r,s;c?(t=rspkr.item("general.userDefinedVoice")||rspkr.c.data.params.voice,r=rspkr.item("general.userDefinedLang")||rspkr.c.data.params.lang,rspkr.getRSBtns().forEach(function(e){var t=e.querySelector(".rsbtn_play"),e=t&&t.getAttribute("href");t&&e&&(e=rspkr.setParam("lang",c,e),e=rspkr.setParam("voice",p,e),t.setAttribute("href",e))}),(s=rspkr.findHref())&&(s=rspkr.setParam("lang",c,s),s=rspkr.setParam("voice",p,s),rspkr.item("general.popupHref",s)),rspkr.ui.Tools.VoiceSettings&&rspkr.ui.Tools.VoiceSettings.getMenus().forEach(function(e){e[1].setValue(c+"-"+p)}),!0===rspkr.item("general.saveLangVoice")&&rspkr.st.set("langvoice",c+","+p),rspkr.item("general.userDefinedLang",c),rspkr.item("general.userDefinedVoice",p),e||c===r&&p===t||(rspkr.devt("onToolClicked",window,[this]),rspkr.Common.Player.empty())):(rspkr.item("general.saveLangVoice")&&rspkr.st.get("langvoice")&&(c=rspkr.st.get("langvoice").split(",").shift(),p=rspkr.st.get("langvoice").split(",").pop(),rspkr.item("general.userDefinedLang",c),rspkr.item("general.userDefinedVoice",p)),rspkr.getRSBtns().forEach(function(e){var t=$rs.findIn(e,".rsbtn_play"),r=$rs.getAttr(t,"href")||rspkr.findHref();if(r){var s=rspkr.getParam("lang",r),n=rspkr.getParam("voice",r),e=rspkr.getParam("uilang",r);if(c&&s&&c!==s&&!e&&(r=rspkr.setParam("uilang",s,r)),c)r=rspkr.setParam("lang",c,r),r=rspkr.setParam("voice",p,r),t?$rs.setAttr(t,"href",r):rspkr.item("general.popupHref",r);else{var a=rspkr.item("general.readingLangs");if(2===s.length)for(var o in a)if(a.hasOwnProperty(o)&&o.substr(0,2)===s){s=o;break}if(!n&&a[s])(n=(a[s][0]||a[s]).voice||"")&&(r=rspkr.setParam("voice",n,r),t?$rs.setAttr(t,"href",r):rspkr.item("general.popupHref",r));else if(a[s].voice&&a[s].voice!==n)r=rspkr.setParam("voice",a[s].voice,r),t?$rs.setAttr(t,"href",r):rspkr.item("general.popupHref",r);else if($rs.isArray(a[s])&&a[s].length){for(var i=0,l=a[s].length;i<l;i++)if(a[s][i].voice===n)return;r=rspkr.setParam("voice",a[s][0].voice,r),t?$rs.setAttr(t,"href",r):rspkr.item("general.popupHref",r)}}}})),rspkr.devt("onVoiceChanged")}}}(),rspkr.hl=rspkr.HL=function(){var g="",m={firstRun:0,lastWord:null,selectionRange:null,selectionHTML:null,selectedWordsRange:[],oldSentHL:[],oldSentHLClass:[],skipHidden:function(e){return!(!e||!0!==rspkr.item("general.skipHiddenContent")||!e.style)&&!$rs.isVisible(e)},skipAlways:function(e){return!(!e||!0!==rspkr.item("general.enableSkipAlways"))&&(!(!e.className||!/rs_skip_always/i.test(e.className))||!(!e.parentElement||e.parentElement===document.body)&&rspkr.hl.clientMarkup.skipAlways(e.parentElement))}},e={sync:function(e,t){for(var r,s,n,a="none"!==rspkr.st.get("hl")&&"hloff"!==rspkr.st.get("hltoggle"),o=rspkr.hl.enlarge.isActive(),i=!1,l=rspkr.hl.enlarge.isActive()&&"bghlon"===rspkr.st.get("enlargebghl"),c=rspkr.st.get("hl"),p="wordsent"===c||"word"===c,d="wordsent"===c||"sent"===c,u=0,h=$rs.getReadingFrames(window);s=h[u];u++)try{if(r=s.document.getElementById("sync"+t))break}catch(e){}r&&(0==(2&e)&&(i=0!=(1&e)),n=r.className.replace("word","")!==r.className,c=r.className.replace("sent","")!==r.className,a&&(n&&p&&!i&&rspkr.hl.css.wordOff(),n&&p&&!o&&rspkr.hl.css.wordOn(r),c&&d&&!i&&rspkr.hl.css.sentOff(),c&&d&&(!o||l)&&rspkr.hl.css.sentOn(r)),o&&(n&&p&&rspkr.hl.enlarge.wordHL(r,e),c&&d&&rspkr.hl.enlarge.sentHL(r,e)),rspkr.ui.AutoScroll.scroll(r))},preProcess:{setRestoreContent:function(){rspkr.log("[Servermarkup.preProcess.setRestoreContent] Called!");var e=rspkr.Common.data.getParam("readid"),e=document.getElementById(e).innerHTML;rspkr.Common.data.setRestoreContent(e)}},postProcess:{fullCleanUp:function(){rspkr.log("[Servermarkup.postProcess.fullCleanUp] Called!"),!0!==rspkr.hl.engine.useTextNodeMarkup&&rspkr.hl.Restore.all()},lightCleanUp:function(){rspkr.log("[Servermarkup.postProcess.lightCleanUp] Called!");var t=[];$rs.getReadingFrames(window).forEach(function(e){try{t=t.concat(rspkr.hl.getSyncContainers(e.document))}catch(e){}}),rspkr.hl.css.sentOff(t),rspkr.hl.css.wordOff(t)}}},k={enums:{sent:"sync_sent",sent_hl:"sync_sent_highlighted",word:"sync_word",word_hl:"sync_word_highlighted",textSelectionStyle:"border-bottom: dotted 1px #aaa;"},word_index:null,sent_index:null,hlChanged:!1,setHL:function(){var e=rspkr.pub.Config,t=rspkr.Common.Settings.get("hlword")||e.item("settings.hlword"),r=rspkr.Common.Settings.get("hlsent")||e.item("settings.hlsent"),s=rspkr.Common.Settings.get("hltext")||e.item("settings.hltext");if(this.updateHL("hlword",t,null),this.updateHL("hlsent",r,null),this.updateHL("hltext",s,null),!rspkr.mobile())for(var n=$rs.getReadingFrames(window),a=0;a<n.length;a++)try{rspkr.hl.css.setRule("sent",".rs_textselection .sync_sent",e.item("settings.textselection")||k.enums.textSelectionStyle)}catch(e){}},updateHL:function(t,r,e){if(e=e||null,"hlspeed"===t&&r!==e&&(k.hlChanged=!0),r===e||"hl"!==t&&"hltoggle"!==t||(k.hlChanged=!0,rspkr.hl.sync.lightCleanUp()),r!==e&&("hl"===t&&"none"!==r||"hltoggle"===t&&"hlon"===r)&&($rs.getReadingFrames(window).forEach(function(){try{k.setTextStyle("word",rspkr.Common.Settings.get("hlword")),k.setTextStyle("sent",rspkr.Common.Settings.get("hlsent")),k.setTextStyle("hltext",rspkr.Common.Settings.get("hltext"))}catch(e){}}),k.hlChanged=!0,rspkr.hl.Type.CURRENT===rspkr.hl.Type.CLIENT_MARKUP&&rspkr.PlayerAPI.releaseAdapter()),/hltext|hlword|hlsent|hlscroll/i.test(t)&&r!==e)if("hlscroll"===t)rspkr.hl.Scroll.initScroll();else for(var s=$rs.getReadingFrames(window),n=0;n<s.length;n++)try{var a=s[n].document;window.rspkr.hl.settings.setTextStyle(t,r),a.addEventListener("readystatechange",function(e){try{"complete"!==e.target.readyState&&"loaded"!==e.target.readyState||window.rspkr.hl.settings.setTextStyle(t,r)}catch(e){}})}catch(e){}},setTextStyle:function(e,t){var r,s=/word/.test(e)?"word":"sent",n="background-color";/underline/.test(t)?(n="text-decoration",t+=" ; background-color: none"):/none/.test(t)?(n="background",t+=" ; text-decoration: none; background-color: none"):"hltext"===e?(r=t,e=k.getStyleString(rspkr.Common.Settings.get("hlsent"),r),r=k.getStyleString(rspkr.Common.Settings.get("hlword"),r),t=e,rspkr.hl.css.setRule("word","."+k.enums.word_hl,n+": "+r)):t+="; text-decoration: none; color: "+rspkr.Common.Settings.get("hltext"),rspkr.hl.css.setRule(s,"."+k.enums[s+"_hl"],n+": "+t)},getStyleString:function(e,t){return(/underline|none/i.test(e)?"none":e)+"; text-decoration: "+(/underline/i.test(e)?"underline":"none")+"; color: "+t}};return{meta:{revision:"2489"},init:function(){var e=rspkr.Common.addEvent;e("onAfterModsLoaded",function(){rspkr.hl.engine.useTextNodeMarkup||e("onAPIInitAdapter",rspkr.hl.Restore.setRestoreContent),rspkr.hl.addEvents(),/forceTextNodeHL/i.test(document.location.href)?(rspkr.item("general.usePost",!0),g="textNode",rspkr.with.explorer()&&console.warn("Warning. Forcing textNode HL engine with Internet Explorer. Proceed at your own risk."),"webAudio"!==rspkr.pl.adapter&&console.warn("Warning. Forcing textNode HL engine with HTML5 Audio adapter. Proceed at your own risk."),!0===rspkr.item("general.iframeReading")&&console.warn("Warning. Forcing textNode HL engine with Iframe reading turned on. Proceed at your own risk.")):g=rspkr.with.explorer()||/disableTextNodeHL/i.test(document.location.href)||!0!==rspkr.item("general.usePost")||"webAudio"!==rspkr.pl.adapter||!0===rspkr.item("general.disableTextNodeHL")||!0===rspkr.item("general.iframeReading")?"gecko":"textNode",rspkr.log("[rspkr.hl] Using engine "+g),function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}(m,rspkr.hl.engine[g].clientExtension),rspkr.hl.engine[g].clientExtension.init(),rspkr.hl.html5&&window.addEventListener&&window.addEventListener("message",rspkr.hl.html5.receiveMessage,!1,!0),k.setHL()}),rspkr.hl.chunking={html5support:!!document.createElement("audio").canPlayType,close:function(){var e=$rs.get(".rsresume");$rs.isArray(e)||(e=[e]);for(var t,r=0;t=e[r];r++)t.parentElement.removeChild(t)},silence:function(){rspkr.hl.chunking.entracte&&rspkr.hl.chunking.entracte.src&&(rspkr.hl.chunking.entracte.pause(),rspkr.hl.chunking.entracte.currentTime&&(rspkr.hl.chunking.entracte.currentTime=0))},kill:function(){rspkr.hl.chunking.timer&&clearTimeout(rspkr.hl.chunking.timer),rspkr.hl.chunking.continueHref=null,rspkr.hl.chunking.stall=null,rspkr.hl.chunking.chunkEnded=null,rspkr.hl.chunking.currentChunkNumber=1,rspkr.hl.chunking.entracte&&"function"==typeof rspkr.hl.chunking.entracte.removeAttribute&&rspkr.hl.chunking.entracte.removeAttribute("src")},destroy:function(){rspkr.hl.chunking.silence(),rspkr.hl.chunking.close(),rspkr.hl.chunking.kill()}},rspkr.hl.chunking.currentChunkNumber=1,e("onChunkResume",function(){var e,t;rspkr.hl.chunking.continueHref&&(rspkr.hl.chunking.silence(),t=rspkr.ui.getActivePlayer().getContainer(),!$rs.hasClass(t,"rsautopaused")&&$rs.hasClass(t,"rspaused")||(rspkr.hl.chunking.stall?setTimeout(function(){rspkr.c.dispatchEvent("onChunkResume",window)},250):($rs.removeClass(t,"rsautopaused"),clearTimeout(rspkr.hl.chunking.timer),e=rspkr.hl.chunking.continueHref.replace("%{AUDIOFORMAT}",rspkr.Common.data.browser.html5AudioFormat),t=rspkr.hl.chunking.continueHref.replace("%{AUDIOFORMAT}","html5iframe"),rspkr.hl.chunking.continueHref=void 0,rspkr.hl.html5.audioUrl=e.replace(/&amp;/g,"&"),rspkr.hl.html5.frameUrl=t.replace(/&amp;/g,"&"),rspkr.hl.html5.initSyncFrame(),rspkr.hl.html5.initAudio(),rspkr.ui.getActivePlayer().play(),rspkr.hl.chunking.currentChunkNumber++)))}),rspkr.log("[rspkr.HL] Initialized!")},addEvents:function(){!function(){rspkr.log("[rspkr.hl.addEvents]");var e=rspkr.Common.addEvent;e("onUIClosePlayer",rspkr.hl.sync.lightCleanUp),e("onUIClosePlayer",function(){rspkr.hl.State.setState(rspkr.hl.State.READY)}),e("onUIStop",function(){rspkr.hl.State.setState(rspkr.hl.State.STOPPED)}),rspkr.evt("onAPIStop",rspkr.hl.sync.lightCleanUp),rspkr.pl&&rspkr.pl.setEvents&&"function"==typeof rspkr.pl.setEvents&&rspkr.pl.setEvents.apply(this,[]),!0!==rspkr.hl.engine.useTextNodeMarkup&&(e("onUIBeforePlay",function(){rspkr.hl.Restore.checkContent()}),e("onUIClosePlayer",rspkr.hl.cleanUpHandler))}()},cleanUpHandler:function(e){e=e,rspkr.log("[rspkr.hl.cleanUpHandler] String is: "+e),"userclick"===e||"nosel"===e?rspkr.hl.sync.fullCleanUp():rspkr.hl.sync.lightCleanUp()},clean:function(){$rs.arr(rspkr.selector.textnode).length&&rspkr.HL.engine.textNode.clientExtension.postProcess.fullCleanUp(),$rs.arr('[class^="sync_"]').length&&rspkr.HL.engine.gecko.clientExtension.postProcess.fullCleanUp()},getSyncContainers:function(e){e=e||window.document;var t=rspkr.Common.data.browser.syncContainer.replace(/(:|\.|\[|\]|,)/g,"\\$1");return $rs.arr(t+".sync_sent,"+t+".sync_word,"+t+".sync_sent_highlighted,"+t+".sync_word_highlighted,"+t+".sync_user,"+t+".synctemp,"+t+'[class*="ffsent"]',e)},clientMarkup:m,serverMarkup:e,markedUpHTML:[],Preserve:{cls:".rs_preserve",testElem:null,elementShelter:[],formShelter:[],formData:function(e,t,r,s,n){this.name=e,this.type=t,this.value=r,this.checked=s,this.selectedIndex=n,this.selectedOptions=[]},findPreserveElements:function(e){if(!e)return[];var t=[];if(e.childNodes)for(var r=$rs.findIn(e,rspkr.hl.Preserve.cls),r=$rs.isArray(r)?r:[r],s=0;s<r.length;s++){for(var n=!0,a=0;a<r.length;a++)if(r[a]!==r[s]&&function(e,t){for(var r=t.parentNode;r;){if(r===e)return 1;r=r.parentNode}}(r[a],r[s])){n=!1;break}n&&t.push(r[s])}return t},moveToShelter:function(e){rspkr.hl.Preserve.cls=rspkr.item("general.preserveElements")?rspkr.item("general.preserveElements"):rspkr.hl.Preserve.cls,rspkr.log("[rspkr.hl.Preserve.moveToShelter]");var t,r=[],s=[],n=rspkr.hl.Preserve.findPreserveElements(e),a=$rs.findIn(e,"input, select, textarea");for(a&&!$rs.isArray(a)&&(a=[a]),d=0;d<a.length;d++){var o=new rspkr.hl.Preserve.formData(a[d].name,a[d].type,a[d].value,a[d].checked,a[d].selectedIndex);if("select-multiple"===a[d].type){for(var i=a[d].options,l=[],c=0;c<i.length;c++)l.push(i[c].selected);o.selectedOptions=l}s.push(o)}rspkr.log("[rspkr.hl.Preserve] Saved formdata from "+a.length+" elements.");for(var p,d=0;p=n[d];d++)t=$rs.get(p).cloneNode(!1),p.parentNode.insertBefore(t,p),p.parentNode.removeChild(p),r.push(p);rspkr.log("[rspkr.hl.Preserve] Moved "+d+" nodes to the shelter."),rspkr.hl.Preserve.elementShelter.push(r),rspkr.hl.Preserve.formShelter.push(s)},restoreFromShelter:function(e){rspkr.log("[rspkr.hl.Preserve.restoreFromShelter]");var t,r,s=[];if(rspkr.hl.Preserve.elementShelter.length&&(r=rspkr.hl.Preserve.elementShelter.shift()).length)for(var s=rspkr.hl.Preserve.findPreserveElements(e),n=0;n<s.length;n++)(t=r.shift())&&s[n].parentNode.insertBefore(t,s[n]),s[n].parentNode.removeChild(s[n]);if(rspkr.hl.Preserve.formShelter.length){var a=$rs.findIn(e,"input, select, textarea");a&&!$rs.isArray(a)&&(a=[a]);var o=rspkr.hl.Preserve.formShelter.shift();if(a.length&&o.length&&a.length===o.length)for(var i=0;i<a.length;i++)if(a[i].name===o[i].name)switch(a[i].type){case"textarea":case"text":case"password":a[i].value=o[i].value;break;case"radio":!0===o[i].checked&&(a[i].checked=!0);break;case"checkbox":a[i].checked=o[i].checked;break;case"select-one":a[i].selectedIndex=o[i].selectedIndex;break;case"select-multiple":for(var l=a[i].options,c=0;c<l.length;c++)l[c].selected=o[i].selectedOptions[c]}}},clearShelter:function(){rspkr.log("[rspkr.hl.Preserve.clearShelter]"),rspkr.hl.Preserve.elementShelter=[],rspkr.hl.Preserve.formShelter=[]}},Restore:{Storage:{readClass:[],readId:[],restoreContent:[]},all:function(){rspkr.log("[rspkr.hl.Restore.all]");var e=rspkr.hl.Restore.Storage,r=[];if(!rspkr.item("general.premarkup")){if(rspkr.c.dispatchEvent("onBeforeContentChange",window),e.restoreContent.length){if((e.readId.length||e.readClass.length)&&e.restoreContent.length){var t=$rs.flatten(e.readClass),s=$rs.flatten(e.readId),t=t&&(1<t.length||0===t.length?t:t[0].split(",")),s=s&&(1<s.length||0===s.length?s:s[0].split(",")),n=t.length?("."+t.join(",.")).split(","):[],n=s.length?n.concat(("#"+s.join(",#")).split(",")):n,a=$rs.getReadingFrames(window);if(rspkr.item("general.readidOrder")&&rspkr.item("general.usePost"))for(var o=0,i=n.length;o<i;o++)a.forEach(function(e){try{var t=$rs.arr(n[o],e.document);r=r.concat(t)}catch(e){}});else a.forEach(function(e){try{var t=$rs.arr(n.join(","),e.document);r=r.concat(t)}catch(e){}});r=$rs.isArray(r)?r:[r];for(var l,r=$rs.flatten(r),c=0;l=r[c];c++)!0===/sync_(word|sent)/gi.test(l.innerHTML)&&(rspkr.hl.Preserve.moveToShelter(l),l.innerHTML=e.restoreContent[c],rspkr.hl.Preserve.restoreFromShelter(l))}}else rspkr.warn("No stored content exists!");rspkr.c.dispatchEvent("onAfterContentChange",window)}e.readId.length=0,e.readClass.length=0,e.restoreContent.length=0},checkContent:function(){rspkr.log("[rspkr.hl.Restore.checkContent]",1),!0!==rspkr.hl.engine.useTextNodeMarkup&&!1===this.hasMarkup()&&rspkr.hl.State.CURRENT===rspkr.hl.State.STOPPED&&rspkr.hl.Type.CURRENT===rspkr.hl.Type.SERVER_MARKUP&&(this.clearRestoreContent(),this.setRestoreContent(),rspkr.pl.releaseAdapter(),rspkr.hl.State.setState(rspkr.hl.State.RELOAD))},hasMarkup:function(){if(rspkr.hl.engine.useTextNodeMarkup)return!1;var e=rspkr.hl.Restore.Storage,t=[],r=$rs.flatten(e.readClass),s=$rs.flatten(e.readId),r=r&&(1<r.length||0===r.length?r:r[0].split(",")),s=s&&(1<s.length||0===s.length?s:s[0].split(",")),n=r.length?("."+r.join(",.")).split(","):[],n=s.length?n.concat(("#"+s.join(",#")).split(",")):n;if(rspkr.item("general.readidOrder")&&rspkr.item("general.usePost"))for(var a=0;a<n.length;a++)var o=$rs.arr(n[a]),t=t.concat(o);else t=$rs.get(n.join(",")),t=$rs.isArray(t)?t:[t],t=$rs.flatten(t);if((t=!$rs.isArray(t)?[t]:t).length&&e.restoreContent.length)for(var i=0;i<t.length;i++)if(/sync_(word|sent)/gi.test(t[i].innerHTML))return!0;return!1},clearRestoreContent:function(){rspkr.log("[rspkr.hl.Restore.clearRestoreContent] Called!")},setRestoreContent:function(){rspkr.log("[rspkr.hl.Restore.setRestoreContent] Called!");var e=rspkr.hl.Restore.Storage,r=[],t=e.restoreContent;if(0===e.readClass.length&&0===e.readId.length&&rspkr.hl.Restore.getReadData(),0===e.readClass.length&&0===e.readId.length)rspkr.error("ERR: Could not set restore content or find the read area data");else{var s=$rs.flatten(e.readClass),n=$rs.flatten(e.readId),s=s&&(1<s.length||0===s.length?s:s[0].split(",")),n=n&&(1<n.length||0===n.length?n:n[0].split(",")),a=s.length?("."+s.join(",.")).split(","):[],a=n.length?a.concat(("#"+n.join(",#")).split(",")):a,o=$rs.getReadingFrames(window);if(rspkr.item("general.readidOrder")&&rspkr.item("general.usePost")){for(var i=0,l=a.length;i<l;i++)o.forEach(function(e){try{var t=$rs.arr(a[i],e.document);r=r.concat(t)}catch(e){}});r=$rs.flatten(r)}else o.forEach(function(e){try{var t=$rs.arr(a.join(","),e.document);r=r.concat(t)}catch(e){}}),r=$rs.flatten(r);$rs.isArray(r)||(r=[r]),e.restoreContent=[];for(var c,p=0;c=r[p];p++)!1!==/sync_(word|sent|user)/gi.test(c.innerHTML)&&t.length&&t[p]?e.restoreContent.push(t[p]):e.restoreContent.push(c.innerHTML)}},getReadData:function(){rspkr.log("[rspkr.hl.Restore.getReadData]");for(var e=rspkr.hl.Restore.Storage,t=rspkr.ui.getActivePlayer()?$rs.findIn(rspkr.ui.getActivePlayer().getContainer(),".rsbtn_play"):$rs.findIn($rs.get(rspkr.rsbtnClass(!0)),".rsbtn_play"),r=0,s=(t=!$rs.isArray(t)?[t]:t).length;r<s;r++){var n,a=t[r].getAttribute("href").match(/readspeaker.?.com\/cgi-bin\/.*rsent/gi);rspkr.item("general.servercall")&&(a=a||-1<t[r].getAttribute("href").indexOf(rspkr.item("general.servercall"))),t[r].getAttribute("href")&&-1!==(t[r].getAttribute("href").indexOf(rspkr.item("general.domain")+"/cgi-bin/"+rspkr.item("general.rsent"))||a)&&"rsSaveBtn"!==t[r].id&&"rs_selimg"!==t[r].id&&(-1!==t[r].getAttribute("href").search(/readclass=[^&]+/gi)&&(n=t[r].getAttribute("href").match(/readclass=[^&]+/gi)[0].replace("readclass=","").split(","),rspkr.hl.Restore.Storage.readClass.push(n)),-1!==t[r].getAttribute("href").search(/readid=[^&]+/gi)&&(n=t[r].getAttribute("href").match(/readid=[^&]+/gi)[0].replace("readid=","").split(","),rspkr.hl.Restore.Storage.readId.push(n)))}0===e.readClass.length&&0===e.readId.length&&(rspkr.c.data.params.hasOwnProperty("readid")?e.readId.push([rspkr.c.data.params.readid]):rspkr.c.data.params.hasOwnProperty("readclass")&&e.readClass.push([rspkr.c.data.params.readclass]))}},State:{CURRENT:1,READY:1,STOPPED:2,PLAYING:3,RELOAD:4,setState:function(e){this.CURRENT=e,rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+e,1)}},sync:{init:function(){if(rspkr.devt("onBeforeSyncInit",window),rspkr.api.callback.execute(rspkr.api.callback.enums.AUDIO.LOADED,rspkr.ui.getActivePlayerElm()),k.hlChanged=!1,"textNode"===g||0<rspkr.Common.data.selectedText.length||0<rspkr.Common.data.selectedHTML.length)rspkr.log("[rspkr.hl._sync.init] client markup"),rspkr.hl.Type.CURRENT=rspkr.hl.Type.CLIENT_MARKUP,m.firstRun=1,"textNode"===g||m.preProcess.identifyElementsReplacementNode(rspkr.Common.data.selectedDocument),rspkr.hl.markedUpHTML.length=0;else if(rspkr.log("[rspkr.hl._sync.init] server markup"),rspkr.hl.Type.CURRENT=rspkr.hl.Type.SERVER_MARKUP,"none"!==rspkr.Common.data.sync){var e=[],t=[],r=[];rspkr.c.data.params.hasOwnProperty("readid")&&rspkr.c.data.params.readid.length&&(r=r.concat(("#"+rspkr.c.data.params.readid.split(",").join(",#")).split(","))),rspkr.c.data.params.hasOwnProperty("readclass")&&rspkr.c.data.params.readclass.length&&(r=r.concat(("."+rspkr.c.data.params.readclass.split(",").join(",.")).split(",")));var s=$rs.getReadingFrames(window);if(rspkr.item("general.readidOrder")&&rspkr.item("general.usePost"))for(var n=0;n<r.length;n++)for(var a=0;a<s.length;a++)try{var o=$rs.arr(r[n],s[a].document),e=e.concat(o)}catch(e){}else for(var i=0;i<s.length;i++)try{var l=$rs.get(r.join(","),s[i].document),l=$rs.isArray(l)?l:[l];l=$rs.flatten(l),e=e.concat(l)}catch(e){}if($rs.isArray(e)||(e=[e]),/webAudio/i.test(rspkr.PlayerAPI.adapter)&&rspkr.hl.markedUpHTML.length!==e.length)for(var c="\x3c!--RSPEAK_STOP--\x3e",p=rspkr.hl.markedUpHTML.join("").split(c),d=0;p[d];d++)0;else p=rspkr.hl.markedUpHTML;for(var u=rspkr.Util.xhtml.detect(),n=0;h=e[n];n++){var h=h.nodeName&&"TABLE"===h.nodeName?document.createElement("TABLE"):document.createElement("DIV");h.innerHTML=u?rspkr.Util.xhtml.innerHTML(p[n]):p[n],t.push(h)}if(rspkr.log("[rspkr.hl.sync.init] readElements length: "+e.length),!rspkr.item("general.premarkup")){rspkr.c.dispatchEvent("onBeforeContentChange",window);for(n=0;n<e.length;n++)rspkr.hl.Preserve.moveToShelter(e[n]),e[n].innerHTML=t[n].innerHTML,rspkr.hl.Preserve.restoreFromShelter(e[n]);rspkr.c.dispatchEvent("onAfterContentChange",window),rspkr.hl.Preserve.clearShelter()}rspkr.hl.markedUpHTML.length=0}else rspkr.hl.markedUpHTML.length=0;rspkr.c.post.removeIframe(),rspkr.c.dispatchEvent("onAfterSyncInit",window)},lightCleanUp:function(){rspkr.log("[rspkr.hl._sync.lightCleanUp] Called! "+rspkr.hl.Type.CURRENT),rspkr.hl.enlarge.isActive()&&rspkr.hl.enlarge.cleanUp(),rspkr.hl.Type.CURRENT===rspkr.hl.Type.SERVER_MARKUP&&e.postProcess.lightCleanUp(),rspkr.hl.Type.CURRENT===rspkr.hl.Type.CLIENT_MARKUP&&m.postProcess.lightCleanUp(),rspkr.Common.data.selectedText.length&&m.postProcess.lightCleanUp()},fullCleanUp:function(){rspkr.log("[rspkr.hl._sync.fullCleanUp] Called!"),rspkr.hl.enlarge.isActive()&&rspkr.hl.enlarge.cleanUp(),rspkr.hl.Type.CURRENT===rspkr.hl.Type.CLIENT_MARKUP&&m.postProcess.fullCleanUp(),e.postProcess.fullCleanUp()},setId:function(e){rspkr.log("[rspkr.hl._sync.setId] Called!")},setClass:function(){rspkr.log("[rspkr.hl._sync.setClass] Called!")},setContent:function(e){rspkr.log("[rspkr.hl._sync.setContent] Called!"),rspkr.hl.markedUpHTML.push(e)},execute:function(e,t){if(rspkr.hl.Type.CURRENT===rspkr.hl.Type.SERVER_MARKUP){for(var r=$rs.getReadingFrames(window,[window]),s=null,n=0;n<r.length;n++)try{var a=$rs.findIn(r[n].document,"#sync"+t);if(a){s=a;break}}catch(e){}if(s){var o=$rs.hasClass(s,"sync_sent")?"sent":"word";if("sent"===rspkr.st.get("hl")&&"word"==o)return;if("word"===rspkr.st.get("hl")&&"sent"==o)return}}rspkr.c.dispatchEvent("onBeforeSync",window,[e,t]),(rspkr.hl.Type.CURRENT===rspkr.hl.Type.CLIENT_MARKUP?rspkr.hl.clientMarkup:rspkr.hl.serverMarkup).sync(e,t),rspkr.c.dispatchEvent("onAfterSync",window,[e,t])}},settings:k,Type:{CURRENT:0,DEFAULT:0,SERVER_MARKUP:1,CLIENT_MARKUP:2}}}(),rspkr.hl.engine||(rspkr.hl.engine={}),rspkr.hl.engine.gecko={clientExtension:{name:"gecko",init:function(){rspkr.hl.engine.useTextNodeMarkup=!1},preProcess:{bookMarkIndex:1,endNode:null,endOffset:null,excludednodes:["table","tr","select","option","textarea","ul","ol","dl","thead","tbody","tfoot","colgroup","script","map","optgroup","style","noscript"],firstRun:0,inc:0,numberOfSelections:0,startNode:null,startOffset:null,sentenceDividers:[", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")],init:function(){this.numberOfSelections++;var e="",t=rspkr.Common.data.selectedRange;rspkr.Common.data.processedDocument=rspkr.Common.data.selectedDocument,this.startNode=t.startContainer,this.endNode=t.endContainer,this.startOffset=this.modifyOffsetStartOfWord(this.startNode,t.startOffset),this.endOffset=this.modifyOffsetEndOfWord(this.endNode,t.endOffset);var r=rspkr.Common.data.processedDocument||document;(e=this.buildMarkup(t.commonAncestorContainer,r)).replace(/  +/g," "),r.getSelection().removeAllRanges(),rspkr.Common.data.selectedHTML=e},addMarkup:function(e,t){this.numberOfSelections++,this.startNode=e,this.endtNode=e,this.startOffset=0,!(this.endOffset=0)===t&&this.sentenceDividers.splice(this.sentenceDividers.indexOf(", "),1);e=this.buildMarkup(e);e.replace(/  +/g," "),rspkr.Common.data.processedDocument&&rspkr.Common.data.processedDocument.getSelection().removeAllRanges(),rspkr.Common.data.selectedHTML=e},getHighestBookmarkIndex:function(){return $rs.arr("[id^=sync]").length+100},buildMarkup:function(e,t){t=t||document,this.firstRun=1;var r="",s=this.inc,n=!1;if(!1!==rspkr.item("general.searchLang")&&(e.nodeType===e.ELEMENT_NODE?n=rspkr.c.data.searchLangAttr(e):e.nodeType===e.TEXT_NODE&&(n=rspkr.c.data.searchLangAttr(e.parentNode))),3===e.nodeType)r+=this.textMarkup(e);else{var a,o="";if((e instanceof SVGElement||!$rs.hasClass(e,rspkr.rsbtnClass()))&&e.hasChildNodes())for(a=0;a<e.childNodes.length;a++){var i=e.childNodes.item(a);if(i===this.startNode&&(this.inc=1),e===this.startNode&&a===this.startOffset&&(this.inc=1),8!==i.nodeType&&(o+=this.buildMarkup(i,t)),e===this.endNode&&a===this.endOffset){this.inc=0;break}if(i===this.endNode){this.inc=0;break}}var l=!0;if(null!=$rs.getAttr(e,"id")&&(l=$rs.getAttr(e,"id").replace("sync","")===$rs.getAttr(e,"id")),(s||this.inc)&&(e instanceof SVGElement||!e.className||e.className.replace("sync","")===e.className&&l)){for(var l=t.createElement("div"),c=e.cloneNode(!0),p=c.attributes,d=0;d<p.length;d++)"data-"===p[d].name.substr(0,5)&&c.removeAttribute(p[d].name);rspkr.hl.clientMarkup.skipHidden(e)&&$rs.addClass(c,"rs_skip_always"),l.appendChild(c);l=l.innerHTML.match("<[^>]*>");l&&l.length?(r+=l[0],r+=o,r+="</"+e.nodeName+">"):r+=o}else r+=o;if(e.hasChildNodes())for(a=0;a<e.childNodes.length;a++){if(e===this.endNode&&a===this.endOffset){this.inc=0;break}if(i===this.endNode){this.inc=0;break}}}return r=""!==n&&!1!==n&&""!==r?"<"+rspkr.Common.data.browser.syncContainer+' lang="'+n+'">'+r+"</"+rspkr.Common.data.browser.syncContainer+">":r},textMarkup:function(e){var t=!0,r="",s="",n="",a=e.nodeValue;if(!a.replace(/[\r\n\t ]+/gm,"").length)return a;if(e===this.startNode&&-1!==this.startOffset&&e===this.endNode&&-1!==this.endOffset?(s=e.nodeValue.substring(0,this.startOffset),a=e.nodeValue.substring(this.startOffset,this.endOffset),n=e.nodeValue.substring(this.endOffset),this.inc=1):e===this.startNode&&-1!==this.startOffset?(s=e.nodeValue.substring(0,this.startOffset),a=e.nodeValue.substring(this.startOffset),this.inc=1):e===this.endNode&&-1!==this.endOffset&&(a=e.nodeValue.substring(0,this.endOffset),n=e.nodeValue.substring(this.endOffset),this.inc=1),!this.inc)return"";for(var o=0;o<this.excludednodes.length;o++)if(e.parentNode&&e.parentNode.nodeName.toLowerCase()===this.excludednodes[o]){t=!1,r=this.htmlencode(a);break}return t&&(r=this.markupSentences(this.htmlencode(a),null)),e===this.endNode&&-1!==this.endOffset&&(this.inc=0),rspkr.hl.clientMarkup.skipAlways(e)&&(r='<span class="rs_skip_always">'+r+"</span>"),t&&e.parentNode&&""!==a&&(rspkr.item("general.premarkup")||(n=this.createReplacementNode(s+r+n),e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e))),r},markupSentences:function(e){var t=this.splitString(e,this.sentenceDividers);if(!t||!e.replace(/[\r\n\t ]+/gm,"").length)return"";for(var r="",s="",n=!1,a=0;a<t.length;a++){for(;$rs.arr("#sync"+this.bookMarkIndex).length;)this.bookMarkIndex++;r+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_sent ffsent'+this.numberOfSelections+" cj"+this.numberOfSelections+'" ',r+='id="sync'+this.bookMarkIndex+'">',this.bookMarkIndex++,s=this.endsWithSpace(t[a])?(n=!0,t[a].slice(0,-1)):t[a],r+=this.markupWords(s),!0===n&&(r+=" "),r+="</"+rspkr.Common.data.browser.syncContainer+">",n=!1}return r},markupWords:function(e){var t=this.splitString(e," ");if(!t)return"";for(var r="",s=!1,n=0;n<t.length;n++){for(;$rs.arr("#sync"+this.bookMarkIndex).length;)this.bookMarkIndex++;r+="<"+rspkr.Common.data.browser.syncContainer+' class="sync_user sync_word ck'+this.numberOfSelections+'"',r+=' id="sync'+this.bookMarkIndex+'">',this.bookMarkIndex++,r+=this.endsWithSpace(t[n])?(s=!0,t[n].slice(0,-1)):t[n],r+="</"+rspkr.Common.data.browser.syncContainer+">",!0===s&&(r+=" "),s=!1}return r},htmlencode:function(e){var t=(rspkr.Common.data.processedDocument||document).createElement("div"),e=document.createTextNode(e);return t.appendChild(e),t.innerHTML},identifyElementsReplacementNode:function(e){if(e.tagName&&e.tagName.toLowerCase()===rspkr.Common.data.browser.syncContainer&&e.id&&(rspkr.hl.clientMarkup.selectedWordsRange[e.id]=e),e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];this.identifyElementsReplacementNode(r)}},createReplacementNode:function(e){var t=(rspkr.Common.data.processedDocument||document).createElement(rspkr.Common.data.browser.syncContainer);return t.innerHTML=e,t.setAttribute("class","synctemp rs_textselection cl"+this.numberOfSelections),t},modifyOffsetStartOfWord:function(e,t){for(var r=new Array(" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C"));e.nodeValue&&0!==t;){for(var s=0;s<r.length;s++)if(0===e.nodeValue.substring(t).indexOf(r[s]))return t;t--}return t},modifyOffsetEndOfWord:function(e,t){for(var r=new Array(" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C"));e.nodeValue&&t!==e.nodeValue.length;){for(var s=0;s<r.length;s++)if(0===e.nodeValue.substring(t-1).indexOf(r[s]))return t;t++}return t},splitString:function(e,t){for(var r=new Array(""),s=0,n=0;n<e.length;n++){for(var a=0;a<t.length;a++){for(var o=t[a],i=!0,l=0;l<o.length;l++)if(e.length-(n+l)<0||o[o.length-l-1]!==e[n-l-1]){i=!1;break}i&&(r[++s]="")}r[s]+=e[n]}return r},endsWithSpace:function(e){return-1!==e.indexOf(" ",e.length-" ".length)}},postProcess:{cleanUpSpans:function(){rspkr.log("[ClientMarkup.postProcess.cleanUpSpans] called!");for(var e,t=rspkr.Common.data.processedDocument||document,r=rspkr.hl.getSyncContainers(t),s=r.length-1;-1<s;s--)(e=t.createDocumentFragment()).textContent=r[s].textContent,r[s].parentNode.replaceChild(e,r[s])},lightCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.lightCleanUp] called!!");var e=rspkr.Common.data.processedDocument||document,e=rspkr.hl.getSyncContainers(e);rspkr.hl.css.sentOff(e),rspkr.hl.css.wordOff(e)},fullCleanUp:function(){rspkr.log("[ClientMarkup.postProcess.fullCleanUp] called!"),this.cleanUpSpans(),rspkr.Common.data.selectedHTML="",rspkr.Common.data.processedDocument=null}},sync:function(e,t){var r="none"!==rspkr.st.get("hl")&&"hloff"!==rspkr.st.get("hltoggle"),s=rspkr.hl.enlarge.isActive(),n=!1,a=rspkr.hl.enlarge.isActive()&&"bghlon"===rspkr.st.get("enlargebghl"),o=rspkr.st.get("hl"),i="wordsent"===o||"word"===o,l="wordsent"===o||"sent"===o;0==(2&e)&&(n=0!=(1&e));var c=this.selectedWordsRange?this.selectedWordsRange["sync"+t]:$rs.get("#sync"+t),o=c&&c.className&&c.className.replace("word","")!==c.className,e=c&&c.className&&c.className.replace("sent","")!==c.className;r&&rspkr.hl.engine.useTextNodeMarkup?rspkr.hl.engine.textNode.clientExtension.highlight(t,n):r&&(o&&i&&!n&&rspkr.hl.css.wordOff(),o&&i&&(!s||a)&&rspkr.hl.css.wordOn(c),e&&l&&!n&&rspkr.hl.css.sentOff(),e&&l&&(!s||a)&&rspkr.hl.css.sentOn(c)),c&&s&&(o&&i&&rspkr.hl.enlarge.wordHL(c,n),e&&l&&rspkr.hl.enlarge.sentHL(c,n)),c&&rspkr.ui.AutoScroll.scroll(c),!0!==rspkr.hl.engine.useTextNodeMarkup&&1===this.firstRun&&(this.firstRun=0,rspkr.mobile()||rspkr.hl.css.setRule("sent",".rs_textselection .sync_sent_highlighted",(rspkr.item("settings.textselection")||rspkr.hl.settings.enums.textSelectionStyle)+e))}}},rspkr.HL.css=function(){var l={word:{},sent:{}};return{setRule:function(e,t,r){if("string"==typeof r){var s=r.split(";");r={};for(var n,a=0;a<s.length;a++)s[a].length&&/:/.test(s[a])&&(r[(n=s[a].split(":"))[0].trim()]=n[1].trim())}l[e][t]=r},removeRule:function(e,t){delete l[e][t]},wordOn:function(e,t){$rs.addClass(e,t||"sync_word_highlighted");for(var r=$rs.getReadingFrames(),s=0;s<r.length;s++)for(var n=Object.keys(l.word),a=0;a<n.length;a++)$rs.css($rs.arr(n[a],r[s].document),l.word[n[a]])},wordOff:function(e,t){for(var r=$rs.getReadingFrames(),s=0;s<r.length;s++){for(var n=Object.keys(l.word),a=0;a<n.length;a++)for(var o=Object.keys(l.word[n[a]]),i=0;i<o.length;i++)$rs.css($rs.arr(n[a],r[s].document),o[i],rspkr.with.explorer()?"":null);(t=t||["sync_word_highlighted"]).constructor===Array||(t=[t]),e&&0<e.length||(e=$rs.arr("."+t.join(", ."),r[s].document)),$rs.removeClass(e,t.join(" "))}},sentOn:function(e,t){$rs.addClass(e,t||"sync_sent_highlighted");for(var r=$rs.getReadingFrames(),s=0;s<r.length;s++)for(var n=Object.keys(l.sent),a=0;a<n.length;a++)$rs.css($rs.arr(n[a],r[s].document),l.sent[n[a]])},sentOff:function(e,t){for(var r=$rs.getReadingFrames(),s=0;s<r.length;s++){for(var n=Object.keys(l.sent),a=0;a<n.length;a++)for(var o=Object.keys(l.sent[n[a]]),i=0;i<o.length;i++)$rs.css($rs.arr(n[a],r[s].document),o[i],rspkr.with.explorer()?"":null);(t=t||["sync_sent_highlighted"]).constructor===Array||(t=[t]),e&&0<e.length||(e=$rs.arr("."+t.join(", ."),r[s].document)),$rs.removeClass(e,t.join(" "))}},styles:l}}(),window.ReadSpeaker.hl.html5={States:{BEGIN:0,STOPPED:1,USER_START_NOT_READY:2,USER_START_PLAYING:3,NOT_PLAYING:4,CURRENT:0,setState:function(e){this.CURRENT=e,rspkr.log("[rspkr.hl.html5.States.setState] Changing state from "+this.CURRENT+" to "+e,1)}},Events:{canPlay:!1,durationChange:!1,syncReady:!1,eventTimer:null,onCanPlay:function(){return rspkr.log("onCanPlay fired!",1),this.canPlay=!0,this.checkCompletion(),this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1),rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh()},2500),!1},checkCompletion:function(){this.canPlay&&this.durationChange&&this.syncReady&&(clearTimeout(this.eventTimer),this.eventTimer=null,rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh())},onDurationChange:function(){rspkr.log("onDurationChange fired!",1),this.durationChange=!0,this.checkCompletion(),this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1),rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh()},2500)},onSyncReady:function(){rspkr.log("onSyncReady fired!",1),this.syncReady=!0,this.checkCompletion(),this.eventTimer=setTimeout(function(){rspkr.log("[rspkr.hl.html5.Events] Timer triggered. Starting playback.",1),rspkr.hl.html5.Events.resetAll(),rspkr.hl.html5.refresh()},2500)},resetAll:function(){this.canPlay=!1,this.durationChange=!1,this.syncReady=!1,this.onEndedDone=!1},onEnded:function(){!0!==this.onEndedDone&&(this.onEndedDone=!0,rspkr.hl.chunking.continueHref?window.rshlcontinue():window.rshlexit("false"))}},lastcurrenttime:-1,currentsyncindex:0,lastevent:null,lastlastevent:null,lastlastlastevent:null,synclist:[],synclistindex:0,audioUrl:null,backupUrl:null,frameUrl:null,timer:null,postMessageData:[],handlers:{init:function(){rspkr.log("[rspkr.hl.html5.handlers.init]"),rspkr.hl.html5.cronologyCheck={proxyCallsDone:!1,errorOccured:!1,quarantine:[]},rspkr.hl.html5.rshlendCall=!1;var e=Math.random(),t={};t.audioformat=rspkr.Common.data.browser.html5AudioFormat,t.requestgrouptype="html5iframe",t.requestgroup=e,t.chunk=1,rspkr.hl.html5.backupUrl=rspkr.Common.data.getAudioLink(t),"string"!=typeof rspkr.hl.html5.backupUrl&&rspkr.hl.html5.backupUrl.link&&(rspkr.hl.html5.backupUrl=rspkr.hl.html5.backupUrl.link),!0!==rspkr.item("general.usePost")&&!rspkr.Common.data.selectedText.length&&!rspkr.Common.data.selectedHTML.length||rspkr.mobile()?(rspkr.log("Normal audio init!"),rspkr.hl.html5.initSyncFrame(t),rspkr.hl.html5.initAudio()):rspkr.hl.html5.timer=setTimeout(function(){rspkr.hl.html5.initSyncFrame(t),rspkr.hl.html5.initAudio(),clearTimeout(rspkr.hl.html5.timer)},2e3)},play:function(){rspkr.log("[rspkr.hl.html5.handlers.play]"),rspkr.hl.Type.CURRENT===rspkr.hl.Type.CLIENT_MARKUP&&rspkr.hl.html5.States.CURRENT===rspkr.hl.html5.States.STOPPED?(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.hl.html5.handlers.runPostMessages()):rspkr.hl.Type.CURRENT===rspkr.hl.Type.SERVER_MARKUP&&rspkr.hl.html5.States.CURRENT===rspkr.hl.html5.States.STOPPED?rspkr.hl.State.setState(rspkr.hl.State.RELOAD)?this.init():(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN),rspkr.PlayerAPI.playerRef.pause(),rspkr.hl.html5.handlers.runPostMessages()):(rspkr.hl.html5.States.CURRENT=rspkr.hl.html5.States.USER_START_PLAYING,rspkr.hl.html5.refresh())},pause:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING),rspkr.hl.html5.lastcurrenttime=0},release:function(){rspkr.log("[rspkr.hl.html5.handlers.release]"),rspkr.hl.html5.synclist=[],rspkr.hl.html5.synclistindex=0,rspkr.hl.html5.currentsyncindex=0,rspkr.hl.html5.lastcurrenttime=-1,rspkr.hl.html5.audioUrl=null,rspkr.hl.html5.backupUrl=null,rspkr.hl.html5.frameUrl=null,rspkr.hl.html5.postMessageData=[],rspkr.hl.html5.endTimestamp=void 0,rspkr.hl.html5.Events.resetAll(),rspkr.PlayerAPI.playerRef=null;var e=document.getElementById("ReadSpeaker_sync_iframe");e&&(e.src="about:blank")},stop:function(){rspkr.hl.html5.States.setState(rspkr.hl.html5.States.STOPPED),rspkr.hl.html5.lastcurrenttime=-1,rspkr.hl.html5.currentsyncindex=0},restart:function(){rspkr.hl.html5.lastcurrenttime=-1,rspkr.hl.html5.currentsyncindex=0},updateTime:function(){rspkr.log("[rspkr.hl.html5.handlers.updateTime]"),rspkr.hl.html5.States.setState(rspkr.hl.html5.States.NOT_PLAYING),rspkr.hl.html5.lastcurrenttime=rspkr.PlayerAPI.playerRef.currentTime,rspkr.hl.html5.currentsyncindex=0,rspkr.hl.html5.handlers.setCurrentSyncIndex(),rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING)},runPostMessages:function(){rspkr.log("[rspkr.hl.html5.handlers.runPostMessages]");var e,t=rspkr.hl.html5.postMessageData;for(e in t)null!==t[e-1]&&"rshlsetContent"===t[e]?rspkr.hl.sync.setContent(rspkr.Common.base64.decode(t[e-1])):"rshlinit"===t[e]?(rspkr.hl.sync.init(),rspkr.pl.playPromise(rspkr.PlayerAPI.playerRef),rspkr.hl.html5.refresh()):t[e]},setCurrentSyncIndex:function(){if(rspkr.hl.html5.synclist.length&&rspkr.hl.html5.synclist[rspkr.hl.html5.currentsyncindex])for(;rspkr.hl.html5.synclist[rspkr.hl.html5.currentsyncindex]&&+rspkr.hl.html5.synclist[rspkr.hl.html5.currentsyncindex][0]-1e3*rspkr.PlayerAPI.playerRef.currentTime<=20;)rspkr.hl.html5.currentsyncindex++},totalTime:function(){var t=rspkr.PlayerAPI.playerRef;if(t){if(rspkr.with.opera()||!t.buffered||!t.buffered.end)return t.duration&&"infinity"!==t.duration.toString.toLowerCase()&&"NaN"!==t.duration?t.duration:t.currentTime+15;try{return t.buffered.length?t.buffered.end(t.buffered.length-1):t.buffered.end(0)}catch(e){return t.duration&&"infinity"!==t.duration.toString().toLowerCase()&&"NaN"!==t.duration?t.duration:t.currentTime+15}}}},initAudio:function(){rspkr.hl.html5.audioUrl||(rspkr.hl.html5.audioUrl=rspkr.hl.html5.backupUrl),rspkr.log("[rspkr.html5.initAudio] Audio URL: "+rspkr.hl.html5.audioUrl,1),(rspkr.mobile()||rspkr.with.safari())&&window.rspkr.audio&&"object"==typeof window.rspkr.audio?(rspkr.audio.src=rspkr.hl.html5.audioUrl,rspkr.PlayerAPI.playerRef=rspkr.audio,rspkr.log("[rspkr.hl.initAudio] Reusing existing audio element.",4)):(rspkr.PlayerAPI.playerRef=new Audio(rspkr.hl.html5.audioUrl),rspkr.mobile()&&rspkr.with.safari()&&(rspkr.audio=rspkr.PlayerAPI.playerRef));var e=rspkr.PlayerAPI.playerRef;e.loop=!1,e.preload="auto",e.volume=parseFloat((rspkr.st.get("hlvol")||100)/100),rspkr.devt("onVolumeAdjusted",window),(rspkr.mobile()||rspkr.with.safari())&&rspkr.pl.playPromise(rspkr.PlayerAPI.playerRef,void 0,void 0,!0),e.addEventListener("canplay",function(){rspkr.hl.html5.Events.onCanPlay()},!1),e.addEventListener("durationchange",function(){rspkr.log("[rspkr.hl.html5.initAudio] Durationchange occurred",1),1===rspkr.hl.html5.handlers.totalTime()&&!0===rspkr.PlayerAPI.playerRef.paused?rspkr.hl.html5.initAudio():(0===rspkr.hl.html5.handlers.totalTime()&&rspkr.pl.playPromise(rspkr.pl.playerRef),rspkr.hl.html5.Events.onDurationChange())},!1),rspkr.pl.checkNetworkStatus(),rspkr.hl.html5.States.setState(rspkr.hl.html5.States.BEGIN)},initSyncFrame:function(e){var t;"none"!==rspkr.Common.data.sync?(t=null,document.getElementById("ReadSpeaker_sync_iframe")?t=document.getElementById("ReadSpeaker_sync_iframe"):((t=document.createElement("iframe")).setAttribute("id","ReadSpeaker_sync_iframe"),t.setAttribute("title","ReadSpeaker_sync_iframe"),t.setAttribute("aria-hidden","true"),t.setAttribute("sandbox","allow-same-origin allow-scripts"),t.height=0,t.width=0,t.style.display="none",document.body.appendChild(t)),rspkr.hl.html5.frameUrl||!0!==rspkr.item("general.usePost")&&!rspkr.Common.data.selectedText.length&&!rspkr.Common.data.selectedHTML.length?rspkr.hl.html5.frameUrl||(e.audioformat="html5iframe",rspkr.hl.html5.frameUrl=rspkr.Common.data.getAudioLink(e)):rspkr.hl.html5.frameUrl=rspkr.hl.html5.backupUrl+"sync",rspkr.log("[rspkr.hl.html5.initSyncFrame] Audio URL: "+rspkr.hl.html5.frameUrl),rspkr.hl.html5.frameUrl&&(t.src=rspkr.hl.html5.frameUrl,t.type="text/javascript")):(rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING),rspkr.pl.playPromise(rspkr.PlayerAPI.playerRef))},removeSyncFrame:function(){var e=document.getElementById("ReadSpeaker_sync_iframe");e&&e.parentNode.removeChild(e)},receiveMessage:function(e){var t=!0;rspkr.item("general.servercall")&&(s=document.createElement("a"),$rs.setAttr(s,"href",rspkr.item("general.servercall")),t=!e.origin.match(s.hostname)),(r=document.createElement("a")).href=e.origin;var r=r.hostname,s=["\\.readspeaker\\.com$","\\.readspeaker\\.team$","^79\\.136\\.80\\.","^173\\.205\\.5\\.(19[3-9]|2[0-4][0-9]|25[0-4])$","^2001\\:668\\:1F\\:2A","^2001\\:9b0\\:2\\:703","\\."+rspkr.item("general.domain").replace(".","\\\\.")+"$"],s=new RegExp("("+s.join("|")+")","gi");if((r.match(s)||!t)&&"string"==typeof e.data){if(rspkr.hl.html5.postMessageData.push(e.data),rspkr.mobile()||"rshlfinished"!==e.data||(rspkr.hl.html5.timer&&clearTimeout(rspkr.hl.html5.timer),rspkr.hl.html5.initSyncFrame(),rspkr.hl.html5.initAudio()),"rshlend"===e.data)rspkr.hl.html5.lastevent&&rspkr.hl.html5.lastevent.data&&!isNaN(rspkr.hl.html5.lastevent.data)&&(rspkr.hl.html5.synclist[rspkr.hl.html5.synclistindex]=[rspkr.hl.html5.lastevent.data,"rshlend",0],rspkr.hl.html5.synclistindex++),rspkr.hl.html5.rshlendCall=!0,rspkr.c.post.removeIframe(),rspkr.hl.html5.removeSyncFrame();else{if("rshlaudio"===e.data)return void(rspkr.hl.html5.audioUrl=rspkr.item("general.customProxy")?rspkr.item("general.customProxy")+encodeURIComponent(rspkr.hl.html5.lastevent.data):rspkr.hl.html5.lastevent.data);if("rshlhtml5sync"===e.data){s=rspkr.hl.html5.lastevent.data,t=document.createElement("a");return(t.href=s,"http:"!==t.protocol&&"https:"!==t.protocol)?void 0:void(rspkr.hl.html5.frameUrl=rspkr.item("general.customProxy")?rspkr.item("general.customProxy")+encodeURIComponent(s):s)}if("rshlaudio"===e.data)return;null!==rspkr.hl.html5.lastevent&&"rshlsetContent"===e.data?(rspkr.hl.html5.synclist=[],rspkr.hl.html5.synclistindex=0,rspkr.hl.sync.setContent(rspkr.Common.base64.decode(rspkr.hl.html5.lastevent.data))):null!==rspkr.hl.html5.lastevent&&"rshlReplace"===e.data||("rshlinit"===e.data?(rspkr.hl.sync.init(),rspkr.hl.html5.Events.onSyncReady()):null!==rspkr.hl.html5.lastlastlastevent&&null!==rspkr.hl.html5.lastlastevent&&null!==rspkr.hl.html5.lastevent&&"rshlsync"===e.data?(rspkr.hl.html5.synclist[rspkr.hl.html5.synclistindex]=[rspkr.hl.html5.lastlastlastevent.data,rspkr.hl.html5.lastlastevent.data,rspkr.hl.html5.lastevent.data],rspkr.hl.html5.synclistindex++):null!==rspkr.hl.html5.lastevent&&"rshlcontinue"===e.data?(rspkr.hl.chunking.continueHref=rspkr.hl.html5.lastevent.data,rspkr.hl.chunking.continueTime=rspkr.hl.html5.lastlastevent&&!isNaN(rspkr.hl.html5.lastlastevent.data)?rspkr.hl.html5.lastlastevent.data:-1,rspkr.mobile()&&(rspkr.hl.chunking.continueTime=-1)):"rshlresume"===e.data&&(rspkr.hl.html5.synclist.length=0,rspkr.hl.html5.synclistindex=0,rspkr.hl.html5.currentsynclistindex=0,rspkr.hl.html5.currentsyncindex=0))}rspkr.hl.html5.lastlastlastevent=rspkr.hl.html5.lastlastevent,rspkr.hl.html5.lastlastevent=rspkr.hl.html5.lastevent,rspkr.hl.html5.lastevent=e}},refresh:function(){var e,t=rspkr.PlayerAPI.playerRef,r=rspkr.hl.html5;if(t&&r.States.CURRENT!==r.States.STOPPED){if(r.States.CURRENT===r.States.NOT_PLAYING&&setTimeout(function(){r.refresh()},500),0<t.currentTime&&parseInt(r.lastcurrenttime)>parseInt(Math.ceil(t.currentTime)))return rspkr.warn("[rspkr.hl.html5.refresh] An error has occurred. Player is stopped."),void rspkr.ui.getActivePlayer().stop();r.lastcurrenttime=t.currentTime,t.currentTime&&r.endTimestamp&&1e3*t.currentTime>=parseFloat(r.endTimestamp)&&rspkr.hl.html5.Events.onEnded(),r.States.CURRENT===r.States.BEGIN?(rspkr.hl.html5.States.setState(r.States.USER_START_NOT_READY),setTimeout(function(){r.refresh()},200)):r.States.CURRENT===r.States.USER_START_NOT_READY?0<r.handlers.totalTime()&&(rspkr.hl.html5.rshlendCall||r.synclist[r.currentsyncindex]&&r.synclist[r.currentsyncindex][0]<1e3*r.handlers.totalTime())?(rspkr.hl.html5.States.setState(r.States.USER_START_PLAYING),rspkr.pl.playPromise(t),setTimeout(function(){r.refresh()},50)):0===r.handlers.totalTime()?(rspkr.pl.playPromise(t),setTimeout(function(){r.refresh()},250)):r.synclist[r.currentsyncindex]?+r.synclist[r.currentsyncindex][0]-1e3*t.currentTime<=20?setTimeout(function(){r.refresh()},0):75<(e=+r.synclist[r.currentsyncindex][0]-1e3*t.currentTime-20)?setTimeout(function(){r.refresh()},75):e<0?setTimeout(function(){r.refresh()},0):setTimeout(function(){r.refresh()},e):setTimeout(function(){r.refresh()},75):r.States.CURRENT===r.States.USER_START_PLAYING&&(r.currentsyncindex===r.synclist.length-1&&r.synclist[r.currentsyncindex].length&&"rshlend"===r.synclist[r.currentsyncindex][1]&&(r.endTimestamp=r.synclist[r.currentsyncindex][0],r.currentsyncindex++),r.synclist[r.currentsyncindex]&&+r.synclist[r.currentsyncindex][0]-20<1e3*t.currentTime&&(rspkr.hl.sync.execute(r.synclist[r.currentsyncindex][1],r.synclist[r.currentsyncindex][2]),r.currentsyncindex++),r.synclist[r.currentsyncindex]?+r.synclist[r.currentsyncindex][0]-1e3*t.currentTime<=20?setTimeout(function(){r.refresh()},0):75<(e=+r.synclist[r.currentsyncindex][0]-1e3*t.currentTime-20)?setTimeout(function(){r.refresh()},75):e<0?setTimeout(function(){r.refresh()},0):setTimeout(function(){r.refresh()},e):setTimeout(function(){r.refresh()},75))}else rspkr.warn("[rspkr.hl.html5.refresh] Audio is undefined or player is stopped")}},ReadSpeaker.hl.enlarge={isActive:function(){return!1}},String.prototype.substrSearch=function(e,t){return this.substr(e,this.indexOf(t,e)-e)},Element.prototype.insertChildAtIndex=function(e,t){(t||0)>=this.childNodes.length?this.appendChild(e):this.insertBefore(e,this.childNodes[t])},Text.prototype&&"function"!=typeof Text.prototype.contains&&(Text.prototype.contains=function(){return!1}),Element.prototype.containsExt=function(e){return!!this.contains(e)||!(!$rs.parent(e)||!this.contains($rs.parent(e)))},Document.prototype.containsExt=Document.prototype.contains,window.HTMLDocument.prototype.containsExt=window.HTMLDocument.prototype.contains,DocumentFragment.prototype.containsExt=DocumentFragment.prototype.contains,rspkr.hl.engine.textNode=function(){var A={name:"textNode",enums:{level:{SENT:1,WORD:2}},init:function(){rspkr.hl.engine.useTextNodeMarkup=!0},preProcess:{excludedNodes:["br","select","option","textarea","colgroup","script","map","optgroup","style","#comment"],excludedClasses:["rsbtn"],mutedNodes:["noscript"],init:function(){rspkr.hl.clean(),A.preProcess.idGen.reset();var e=rspkr.item("general.labels.ignoreSelector")||void 0;e&&e.trim().length&&(document.querySelectorAll("[data-rs-labelignored]").forEach(function(e){e.removeAttribute("data-rs-labelignored")}),document.querySelectorAll(e).forEach(function(e){e.classList.add(rspkr.cls.content),e.setAttribute("data-rs-labelignored","1")})),rspkr.hl.sentOnlyLang=this.isSentOnly(),rspkr.c.dispatchEvent("onBeforeContentChange",window),A.preProcess.textSelection.postContent="",rspkr.c.data.selectedRange&&rspkr.c.data.selectedRange.commonAncestorContainer&&rspkr.c.data.selectedRange.commonAncestorContainer.textContent&&rspkr.c.data.selectedRange.commonAncestorContainer.textContent.trim().length?(this.textSelection.finetuneRange(),this.textSelection.injectMarkup(rspkr.c.data.selectedRange)):this.readArea.injectMarkup(rspkr.c.data.getDefaultReadElements()),delete rspkr.hl.sentOnlyLang},idGen:{create:function(){return"sync"+ ++A.preProcess.id},reset:function(){A.preProcess.id=0}},isSentOnly:function(e){return e=e||rspkr.c.data.getParam("lang"),-1!==rspkr.item("general.sentOnlyLang").indexOf(e)},readArea:{injectMarkup:function(e){if(!rspkr.item("general.premarkup")){e instanceof Array||(e=[e]);for(var t,r=0;t=e[r];r++){var s=A.preProcess.common.extract.label(t);if(s.valid&&s.label)break;if(!A.preProcess.common.test.preserved(t))for(var n,a,o=(rspkr.shadowDOM.isShadow(t)?t.shadowRoot:t).childNodes,i=0;n=o[i];i++)3===n.nodeType?(a=A.preProcess.common.wrap.textNode(n))&&t.replaceChild(a.replace,n):n.closest&&n.closest(rspkr.selector.secret)?n.classList.add(rspkr.cls.secret+"_tmp"):-1!==A.preProcess.excludedNodes.indexOf(n.nodeName.toLowerCase())||n instanceof SVGElement||n.className&&$rs.arraySearch(n.className.split(" "),A.preProcess.excludedClasses)||n.classList.contains(rspkr.cls.skip)||A.preProcess.common.test.preserved(n)||(-1!==A.preProcess.mutedNodes.indexOf(n.nodeName.toLowerCase())||rspkr.hl.clientMarkup.skipHidden(n)?(n.classList.contains(rspkr.cls.skip)||n.classList.add("tmp_skip"),n.classList.add(rspkr.cls.skip)):rspkr.shadowDOM.isShadow(n)?A.preProcess.readArea.injectMarkup(n.shadowRoot):(a=A.preProcess.common.extract.label(n)).valid&&a.label?A.preProcess.textSelection.postContent+=$rs.createElm("div",{content:a.label}).outerHTML:A.preProcess.readArea.injectMarkup(n))}}}},textSelection:{finetuneRange:function(){var e=rspkr.c.data.selectedDocument||document,t=rspkr.c.data.selectionBackupData&&(rspkr.c.data.selectionBackupData.startContainer===rspkr.c.data.selectionBackupData.endContainer||!document.body.containsExt(rspkr.c.data.selectionBackupData.startContainer)&&!document.body.containsExt(rspkr.c.data.selectionBackupData.endContainer)&&rspkr.c.data.selectedRange.startContainer===rspkr.c.data.selectedRange.endContainer);if(rspkr.c.data.selectionBackupData&&!e.containsExt(rspkr.c.data.selectionBackupData.startContainer)){var r=3===rspkr.c.data.selectedRange.startContainer.nodeType?rspkr.c.data.selectedRange.startContainer:rspkr.c.data.selectedRange.startContainer.childNodes.length&&!isNaN(rspkr.c.data.selectionBackupData.startNodePosition)?rspkr.c.data.selectedRange.startContainer.childNodes[rspkr.c.data.selectionBackupData.startNodePosition]:rspkr.c.data.selectedRange.startContainer.childNodes[0];if(isNaN(rspkr.c.data.selectionBackupData.startOffsetNormalized))for(var s=0,n=$rs.parent(rspkr.c.data.selectionBackupData.startContainer).childNodes,a=0;a<n.length;a++){if(3===n[a].nodeType&&n[a]===rspkr.c.data.selectionBackupData.startContainer){rspkr.c.data.selectedRange.setStart(r,s+rspkr.c.data.selectionBackupData.startOffset),t&&rspkr.c.data.selectedRange.setEnd(r,s+rspkr.c.data.selectionBackupData.endOffset);break}s+=n[a].textContent.length}else rspkr.c.data.selectedRange.setStart(r,rspkr.c.data.selectionBackupData.startOffsetNormalized),t&&rspkr.c.data.selectedRange.setEnd(r,rspkr.c.data.selectionBackupData.endOffsetNormalized)}if(!t&&rspkr.c.data.selectionBackupData&&!e.containsExt(rspkr.c.data.selectionBackupData.endContainer)){var o=3===rspkr.c.data.selectedRange.endContainer.nodeType?rspkr.c.data.selectedRange.endContainer:rspkr.c.data.selectedRange.endContainer.childNodes.length&&!isNaN(rspkr.c.data.selectionBackupData.endNodePosition)?rspkr.c.data.selectedRange.endContainer.childNodes[rspkr.c.data.selectionBackupData.endNodePosition]:rspkr.c.data.selectedRange.endContainer.childNodes[0];if(isNaN(rspkr.c.data.selectionBackupData.endOffsetNormalized))for(var i=0,n=$rs.parent(rspkr.c.data.selectionBackupData.endContainer).childNodes,a=0;a<n.length;a++){if(3===n[a].nodeType&&n[a]===rspkr.c.data.selectionBackupData.endContainer){t&&rspkr.c.data.selectedRange.setStart(o,i+rspkr.c.data.selectionBackupData.startOffset),rspkr.c.data.selectedRange.setEnd(o,i+rspkr.c.data.selectionBackupData.endOffset);break}i+=n[a].textContent.length}else t&&rspkr.c.data.selectedRange.setStart(o,rspkr.c.data.selectionBackupData.startOffsetNormalized),rspkr.c.data.selectedRange.setEnd(o,rspkr.c.data.selectionBackupData.endOffsetNormalized)}},injectMarkup:function(e,t,r){if(e||t){var s;e?(A.preProcess.textSelection.postContent="",this.range=e,this.startContainer=e.startContainer,this.endContainer=e.endContainer,this.passedStartContainer=!1,this.passedEndContainer=!1,r={start:this.modifyOffsetStartOfWord(this.startContainer,e.startOffset),end:this.modifyOffsetEndOfWord(this.endContainer,e.endOffset)},s=3===e.commonAncestorContainer.nodeType?[e.commonAncestorContainer]:e.commonAncestorContainer.childNodes):t&&(s=t.childNodes);for(var n,a=0;n=s[a];a++){if(!this.passedStartContainer){if(!this.startContainer.contains(n)&&!n.contains(this.startContainer))continue;n===this.startContainer&&(this.passedStartContainer=!0)}if(this.passedEndContainer)break;n===this.endContainer&&(this.passedEndContainer=!0);var o={start:0,end:0};if(n.nodeValue&&(o.end=n.nodeValue.length),n.innerText&&(o.end=n.innerText.length),n.contains(this.startContainer)&&(o.start=r.start),n.contains(this.endContainer)&&(o.end=r.end),3===n.nodeType)$rs.parent(n).closest(rspkr.selector.secret)||(d=rspkr.hl.clientMarkup.skipAlways(n),(d=A.preProcess.common.wrap.textNode(n,o,d))&&(!0!==d.disableReplacement&&$rs.parent(n).replaceChild(d.replace,n),A.preProcess.textSelection.postContent+=d.postContent+" "));else if(n.closest&&n.closest(rspkr.selector.secret))n.classList.add(rspkr.cls.secret+"_tmp");else if(!(-1!==A.preProcess.excludedNodes.indexOf(n.nodeName.toLowerCase())||n instanceof SVGElement||n.className&&$rs.arraySearch(n.className.split(" "),A.preProcess.excludedClasses)))if(rspkr.hl.clientMarkup.skipHidden(n))n.classList.contains(rspkr.cls.skipalways)||n.classList.add("tmp_skip_always"),n.classList.add(rspkr.cls.skipalways);else if(A.preProcess.common.test.preserved(n))A.preProcess.textSelection.postContent+=n.outerHTML;else{for(var i,l=n.attributes,c="",p=0;i=l[p];p++)"data-"===i.name.substring(0,5)&&"data-mathml"!==i.name&&(c+=" "+i.name+'="'+encodeURIComponent(i.value)+'"');var d="<%e%i%c%a>".replace("%e",n.nodeName).replace("%i",n.id?' id="'+n.id+'"':"").replace("%c",n.className?' class="'+n.className+'"':"").replace("%a",c);A.preProcess.textSelection.postContent+=d;d=A.preProcess.common.extract.label(n);d.valid&&d.label?A.preProcess.textSelection.postContent+=$rs.createElm("div",{content:d.label}).outerHTML:A.preProcess.textSelection.injectMarkup(void 0,n,o),A.preProcess.textSelection.postContent+="</%e>".replace("%e",n.nodeName)}}e&&(window.getSelection().removeAllRanges(),rspkr.c.data.selectedHTML=A.preProcess.textSelection.postContent||$rs.createElm("div").outerHTML,rspkr.c.data.selectedHTML=rspkr.c.data.cleanSecretContent(rspkr.c.data.selectedHTML))}else rspkr.error("[rspkr.hl.engine.textNode] Text-selection highlighting called without a range or element.")},wordDelimiters:new Array(" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"),decodeURIComponent("%DB%94"),decodeURIComponent("%D8%8C")),modifyOffsetStartOfWord:function(e,t){for(;e.nodeValue&&0!==t;){for(var r=0;r<this.wordDelimiters.length;r++)if(0===e.nodeValue.substring(t).indexOf(this.wordDelimiters[r]))return t;t--}return t},modifyOffsetEndOfWord:function(e,t){for(;e.nodeValue&&t!==e.nodeValue.length;){for(var r=0;r<this.wordDelimiters.length;r++)if(0===e.nodeValue.substring(t-1).indexOf(this.wordDelimiters[r]))return t;t++}return t}},common:{wrap:{textNode:function(e,t,r){if(e.textContent.trim().length){var s,n,a=!!t,o="",i="",l=0,c=A.preProcess.common.split.sentences(e.textContent);!1!==rspkr.item("general.searchLang")&&(s=rspkr.c.data.searchLangAttr(e),n=rspkr.c.data.searchVoiceAttr(e)),s&&(rspkr.hl.sentOnlyLang=A.preProcess.isSentOnly(s));for(var p,d=0;p=c[d];d++)if(a&&(l+p.length<t.start||l>t.end))l+=p.length,l+=(b=e.textContent.substrSearch(l,c[d+1])).length,o+=p+b;else{var u="",h=0;if(!0===rspkr.hl.sentOnlyLang)u=p;else for(var g,m=(m=A.preProcess.common.split.words(p)).filter(function(e){return e.length}),k=0;g=m[k];k++){var f=l+h;a&&(f<t.start||f>=t.end)?(u+=g,h+=g.length):(h+=g.length,u+=(g=g.replace(/&/g,"&amp;").replace(/</g,"&lt;")).trim().length?A.preProcess.common.wrap.text(g,{level:A.enums.level.WORD}).replace:g)}var y,b,v=A.preProcess.common.wrap.text(u,{level:A.enums.level.SENT,search:a});o+=v.replace,a&&(s||n||r?(y=$rs.createElm("div",{content:v.postContent}),s&&y.setAttribute("lang",s),n&&y.setAttribute("style",n),r&&y.classList.add(rspkr.cls.skipalways),i+=y.outerHTML):i+=v.postContent),l+=p.length,d<c.length-1?(l+=(b=e.textContent.substrSearch(l,c[d+1])).length,o+=b):l+1<e.textContent.length&&(o+=e.textContent.substr(h))}var C={};return C.replace=$rs.createElm(rspkr.c.data.browser.syncContainer,{cls:rspkr.cls.textnode,content:o}),a&&(C.postContent=i),rspkr.item("general.premarkup")&&(C.disableReplacement=!0),C}},text:function(e,t){var r={};if(!0===t.search&&!0!==rspkr.hl.sentOnlyLang){var s=$rs.createElm("div"),n=$rs.createElm("div"),a=$rs.createElm(rspkr.c.data.browser.syncContainer,{cls:"sync_user sync_sent",id:A.preProcess.idGen.create()}),o=$rs.createElm("div");for(s.innerHTML=e;s.hasChildNodes();)if(3===s.childNodes[0].nodeType)(a.hasChildNodes()?o:n).appendChild(s.childNodes[0]);else{for(;o.hasChildNodes();)a.appendChild(o.childNodes[0]);a.appendChild(s.childNodes[0])}r.replace=n.innerHTML+a.outerHTML+o.innerHTML,r.postContent=a.outerHTML+" "}else{t=$rs.createElm(rspkr.c.data.browser.syncContainer,{content:e,cls:t.level===A.enums.level.SENT?"sync_sent":"sync_word",id:A.preProcess.idGen.create()});r.replace=t.outerHTML,rspkr.hl.sentOnlyLang&&(r.postContent=t.outerHTML)}return r}},split:{sentences:function(e){var t=decodeURIComponent("A-Za-z%5CxAA%5CxB5%5CxBA%5CxC0-%5CxD6%5CxD8-%5CxF6%5CxF8-%5Cu02C1%5Cu02C6-%5Cu02D1%5Cu02E0-%5Cu02E4%5Cu02EC%5Cu02EE%5Cu0370-%5Cu0374%5Cu0376%5Cu0377%5Cu037A-%5Cu037D%5Cu0386%5Cu0388-%5Cu038A%5Cu038C%5Cu038E-%5Cu03A1%5Cu03A3-%5Cu03F5%5Cu03F7-%5Cu0481%5Cu048A-%5Cu0527%5Cu0531-%5Cu0556%5Cu0559%5Cu0561-%5Cu0587%5Cu05D0-%5Cu05EA%5Cu05F0-%5Cu05F2%5Cu0620-%5Cu064A%5Cu066E%5Cu066F%5Cu0671-%5Cu06D3%5Cu06D5%5Cu06E5%5Cu06E6%5Cu06EE%5Cu06EF%5Cu06FA-%5Cu06FC%5Cu06FF%5Cu0710%5Cu0712-%5Cu072F%5Cu074D-%5Cu07A5%5Cu07B1%5Cu07CA-%5Cu07EA%5Cu07F4%5Cu07F5%5Cu07FA%5Cu0800-%5Cu0815%5Cu081A%5Cu0824%5Cu0828%5Cu0840-%5Cu0858%5Cu08A0%5Cu08A2-%5Cu08AC%5Cu0904-%5Cu0939%5Cu093D%5Cu0950%5Cu0958-%5Cu0961%5Cu0971-%5Cu0977%5Cu0979-%5Cu097F%5Cu0985-%5Cu098C%5Cu098F%5Cu0990%5Cu0993-%5Cu09A8%5Cu09AA-%5Cu09B0%5Cu09B2%5Cu09B6-%5Cu09B9%5Cu09BD%5Cu09CE%5Cu09DC%5Cu09DD%5Cu09DF-%5Cu09E1%5Cu09F0%5Cu09F1%5Cu0A05-%5Cu0A0A%5Cu0A0F%5Cu0A10%5Cu0A13-%5Cu0A28%5Cu0A2A-%5Cu0A30%5Cu0A32%5Cu0A33%5Cu0A35%5Cu0A36%5Cu0A38%5Cu0A39%5Cu0A59-%5Cu0A5C%5Cu0A5E%5Cu0A72-%5Cu0A74%5Cu0A85-%5Cu0A8D%5Cu0A8F-%5Cu0A91%5Cu0A93-%5Cu0AA8%5Cu0AAA-%5Cu0AB0%5Cu0AB2%5Cu0AB3%5Cu0AB5-%5Cu0AB9%5Cu0ABD%5Cu0AD0%5Cu0AE0%5Cu0AE1%5Cu0B05-%5Cu0B0C%5Cu0B0F%5Cu0B10%5Cu0B13-%5Cu0B28%5Cu0B2A-%5Cu0B30%5Cu0B32%5Cu0B33%5Cu0B35-%5Cu0B39%5Cu0B3D%5Cu0B5C%5Cu0B5D%5Cu0B5F-%5Cu0B61%5Cu0B71%5Cu0B83%5Cu0B85-%5Cu0B8A%5Cu0B8E-%5Cu0B90%5Cu0B92-%5Cu0B95%5Cu0B99%5Cu0B9A%5Cu0B9C%5Cu0B9E%5Cu0B9F%5Cu0BA3%5Cu0BA4%5Cu0BA8-%5Cu0BAA%5Cu0BAE-%5Cu0BB9%5Cu0BD0%5Cu0C05-%5Cu0C0C%5Cu0C0E-%5Cu0C10%5Cu0C12-%5Cu0C28%5Cu0C2A-%5Cu0C33%5Cu0C35-%5Cu0C39%5Cu0C3D%5Cu0C58%5Cu0C59%5Cu0C60%5Cu0C61%5Cu0C85-%5Cu0C8C%5Cu0C8E-%5Cu0C90%5Cu0C92-%5Cu0CA8%5Cu0CAA-%5Cu0CB3%5Cu0CB5-%5Cu0CB9%5Cu0CBD%5Cu0CDE%5Cu0CE0%5Cu0CE1%5Cu0CF1%5Cu0CF2%5Cu0D05-%5Cu0D0C%5Cu0D0E-%5Cu0D10%5Cu0D12-%5Cu0D3A%5Cu0D3D%5Cu0D4E%5Cu0D60%5Cu0D61%5Cu0D7A-%5Cu0D7F%5Cu0D85-%5Cu0D96%5Cu0D9A-%5Cu0DB1%5Cu0DB3-%5Cu0DBB%5Cu0DBD%5Cu0DC0-%5Cu0DC6%5Cu0E01-%5Cu0E30%5Cu0E32%5Cu0E33%5Cu0E40-%5Cu0E46%5Cu0E81%5Cu0E82%5Cu0E84%5Cu0E87%5Cu0E88%5Cu0E8A%5Cu0E8D%5Cu0E94-%5Cu0E97%5Cu0E99-%5Cu0E9F%5Cu0EA1-%5Cu0EA3%5Cu0EA5%5Cu0EA7%5Cu0EAA%5Cu0EAB%5Cu0EAD-%5Cu0EB0%5Cu0EB2%5Cu0EB3%5Cu0EBD%5Cu0EC0-%5Cu0EC4%5Cu0EC6%5Cu0EDC-%5Cu0EDF%5Cu0F00%5Cu0F40-%5Cu0F47%5Cu0F49-%5Cu0F6C%5Cu0F88-%5Cu0F8C%5Cu1000-%5Cu102A%5Cu103F%5Cu1050-%5Cu1055%5Cu105A-%5Cu105D%5Cu1061%5Cu1065%5Cu1066%5Cu106E-%5Cu1070%5Cu1075-%5Cu1081%5Cu108E%5Cu10A0-%5Cu10C5%5Cu10C7%5Cu10CD%5Cu10D0-%5Cu10FA%5Cu10FC-%5Cu1248%5Cu124A-%5Cu124D%5Cu1250-%5Cu1256%5Cu1258%5Cu125A-%5Cu125D%5Cu1260-%5Cu1288%5Cu128A-%5Cu128D%5Cu1290-%5Cu12B0%5Cu12B2-%5Cu12B5%5Cu12B8-%5Cu12BE%5Cu12C0%5Cu12C2-%5Cu12C5%5Cu12C8-%5Cu12D6%5Cu12D8-%5Cu1310%5Cu1312-%5Cu1315%5Cu1318-%5Cu135A%5Cu1380-%5Cu138F%5Cu13A0-%5Cu13F4%5Cu1401-%5Cu166C%5Cu166F-%5Cu167F%5Cu1681-%5Cu169A%5Cu16A0-%5Cu16EA%5Cu1700-%5Cu170C%5Cu170E-%5Cu1711%5Cu1720-%5Cu1731%5Cu1740-%5Cu1751%5Cu1760-%5Cu176C%5Cu176E-%5Cu1770%5Cu1780-%5Cu17B3%5Cu17D7%5Cu17DC%5Cu1820-%5Cu1877%5Cu1880-%5Cu18A8%5Cu18AA%5Cu18B0-%5Cu18F5%5Cu1900-%5Cu191C%5Cu1950-%5Cu196D%5Cu1970-%5Cu1974%5Cu1980-%5Cu19AB%5Cu19C1-%5Cu19C7%5Cu1A00-%5Cu1A16%5Cu1A20-%5Cu1A54%5Cu1AA7%5Cu1B05-%5Cu1B33%5Cu1B45-%5Cu1B4B%5Cu1B83-%5Cu1BA0%5Cu1BAE%5Cu1BAF%5Cu1BBA-%5Cu1BE5%5Cu1C00-%5Cu1C23%5Cu1C4D-%5Cu1C4F%5Cu1C5A-%5Cu1C7D%5Cu1CE9-%5Cu1CEC%5Cu1CEE-%5Cu1CF1%5Cu1CF5%5Cu1CF6%5Cu1D00-%5Cu1DBF%5Cu1E00-%5Cu1F15%5Cu1F18-%5Cu1F1D%5Cu1F20-%5Cu1F45%5Cu1F48-%5Cu1F4D%5Cu1F50-%5Cu1F57%5Cu1F59%5Cu1F5B%5Cu1F5D%5Cu1F5F-%5Cu1F7D%5Cu1F80-%5Cu1FB4%5Cu1FB6-%5Cu1FBC%5Cu1FBE%5Cu1FC2-%5Cu1FC4%5Cu1FC6-%5Cu1FCC%5Cu1FD0-%5Cu1FD3%5Cu1FD6-%5Cu1FDB%5Cu1FE0-%5Cu1FEC%5Cu1FF2-%5Cu1FF4%5Cu1FF6-%5Cu1FFC%5Cu2071%5Cu207F%5Cu2090-%5Cu209C%5Cu2102%5Cu2107%5Cu210A-%5Cu2113%5Cu2115%5Cu2119-%5Cu211D%5Cu2124%5Cu2126%5Cu2128%5Cu212A-%5Cu212D%5Cu212F-%5Cu2139%5Cu213C-%5Cu213F%5Cu2145-%5Cu2149%5Cu214E%5Cu2183%5Cu2184%5Cu2C00-%5Cu2C2E%5Cu2C30-%5Cu2C5E%5Cu2C60-%5Cu2CE4%5Cu2CEB-%5Cu2CEE%5Cu2CF2%5Cu2CF3%5Cu2D00-%5Cu2D25%5Cu2D27%5Cu2D2D%5Cu2D30-%5Cu2D67%5Cu2D6F%5Cu2D80-%5Cu2D96%5Cu2DA0-%5Cu2DA6%5Cu2DA8-%5Cu2DAE%5Cu2DB0-%5Cu2DB6%5Cu2DB8-%5Cu2DBE%5Cu2DC0-%5Cu2DC6%5Cu2DC8-%5Cu2DCE%5Cu2DD0-%5Cu2DD6%5Cu2DD8-%5Cu2DDE%5Cu2E2F%5Cu3005%5Cu3006%5Cu3031-%5Cu3035%5Cu303B%5Cu303C%5Cu3041-%5Cu3096%5Cu309D-%5Cu309F%5Cu30A1-%5Cu30FA%5Cu30FC-%5Cu30FF%5Cu3105-%5Cu312D%5Cu3131-%5Cu318E%5Cu31A0-%5Cu31BA%5Cu31F0-%5Cu31FF%5Cu3400-%5Cu4DB5%5Cu4E00-%5Cu9FCC%5CuA000-%5CuA48C%5CuA4D0-%5CuA4FD%5CuA500-%5CuA60C%5CuA610-%5CuA61F%5CuA62A%5CuA62B%5CuA640-%5CuA66E%5CuA67F-%5CuA697%5CuA6A0-%5CuA6E5%5CuA717-%5CuA71F%5CuA722-%5CuA788%5CuA78B-%5CuA78E%5CuA790-%5CuA793%5CuA7A0-%5CuA7AA%5CuA7F8-%5CuA801%5CuA803-%5CuA805%5CuA807-%5CuA80A%5CuA80C-%5CuA822%5CuA840-%5CuA873%5CuA882-%5CuA8B3%5CuA8F2-%5CuA8F7%5CuA8FB%5CuA90A-%5CuA925%5CuA930-%5CuA946%5CuA960-%5CuA97C%5CuA984-%5CuA9B2%5CuA9CF%5CuAA00-%5CuAA28%5CuAA40-%5CuAA42%5CuAA44-%5CuAA4B%5CuAA60-%5CuAA76%5CuAA7A%5CuAA80-%5CuAAAF%5CuAAB1%5CuAAB5%5CuAAB6%5CuAAB9-%5CuAABD%5CuAAC0%5CuAAC2%5CuAADB-%5CuAADD%5CuAAE0-%5CuAAEA%5CuAAF2-%5CuAAF4%5CuAB01-%5CuAB06%5CuAB09-%5CuAB0E%5CuAB11-%5CuAB16%5CuAB20-%5CuAB26%5CuAB28-%5CuAB2E%5CuABC0-%5CuABE2%5CuAC00-%5CuD7A3%5CuD7B0-%5CuD7C6%5CuD7CB-%5CuD7FB%5CuF900-%5CuFA6D%5CuFA70-%5CuFAD9%5CuFB00-%5CuFB06%5CuFB13-%5CuFB17%5CuFB1D%5CuFB1F-%5CuFB28%5CuFB2A-%5CuFB36%5CuFB38-%5CuFB3C%5CuFB3E%5CuFB40%5CuFB41%5CuFB43%5CuFB44%5CuFB46-%5CuFBB1%5CuFBD3-%5CuFD3D%5CuFD50-%5CuFD8F%5CuFD92-%5CuFDC7%5CuFDF0-%5CuFDFB%5CuFE70-%5CuFE74%5CuFE76-%5CuFEFC%5CuFF21-%5CuFF3A%5CuFF41-%5CuFF5A%5CuFF66-%5CuFFBE%5CuFFC2-%5CuFFC7%5CuFFCA-%5CuFFCF%5CuFFD2-%5CuFFD7%5CuFFDA-%5CuFFDC%5Cu300C-%5Cu300D"),r=decodeURIComponent([".,?!:;","%E2%80%A6","%E2%80%BD","%C2%B7","%D8%9F","%D8%8C"].join("")),s=decodeURIComponent(["%E3%80%82","%E3%80%81","%EF%BC%81","%EF%BC%9F","%EF%BC%9B","%EF%BC%9A"].join(""));return e.replace(new RegExp("(["+r+"])\\s+(?=["+t+"])","g"),"$1?|").replace(new RegExp("(["+s+"])\\s*(?=["+t+"])","g"),"$1?|").split("?|")},words:function(e){return e.split(/(\s+)/)}},extract:{label:function(e){var t={valid:!1,label:void 0};if(!e.getAttribute)return t;var r=e.getAttribute("aria-label")||e.getAttribute("title")||e.getAttribute("alt")||void 0,s=rspkr.item("general.labels.ignoreSelector")||void 0;return"string"!=typeof s||s.trim().length||(s=void 0),!r||e.classList.contains(rspkr.cls.content)||e.matches(s)||(t.label=r)&&(t.valid=-1===["body","aside","nav","section"].indexOf(e.nodeName.toLowerCase())&&"navigation"!==e.getAttribute("role")),t}},test:{preserved:function(e){return!(!e||!e.classList)&&(e.classList.contains(rspkr.cls.preserve)||e.classList.contains(rspkr.cls.nosync)||e.matches(rspkr.conf("general.preserveElements")))}}}},highlight:function(e,t){var r,s;e&&("none"===(r=rspkr.Common.Settings.get("hl"))||(s=$rs.get("#sync"+e))&&s.classList&&(!(e=s.classList.contains("sync_sent"))||"sent"!==r&&"wordsent"!==r||(t||rspkr.hl.css.sentOff(),s&&rspkr.hl.css.sentOn(s),s&&rspkr.hl.enlarge.isActive()&&rspkr.hl.enlarge.sentHL(s,t)),e||"word"!==r&&"wordsent"!==r||(t||rspkr.hl.css.wordOff(),s&&rspkr.hl.css.wordOn(s),s&&rspkr.hl.enlarge.isActive()&&rspkr.hl.enlarge.wordHL(s,t)),s&&rspkr.ui.AutoScroll.scroll(s)))},postProcess:{lightCleanUp:function(){rspkr.c.data.selectedHTML="",rspkr.hl.css.sentOff(),rspkr.hl.css.wordOff()},fullCleanUp:function(){if(this.lightCleanUp(),!rspkr.item("general.premarkup")){rspkr.c.dispatchEvent("onBeforeContentChange",window),$rs.removeClass(".tmp_skip",rspkr.cls.skip),$rs.removeClass(".tmp_skip","tmp_skip"),$rs.removeClass(".tmp_skip_always",rspkr.cls.skipalways),$rs.removeClass(".tmp_skip_always","tmp_skip_always");for(var e=$rs.arr(rspkr.selector.textnode),t=0;t<e.length;t++){var r=document.createTextNode(e[t].textContent);$rs.parent(e[t]).replaceChild(r,e[t])}}}},sync:rspkr.hl.engine.gecko.clientExtension.sync.bind(rspkr.hl.engine.gecko)};return{clientExtension:A}}(),ReadSpeaker.ui=function(){function e(){return d}function c(e){var t,r=$rs.arr("a, .rsbtn_play");e=e.replace(/https?:/gi,"");for(var s=0,n=r.length;s<n;s++)if($rs.getAttr(r[s],"href")&&"string"==typeof $rs.getAttr(r[s],"href")&&$rs.getAttr(r[s],"href").replace(/https?:/gi,"")===e){if($rs.isVisible(r[s]))return r[s];t=t||r[s]}return t||!1}function p(e){for(var t in e=(e="string"==typeof e?document.querySelector("#"+e):e)||rspkr.getRSBtns()[0],n)if(n[t]&&n[t].getContainer&&n[t].getContainer()===e)return n[t];var r=new(rspkr.mobile()?rspkr.Mobile:rspkr).ui.Player(e);return n.push(r),r.init(),r}function t(){var t;rspkr.log("[rspkr.ui] Initiating global callbacks"),rspkr.ui.rsbtnClass=rspkr.rsbtnClass(),window.readpage=function(e,t,r){if(r=r||{},!rspkr.requestBlocker.isEnabled()){if(!rspkr.mobile()){if(!(e=!e||$rs.isArray(e)?rspkr.findHref():e))return rspkr.error("[readpage] No valid href to call to server"),!1;e&&t&&"dialog"!==r.source&&!rspkr.item("general.popupHref")&&rspkr.item("general.popupHref",e)}if(e.nodeType&&$rs.closest(e,".rsloading")&&rspkr.ui.getActivePlayer())return;if(rspkr.ui.initialized)return!0===r.isClick&&rspkr.createAudio(),"webAudio"!==rspkr.pl.adapter||r.source||(r.source="fullpage",r.noCleanUp=!0),rspkr.ui.showPlayer(e,t,r),!0}r=rspkr.requestBlocker.getReason();return r&&window.alert(r),rspkr.log("[rspkr.ui] The player is being blocked."),!1},window.rshlexit=function(e){rspkr.hl.chunking.destroy(),void 0!==e&&"false"!==e||d&&d.stop({rshlexit:!0}),rspkr.c.dispatchEvent("onBeforeSyncExit",window),rspkr.mobile()&&!rspkr.hl.engine.useTextNodeMarkup||rspkr.api.callback.execute(rspkr.api.callback.enums.AUDIO.ENDED,rspkr.ui.getActivePlayerElm()),setTimeout(function(){rspkr.c.dispatchEvent("onAfterSyncExit",window)},1e3)},window.rshlinit=o().sync.init,window.rshlsetContent=o().sync.setContent,window.rshlsetId=o().sync.setId,window.rshlsync=function(e,t){for(var r=e.split(","),s=t.split(","),n=0,a=e.length;n<a;n++)o().sync.execute(r[n],s[n])},window.rshlcontinue=function(){var e,t,r,s;function n(e){if(!rspkr.hl.chunking.entracte.src){var t,r=encodeURIComponent(decodeURIComponent(rspkr.Lang.getPhrase(e))),s={noads:1};for(t in rspkr.c.data.params)rspkr.c.data.params.hasOwnProperty(t)&&(s[t]=rspkr.c.data.params[t]);var n=rspkr.Common.data.selectedText,e=rspkr.Common.data.selectedHTML;rspkr.Common.data.selectedText=r,rspkr.Common.data.selectedHTML="",s.text=r,s.output="audio";r=rspkr.c.buildReadSpeakerCall(s);rspkr.hl.chunking.entracte.src=r,rspkr.Common.data.selectedText=n,rspkr.Common.data.selectedHTML=e}rspkr.hl.chunking.entracte.volume=parseFloat((rspkr.st.get("hlvol")||100)/100),rspkr.pl.playPromise(rspkr.hl.chunking.entracte)}rspkr.hl.chunking&&(rspkr.log("[rspkr.ui.rshlcontinue]",1),rspkr.hl.chunking.chunkEnded=!0,t=rspkr.hl.html5.synclist[rspkr.hl.html5.synclist.length-2][2],s=$rs.get(".sync_word_highlighted"),$rs.isArray(s)&&(s=$rs.get("#sync"+t)),e=$rs.isArray(s)&&!s.length?(r=0,document.body&&document.body.scrollTop?r=document.body.scrollTop:document.documentElement&&document.documentElement.scrollTop?r=document.documentElement.scrollTop:window.pageYOffset&&(r=window.pageYOffset),{left:rspkr.ui.viewport.width/2,top:rspkr.ui.viewport.height/2+r}):$rs.offset(s),rspkr.hl.chunking.continueHref?(t=rspkr.item("cb.chunking.pause",void 0,!0),"-1"===String(rspkr.hl.chunking.continueTime)?(rspkr.log("[rspkr.ui.rshlcontinue] Waiting for user interaction",1),rspkr.ui.getActivePlayer().pause(),$rs.addClass(rspkr.ui.getActivePlayer().getContainer(),"rsautopaused"),n("chunkcontinue"),t&&"function"==typeof t?(rspkr.log("[rspkr.ui.rshlcontinue] Running custom callback",1),t()):(rspkr.log("[rspkr.ui.rshlcontinue] Showing default continue button",1),(r=document.createElement("div")).innerHTML="<span>"+rspkr.Lang.getPhrase("chunkbutton")+"</span>",$rs.addClass(r,rspkr.rsbtnClass()+" rspopup rsresume"),$rs.regEvent(r,"click",function(){rspkr.c.dispatchEvent("onChunkResume",window)}),document.body.appendChild(r),r.style.display="block",e.left+=15,0<(s=e.left+$rs.width(r)-$rs.width(window))&&(e.left-=s),r.style.left=e.left+"px",r.style.top=e.top+15+"px")):"0"===String(rspkr.hl.chunking.continueTime)?(rspkr.log("[rspkr.ui.rshlcontinue] Autoplay",1),rspkr.c.dispatchEvent("onChunkResume",window)):isNaN(rspkr.hl.chunking.continueTime)?rspkr.error("[rspkr.ui.rshlcontinue] Invalid time parameter!"):(rspkr.log("[rspkr.ui.rshlcontinue] Autoplay with "+rspkr.hl.chunking.continueTime+" seconds delay",1),5<=rspkr.hl.chunking.continueTime&&n("chunkwait"),t&&"function"==typeof t&&t(rspkr.hl.chunking.continueTime),rspkr.hl.chunking.stall=!0,setTimeout(function(){rspkr.hl.chunking.stall=!1},1e3*rspkr.hl.chunking.continueTime),rspkr.hl.chunking.timer=setTimeout(function(){rspkr.c.dispatchEvent("onChunkResume",window)},1e3*rspkr.hl.chunking.continueTime))):rspkr.error("[rshlcontinue] No continue href found!"))},rspkr.mobile()?($rs.regEvent(document.body,"touchstart",function(e){return rspkr.ui.setPointerPos(e),!0}),$rs.regEvent(document.body,"touchend",function(e){return rspkr.ui.setPointerPos(e),rspkr.c.data.setSelectedText(e),!0}),$rs.regEvent(document,"selectionchange",function(e){return rspkr.c.data.setSelectedText(e),!0})):($rs.regEvent(document.body,"mousedown",function(e){return rspkr.ui.setPointerPos(e),!0}),$rs.regEvent($rs.get(document),"mouseup",function(e){rspkr.c.data.setSelectedText(e)}),rspkr.item("general.iframeReading")&&((t=$rs.getReadingFrames()).shift(),"complete"===document.readyState||"loaded"===document.readyState?t.forEach(function(e){try{e.document.addEventListener("mouseup",function(e){setTimeout(function(){rspkr.c.data.setSelectedText(e),e.stopPropagation()},150)})}catch(e){}}):document.addEventListener("readystatechange",function(e){"complete"!==e.target.readyState&&"loaded"!==e.target.readyState||t.forEach(function(e){try{e.document.addEventListener("mouseup",function(e){setTimeout(function(){rspkr.c.data.setSelectedText(e),e.stopPropagation()},150)})}catch(e){}})})),$rs.regEvent(document.body,"keydown",rspkr.ui.setPointerPos),$rs.regEvent(document.body,"keyup",function(e){if(!e.originalEvent||27!==e.originalEvent.which)return rspkr.c.data.setSelectedText(e),!0}))}function r(){var e,t,r=ReadSpeakerDefer.deferred;delete ReadSpeakerDefer.deferred,r&&((r=r.classList&&!r.classList.contains("rsbtn_play")||r.tagName&&"a"!==r.tagName.toLowerCase()?$rs.closest(r,".rsbtn_play"):r)&&!r.tagName&&r.href&&r.target?(t=(e=$rs.get(r.target)).closest(rspkr.rsbtnClass(!0)),rspkr.log('[rspkr.ui] Activating deferred readpage: readpage("'+r.href+"\", '"+t+"')"),rspkr.ui.showPlayer(r.href,t||e,r.options)):r&&(rspkr.log("[rspkr.ui] Activating deferred element: "+$rs.getAttr(r,"href")),window.readpage($rs.getAttr(r,"href"))))}function o(){return rspkr.XP||rspkr.HL}var s,d=null,n=[],a={ui:{rsbtnClass:"rsbtn",progressDir:"h",player:['\t<span class="rsbtn_exp_inner">','\t\t<button type="button" class="rsbtn_pause rsbtn_player_item" title="Pause"><i class="rsicn rsicn-pause" aria-hidden="true"></i><span class="rsbtn_btnlabel">Pause</span></button>','\t\t<button type="button" class="rsbtn_stop rsbtn_player_item" title="Stop"><i class="rsicn rsicn-stop" aria-hidden="true"></i><span class="rsbtn_btnlabel">Stop</span></button>','\t\t<span class="rsbtn_progress_container rsbtn_player_item rsloading">',"\t\t</span>",'\t\t<button type="button" class="rsbtn_volume rsbtn_player_item" title="Volume" aria-expanded="false"><i class="rsicn rsicn-volume" aria-hidden="true"></i><span class="rsbtn_btnlabel">Volume</span></button>','\t\t<span class="rsbtn_volume_container">','\t\t\t<span class="rsbtn_volume_slider"></span>',"\t\t</span>",'\t\t<button type="button" class="rsbtn_dl rsbtn_player_item" title="Download MP3"><i class="rsicn rsicn-download" aria-hidden="true"></i><span class="rsbtn_btnlabel">Download mp3</span></button>','\t\t<button type="button" class="rsbtn_closer rsbtn_player_item" title="Close Player"><i class="rsicn rsicn-cross" aria-hidden="true"></i><span class="rsbtn_btnlabel">Close</span></button>',"\t</span>"],player31:['<span class="rsbtn_exp_inner" role="list">','\t<button type="button" role="listitem" class="rsbtn_pause rsbtn_player_item" data-rsshortcut="pause" data-rslang="title/arialabel:pause" data-rs-tooltip="." data-rs-direction="u"><span class="rsicn rsicn-pause" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:pause"></span></button>','\t<button type="button" role="listitem" class="rsbtn_stop rsbtn_player_item" data-rsshortcut="stop" data-rslang="title/arialabel:stop" data-rs-tooltip="." data-rs-direction="u"><span class="rsicn rsicn-stop" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:stop"></span></button>','\t<span class="rsbtn_progress_container rsbtn_player_item rsloading"></span>','\t<button type="button" role="listitem" class="rsbtn_rewind rsbtn_player_item" data-rslang="title/arialabel:skipbackwards" data-rslangfilter="skipBtns" data-rs-tooltip="." data-rs-direction="u"><span class="rsicn rsicn-backwards" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:skipbackwards" data-rslangfilter="skipBtns"></span></button>','\t<button type="button" role="listitem" class="rsbtn_forward rsbtn_player_item" data-rslang="title/arialabel:skipforwards" data-rslangfilter="skipBtns" data-rs-tooltip="." data-rs-direction="u"><span class="rsicn rsicn-forwards" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:skipforwards" data-rslangfilter="skipBtns"></span></button>','\t<button type="button" role="listitem" class="rsbtn_volume rsbtn_player_item rs-has-dropdown" aria-expanded="false" data-rs-tool="volume" data-rslang="title/arialabel:volume" data-rs-tooltip="." data-rs-direction="u"><span class="rsicn rsicn-volume" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:volume"></span></button>','\t<span class="rsbtn_volume_container rsbtn_dropdown" data-rs-tool="volume"></span>','\t<button type="button" role="listitem" class="rsbtn_speed rsbtn_player_item rs-has-dropdown" aria-expanded="false" data-rs-tool="speed" data-rslang="title/arialabel:speed" data-rs-tooltip="." data-rs-direction="u"><span class="rsicn rsicn-speed"></span><span class="rsbtn_btnlabel" data-rslang="content:speed"></span></button>','\t<span class="rsbtn_speed_container rsbtn_dropdown" data-rs-tool="speed"></span>','\t<button type="button" role="listitem" class="rsbtn_dl rsbtn_player_item" data-rsshortcut="download" data-rslang="title/arialabel:download" data-rs-tooltip="." data-rs-direction="u"><span class="rsicn rsicn-download" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:download"></span></button>','\t<button type="button" role="listitem" class="rsbtn_closer rsbtn_player_item" data-rslang="title/arialabel:closeplayer" data-rs-tooltip="." data-rs-direction="u"><span class="rsicn rsicn-cross" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:closeplayer"></span></button>',"</span>"],listenBtn:['<div id="readspeaker_button_settings" class="rs_skip rsbtn rs_preserve readspeaker_button_settings rs_notools">','\t<a class="rsbtn_play" href="">','\t\t<span class="rsbtn_left rsimg rspart">','\t\t\t<span class="rsbtn_text">',"\t\t\t\t<span>rsLISTENrs</span>","\t\t\t</span>","\t\t</span>",'\t\t<span class="rsbtn_right rsimg rsplay rspart"></span>',"\t</a>","</div>"],toolpanel:['<div class="rsbtn_toolpanel">','\t<div class="rsbtn_tools">','\t\t<div class="rsbtn_tools_inner">','\t\t\t<span class="rsbtn_powered rsimg"><span class="rsbtn_btnlabel">ph_speechenabled</span></span>','\t\t\t<div class="rsbtn_toolcontainer">','\t\t\t\t<ul class="rsbtn_toollist">','\t\t\t\t\t<li class="rsbtn_tool_settings"><button type="button" class="rsbtn_tool first-child" title="ph_settings" data-rs-tool="settings"><i class="rsicn rsicn-settings" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_settings</span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_voice_settings"><button type="button" class="rsbtn_tool" title="ph_readingvoice" data-rs-tool="voicesettings"><i class="rsicn rsicn-voice" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_readingvoice</span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_click_listen"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:clicklisten" data-rs-tool="clicklisten" data-rs-tooltip="."><span class="rsicn rsicn-click-listen" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:clicklisten"></span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_enlarge"><button type="button" class="rsbtn_tool" title="ph_enlargetext" data-rs-tool="enlarge"><i class="rsicn rsicn-enlarged-text" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_enlargetext</span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_simple_view"><button type="button" class="rsbtn_tool" title="ph_simpleview" data-rs-tool="simpleview"><i class="rsicn rsicn-textmode" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_simpleview</span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_pagemask"><button type="button" class="rsbtn_tool" title="ph_pagemask" data-rs-tool="pagemask"><i class="rsicn rsicn-pagemask" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_pagemask</span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_translate"><button type="button" class="rsbtn_tool" title="ph_translation" data-rs-tool="translation"><i class="rsicn rsicn-translate" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_translation</span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_dict"><button type="button" class="rsbtn_tool" title="ph_wordlookup" data-rs-tool="lookup"><i class="rsicn rsicn-dictionary" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_wordlookup</span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_help"><button type="button" class="rsbtn_tool last-child" title="ph_help" data-rs-tool="help"><i class="rsicn rsicn-help" aria-hidden="true"></i><span class="rsbtn_btnlabel">ph_help</span></button></li>',"\t\t\t\t</ul>","\t\t\t</div>","\t\t</div>","\t</div>","</div>"],toolpanel31:['<div class="rsbtn_toolpanel">','\t<div class="rsbtn_tools">','\t\t<div class="rsbtn_tools_inner">','\t\t\t<div class="rsbtn_toolcontainer">','\t\t\t\t<ul class="rsbtn_toollist">','\t\t\t\t\t<li class="rsbtn_tool_settings"><button type="button" class="rsbtn_tool first-child" data-rslang="title/arialabel:settings" data-rs-tool="settings" data-rs-tooltip="." aria-expanded="false"><span class="rsicn rsicn-settings" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:settings"></span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_voice_settings"><button type="button" class="rsbtn_tool" data-rsshortcut="readingvoice" data-rslang="title/arialabel:readingvoice" data-rs-tool="voicesettings" data-rs-tooltip="."><span class="rsicn rsicn-voice" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:readingvoice"></span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_click_listen"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:clicklisten" data-rs-tool="clicklisten" data-rs-tooltip="."><span class="rsicn rsicn-click-listen" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:clicklisten"></span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_enlarge"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:enlargetext" data-rs-tool="enlarge" data-rs-tooltip="."><span class="rsicn rsicn-enlarged-text" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:enlargetext"></span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_text_mode"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:textmode" data-rs-tool="textmode" data-rs-tooltip="." aria-expanded="false"><span class="rsicn rsicn-textmode" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:textmode"></span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_pagemask"><button type="button" class="rsbtn_tool" data-rslang="title/arialabel:pagemask" data-rs-tool="pagemask" data-rs-tooltip="."><span class="rsicn rsicn-pagemask" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:pagemask"></span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_translate"><button type="button" class="rsbtn_tool" data-rsshortcut="translation" data-rslang="title/arialabel:translation" data-rs-tool="translation" data-rs-tooltip="." data-rs-direction="url"><span class="rsicn rsicn-translate" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:translation"></span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_dict"><button type="button" class="rsbtn_tool" data-rsshortcut="dictionary" data-rslang="title/arialabel:dictionary" data-rs-tool="dictionary" data-rs-tooltip="."><span class="rsicn rsicn-dictionary" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:dictionary"></span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_download"><button type="button" class="rsbtn_tool" data-rsshortcut="download" data-rslang="title/arialabel:download" data-rs-tool="download" data-rs-tooltip="." aria-expanded="false"><span class="rsicn rsicn-download" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:download"></span></button></li>','\t\t\t\t\t<li class="rsbtn_tool_help"><button type="button" class="rsbtn_tool last-child" data-rslang="title/arialabel:help" data-rs-tool="help" data-rs-tooltip="." aria-expanded="false"><span class="rsicn rsicn-help" aria-hidden="true"></span><span class="rsbtn_btnlabel" data-rslang="content:help"></span></button></li>',"\t\t\t\t</ul>","\t\t\t</div>",'\t\t\t<span class="rsbtn_powered rsimg">','\t\t\t\t<span class="rsbtn_btnlabel" data-rslang="title/arialabel:speechenabled,content:speechenabled" data-rslangfilter="content:speechEnabledLink,title/arialabel:speechEnabledTitle"></span>',"\t\t\t</span>","\t\t</div>","\t</div>","</div>"],dldialog:['<div class="rsdl_textwrapper">','\t<h1 data-rslang="content:touheading"></h1>','\t<div data-rslang="content:toubody"></div>',"</div>"],dlbuttons:['\t\t<a id="rsdl_button_accept" class="rsdialog-button" href="javascript:void(0);" role="button" data-rslang="title/content:touaccept"></a>','\t\t<a id="rsdl_button_decline" class="rsdialog-button" href="javascript:void(0);" role="button" data-rslang="title/content:toudecline"></a>']}},i={update:function(e,t,r){"hlspeed"===e&&t!==r&&(0===t&&(t=5,rspkr.st.set("hlspeed",t)),e=e.replace("hl",""),rspkr.c.converter[e]&&"function"==typeof rspkr.c.converter[e]&&(t=rspkr.c.converter[e](t)),rspkr.c.data[e]=t,rspkr.pl.releaseAdapter())}},h={init:function(){rspkr.cfg.mergeDefault(a)},add:function(e){s.push(e)},closeAll:function(){for(var e=0,t=s.length;e<t;e++)rspkr.tools.close.apply(s[e],[])}},l={setZIndex:function(e,t){var r,s,n;e&&(n=rspkr.conf("general.zIndexCustom.value"),r=rspkr.conf("general.zIndexCustom.selector"),!isNaN(n)&&r&&"."!==r&&e.matches(r)?e.style.zIndex=n:(t=e.ownerDocument?(n=e.ownerDocument,s=n.defaultView,n=Array.prototype.slice.call(n.querySelectorAll("*")).map(function(e){return+(s.getComputedStyle(e).zIndex||0)}).filter(Boolean),+Math.max.apply(null,n)+(t?1:0)):1e3,e.style.zIndex=t))},populatePhrases:function(e,t){var r,s,n=t||rspkr.Lang.getUiLang(),a={},o=e.match(/\[\[ph_[^\]]*\]\]/gi);if(o.length)for(var i=0,l=o.length;i<l;i++)a[r=o[i].replace("[[","").replace("]]","")]=rspkr.Lang.getPhrase(r.replace("ph_",""),n)||r.replace("ph_","");for(s in a)a.hasOwnProperty(s)&&(e=e.replace(new RegExp("\\[\\["+s+"\\]\\]","gi"),a[s]));return e},playerInViewport:function(e){var t;if(!(e=!e?(t=rspkr.ui.getActivePlayer())?t.getContainer():void 0:e)||!$rs.isVisible(e))return!1;e=e.getBoundingClientRect();return 0<e.top&&e.bottom<rspkr.ui.viewport.height&&0<e.left&&e.right<rspkr.ui.viewport.width},addMiniToggler:function(e){!e||$rs.isArray(e)&&!e.length||($rs.createElm("span",{cls:"rs_minitoggler",content:['<span class="on-icon">&#x02713;</span>','<span class="off-icon">&#x02715;</span>'].join(""),parent:e}),e.setAttribute("aria-pressed","false"))}};return{meta:{revision:"2489"},dependency:["pub.Config"],initialized:!(s=[]),init:function(){var e=rspkr.Common.addEvent;e("onAfterModsLoaded",[t,rspkr.Voice.setVoice,rspkr.Common.data.setParams.bind(rspkr.Common.data)]),e("onReady",[rspkr.tools.toggler.add,r]),e("onSettingsChanged",i.update),rspkr.ui.Detach&&rspkr.ui.Detach.init(),this.initialized=!0,rspkr.Common.dispatchEvent("onUIInitialized"),h.init(),rspkr.log("[rspkr.ui] Initialized!")},settings:i,rsbtnClass:"",addClickEvents:function(){rspkr.tools.toggler.add()},addTools:function(){if(rspkr.item("ui.toolpanel31")&&!0!==rspkr.notools()){for(var e=rspkr.getRSBtns("rs_addtools"),t=$rs.createElm("div",{content:rspkr.item("ui.toolpanel31").join("\n")}),r=0,s=e.length;r<s;r++)if(e[r]&&!e[r].querySelector(".rsbtn_toolpanel")){for(var n,a=(n=t.childNodes[0].cloneNode(!0)).querySelectorAll(".rsbtn_toollist .rsbtn_tool"),o=0;o<a.length;o++){var i=a[o].getAttribute("data-rs-tool");"dictionary"===(i="translation"===i?"translation_toolbar":i)&&(i="dictionary_toolbar"),!1===rspkr.features[i]&&a[o].parentNode.parentNode.removeChild(a[o].parentNode)}if(rspkr.item("ui.toolbar.horizontal"))$rs.addClass(n,"horizontal");else{$rs.addClass(n,"vertical"),rspkr.ui.utils.addMiniToggler(n.querySelector(".rsbtn_tool_click_listen button")),rspkr.ui.utils.addMiniToggler(n.querySelector(".rsbtn_tool_enlarge button"));for(var l,c=n.querySelectorAll("[data-rs-tooltip]"),p=0;l=c[p];p++)l.removeAttribute("data-rs-tooltip")}var d=rspkr.item("ui.zIndexToolPanel");d&&1!==d&&(n.style.zIndex=d),!1===rspkr.features.banner&&((u=n.querySelector(".rsbtn_powered"))&&u.parentElement.removeChild(u),n.querySelector("li").style.borderTop=0);var u=e[r].querySelector(".rsbtn_tooltoggle");rspkr.devt("onBeforeMenuInserted",void 0,[n]),u?e[r].insertBefore(n,u.nextSibling):e[r].appendChild(n),rspkr.Lang.updateUi(n),rspkr.c.addEvent("onLangLoaded",function(e,t){t===rspkr.uiLang()&&rspkr.Lang.updateUi(e)}.bind(void 0,n)),h.add(n)}return n}},initGlobalCallbacks:t,processDeferred:r,showPlayer:function(e,t,r){var s;rspkr.log("[rspkr.ui.showPlayer]"),r=r||{},rspkr.Popup&&rspkr.Popup.closePopup(),$rs.removeClass($rs.arr(".rs_textselection"),"rs_textselection"),"clicklisten"===r.source?s=c(rspkr.findHref()):"dialog"!==r.source&&(s="string"==typeof e?c(e):e);var n=!1;if(s&&!rspkr.mobile()&&(n=(i=s?$rs.closest(s,".rsexpanded"):void 0)&&$rs.hasClass(i,"pre-expanded")),(rspkr.pl.playerRef||rspkr.pl.audio&&rspkr.pl.audio.state.current!==rspkr.pl.audio.states.notStarted)&&rspkr.ui.getActivePlayer()&&$rs.closest(s,rspkr.rsbtnClass(!0))===rspkr.ui.getActivePlayerElm()&&rspkr.ui.getActivePlayerElm().classList.contains("rsexpanded")&&1===rspkr.hl.chunking.currentChunkNumber&&!n&&!rspkr.Popup.newTextSelected())return rspkr.log("Player already active, reusing that one!"),void(r.preventPlay||(rspkr.log("...and calling restart() instead."),rspkr.c.dispatchEvent("onUIBeforePlay"),rspkr.Common.Player.setStateClass("rsloading"),rspkr.ui.getActivePlayer().reinit(),rspkr.ui.getActivePlayer().restart(),rspkr.c.dispatchEvent("onUIAfterPlay"),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.PLAY,rspkr.ui.getActivePlayerElm())));!0===r.noCleanUp||rspkr.c.data.selectedText.length||rspkr.c.data.selectedHTML.length||rspkr.hl.clean(),rspkr.hl.sync.lightCleanUp(),rspkr.pl.releaseAdapter(),rspkr.hl.chunking.destroy(),rspkr.hl.chunking.html5support&&!rspkr.hl.chunking.entracte&&(rspkr.hl.chunking.entracte=rspkr.audio||new Audio,(rspkr.mobile()||rspkr.with.safari())&&rspkr.pl.playPromise(rspkr.hl.chunking.entracte,void 0,void 0,!0)),rspkr.c.dispatchEvent("onBeforeParamsSet",window,[s]);var a,o,i="string"==typeof e?e:$rs.getAttr(s,"href"),n=document.createElement("a");i&&"string"==typeof i&&(n.href=i,i=n.href),rspkr.c.data.selectedHTML="",rspkr.c.data.setParams(i),!t&&s&&s.getAttribute&&s.getAttribute("data-target")?"object"==typeof(n=$rs.get(s.getAttribute("data-target")))&&(t=n):t&&s&&("object"==typeof t?(t.id||(t.id=rspkr.Util.randomString()),s.setAttribute("data-target",t.id)):s.setAttribute("data-target",t)),rspkr.mobile()&&("dialog"===r.source||(t=void 0)),t?(a=(o=p(t)).getContainer(),"dialog"!==r.source&&(a.classList.add("rsfloating"),a.classList.add("rs_splitbutton-exp"),a.classList.add("rs_splitbutton-container"))):(a=(a=!(a=$rs.closest(s,"div"+rspkr.rsbtnClass(!0)))&&s?s:a)||(document.body.querySelector(".rs-faked-player")||$rs.createElm("div",{cls:"rs-faked-player",attributes:{style:"display:none !important"},parent:document.body})),o=p(a)),!0!==r.disableCallbacks&&rspkr.api.callback.execute(rspkr.api.callback.enums.UI.OPEN,a),(d&&d!==o||"clicklisten"!==r.source&&d&&i!==d.getHref())&&(d.close(!0),"clicklisten"!==r.source&&rspkr.c.dispatchEvent("onUIClosePlayer",d.getContainer(),[rspkr.c.data.selectedText.length?"textsel":"nosel"])),"string"==typeof e&&!1===rspkr.hl.engine.useTextNodeMarkup&&!0!==rspkr.item("general.usePost")&&(rspkr.c.data.params.readid?rspkr.hl.Restore.Storage.readId.push(rspkr.c.data.params.readid):(e=i.match(/readid=[^&]+/gi))&&e.length&&rspkr.hl.Restore.Storage.readId.push(decodeURIComponent(e[0].replace("readid=","")).split(",")),rspkr.c.data.params.readclass?rspkr.hl.Restore.Storage.readClass.push(rspkr.c.data.params.readclass):(l=i.match(/readclass=[^&]+/gi))&&l.length&&rspkr.hl.Restore.Storage.readClass.push(decodeURIComponent(l[0].replace("readclass=","")).split(",")));var l=d?d.getID():null;return rspkr.c.dispatchEvent("onUIShowPlayer",window,[l,o.getID()]),o.setHref(i),t&&a&&a.classList.add("rs_splitbutton-exp","rs_splitbutton-container"),(d=o).show(!1,r),d},expand:function(e,t){"string"==typeof e&&(e=$rs.get(e)),$rs.isArray(e)||(e=[e]);for(var r=0;r<e.length;r++)rspkr.mobile()?p(e[r]).show(!0,{preventPlay:!0}):p(e[r]).show(!0),$rs.removeClass(e[r],"rsstopped rsplaying"),$rs.addClass(e[r],"rspaused"),t&&!rspkr.mobile()&&e[r].getElementsByClassName("rsbtn_play")[0].focus()},pointerX:0,pointerY:0,setPointerPos:function(e){return e.pageX&&(rspkr.ui.pointerX=e.pageX),e.pageY&&(rspkr.ui.pointerY=e.pageY),e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0]&&e.originalEvent.touches[0].pageX&&(rspkr.ui.pointerX=e.originalEvent.touches[0].pageX),e.originalEvent&&e.originalEvent.touches&&e.originalEvent.touches[0]&&e.originalEvent.touches[0].pageY&&(rspkr.ui.pointerY=e.originalEvent.touches[0].pageY),!0},viewport:{width:$rs.width(window),height:$rs.height(window)},activePlayer:d,getActivePlayer:e,setActivePlayer:function(e){e instanceof Object&&"function"==typeof e.getContainer&&(d=e)},getActivePlayerElm:function(){if(d){var e=d.getContainer();return e&&!(e instanceof Array)||rspkr.mobile()&&rspkr.Mobile&&(e=rspkr.Mobile.ui.Player().getMobileContainer())?e:void 0}},destroyActivePlayer:function(){d&&d.close(),d=null},toolPanels:h,utils:l}}(),ReadSpeaker.ui.AutoScroll=function(){function e(){rspkr.st.set("hlscroll","scrollon"),document.removeEventListener("wheel",i),document.addEventListener("wheel",i)}function t(){rspkr.st.set("hlscroll","scrolloff"),document.removeEventListener("wheel",i)}var r,s=4e3,n=function(){return"scrollon"===rspkr.st.get("hlscroll")},o=function(e,t){var r,s,n,a;e&&$rs.parent(e)&&$rs.isVisible(e)&&!e.classList.contains("rs-no-scroll")&&(t=t||e,$rs.parent(e)===document.body?((s=350+parseInt(rspkr.item("ui.autoscrollOffset")||0))<0&&(s=window.innerHeight/2),window.innerHeight<s+50&&(s=window.innerHeight/2),n=$rs.createElm("div",{attributes:{style:"position:absolute; width:0; height:0; transform:translateY(-$Opx)".replace("$O",s)}}),$rs.parent(t).contains(t)?$rs.parent(t).insertBefore(n,t):t.insertBefore(n,t.children[0]),n.scrollIntoView({behavior:"smooth"}),$rs.parent(n).removeChild(n)):(a=window.getComputedStyle($rs.parent(e)),$rs.parent(e).scrollHeight>$rs.parent(e).clientHeight&&("scroll"===a.overflow||"auto"===a.overflow)&&(r=$rs.parent(e).getBoundingClientRect(),s=t.getBoundingClientRect().top+$rs.parent(e).scrollTop-r.top,(n=parseInt($rs.parent(e).getAttribute("data-rs-autoscroll-offset")||rspkr.conf("ui.autoscrollOffset")||20))<0&&(n=r.height/2),r.height<n+20&&(n=r.height/2),"scrollBehavior"in document.documentElement.style?(a="auto"===a.scrollBehavior,$rs.parent(e).style.scrollBehavior="smooth",$rs.parent(e).scrollTo(0,s-n),a&&setTimeout(function(){$rs.parent(e).style.scrollBehavior="auto"},200)):$rs.parent(e).scrollTop=s-n,$rs.parent(e).removeEventListener("wheel",i),$rs.parent(e).addEventListener("wheel",i),t=$rs.parent(e)),o($rs.parent(e),t)))},i=function(e,t){n()&&(clearTimeout(r),r=setTimeout(function(){r=void 0},t||s))};return{init:function(){ReadSpeaker.q(function(){(n()?e:t)(),rspkr.evt("onAfterSyncInit",function(){i()})})},on:e,off:t,scroll:function(e,t){n()&&e&&$rs.parent(e)&&(r&&!0!==t||(t&&i(),o(e)))},wait:function(e){i(void 0,e||s)}}}(),ReadSpeaker.ui.Slider=function(t){"string"==typeof t.container&&(t.container=$rs.get(t.container));var a=t.container&&t.container.querySelector(".rs-slider")?t.container.querySelector(".rs-slider"):document.createElement("input");if(a.type="range",a.className="rs-slider",t.class&&a.classList.add(t.class),t.id&&(a.id=t.id),t.attributes&&"object"==typeof t.attributes)for(var e in t.attributes)t.attributes.hasOwnProperty(e)&&$rs.setAttr(a,e,t.attributes[e]);a.max=t.max||100,a.min=t.min||0,a.step=t.step||1,a.value=isNaN(t.value)?a.max/2:t.value,a.classList.add("v"===t.direction?"vertical":"horizontal"),a.setAttribute("aria-orientation","v"===t.direction?"vertical":"horizontal"),t.title&&a.setAttribute("data-rslang","title/arialabel:"+t.title),t.container&&t.container.appendChild(a);var r,s,n=!1;t.change&&a.addEventListener("input",function(e){t.change.call(this,e)}),t.drop&&a.addEventListener("change",function(e){n=!0,!c()&&"blur"===t.keyboardDrop||(t.drop.call(this,e),n=!1)}),t.drop&&"blur"===t.keyboardDrop&&a.addEventListener("blur",function(e){!c()&&n&&(t.drop.call(this,e),n=!1)}),"blur"===t.close&&a.addEventListener("blur",function(){t.toggler&&document.activeElement===t.toggler||rspkr.ui.Accessibility.escapes.dropdowns({focus:!1})}),t.close=t.toggler&&t.toggler.addEventListener("blur",function(){setTimeout(function(){document.activeElement!==a&&$rs.isVisible(a)&&rspkr.ui.Accessibility.escapes.dropdowns({focus:!1})},0)}),t.labelStart&&t.container&&$rs.createElm("div",{parent:t.container,attributes:{"data-rslang":"content/title/arialabel:"+t.labelStart},cls:"slider-label-start"}),t.labelEnd&&t.container&&$rs.createElm("div",{parent:t.container,attributes:{"data-rslang":"content/title/arialabel:"+t.labelEnd},cls:"slider-label-end"}),a.addEventListener("keydown",function(e){32===e.keyCode&&rspkr.preventDefault(e)}),t.datalist&&(r="",s=rspkr.Util.randomString(),t.datalist.forEach(function(e){r+='<option value="%v"></option>'.replace("%v",e)}),$rs.createElm("datalist",{id:s,content:r,parent:t.container}),a.setAttribute("list",s),$rs.addClass(a,"has-datalist"));function o(){$rs.addClass(a,"mouse-controlled"),a.addEventListener("mouseup",l),a.addEventListener("change",l)}var i={show:function(){var e=a.parentElement.querySelector(".rs-slider-label");(e=e||$rs.createElm("span",{cls:"rs-slider-label",parent:a.parentElement})).classList.remove("keyboard-controlled"),clearTimeout(i.labelTimer1),clearTimeout(i.labelTimer2),e.style.opacity=1,i.update(),e.style.display="block"},hide:function(){var e=a.parentElement;!e||(e=e.querySelector(".rs-slider-label"))&&(e.style.display="none",e.classList.remove("keyboard-controlled"))},update:function(){var e,t,r,s,n=a.parentElement.querySelector(".rs-slider-label");n&&(n.innerText=a.value,e="120%",s="110%",t=a.getBoundingClientRect(),$rs.hasClass(a,"vertical")?(r=(a.value-a.min)/(a.max-a.min),s=Number(t.top-a.parentElement.getBoundingClientRect().top+t.height-r*(t.height-6))+"px",n.style.transform="translateY(%tem)".replace("%t",Number(.8*r-1.6)),"RS_RTL"===rspkr.params.skin&&(n.style.transform+=" scaleX(-1)")):$rs.hasClass(a,"horizontal")&&(e=Number(a.offsetLeft+(a.value-a.min)/(a.max-a.min)*(t.width-a.offsetLeft))+"px"),n.style.top=s,n.style.left=e)}},l=function(){setTimeout(function(){$rs.removeClass(this,"mouse-controlled")}.bind(a),0),a.removeEventListener("mouseup",l),a.removeEventListener("change",l)},c=function(){return $rs.hasClass(a,"mouse-controlled")};return a.removeEventListener("mousedown",o),a.addEventListener("mousedown",o),a.addEventListener("mousedown",i.show),a.addEventListener("input",i.update),rspkr.mobile()&&a.addEventListener("touchstart",i.show),a.addEventListener("change",function(){c()||(i.show(),i.labelTimer1=setTimeout(function(){var e;c()||(e=this.parentElement.querySelector(".rs-slider-label"))&&(e.classList.add("keyboard-controlled"),e.style.opacity=0,i.labelTimer2=setTimeout(function(){i.hide()}.bind(e),500))}.bind(this),1500))}),a.addEventListener("blur",i.hide),document.body.removeEventListener("mouseup",i.hide),document.body.addEventListener("mouseup",i.hide),rspkr.mobile()&&document.body.removeEventListener("touchend",i.hide),rspkr.mobile()&&document.body.addEventListener("touchend",i.hide),t.toggler&&(t.toggler.id||(t.toggler.id="rs-"+rspkr.Util.randomString()),a.setAttribute("data-toggler",t.toggler.id)),a},ReadSpeaker.ui.Tools=function(){function e(e){r=e,rspkr.devt("onToolsInitialized","__self__",[e])}var t=null,r=null,a=[],o={click:function(e){rspkr.preventDefault(e);var t=$rs.getAttr(this,"data-rs-tool"),r=$rs.closest(this,rspkr.rsbtnClass(!0));r&&$rs.hasClass(r,"disable-"+t)||(rspkr.ui.Tools.accessibility.isAccessKey(e)&&rspkr.ui.Tools.accessibility.storeSelection(),rspkr.c.dispatchEvent("onToolClicked",window,[this]),o.register(r),t&&o[t]&&o[t].apply(this,[e]))},focus:function(){o.register(this)},register:function(e){t=e},enlarge:function(){rspkr.ui.Tools.Enlarge.toggle()},help:function(e){rspkr.ui.Tools.Help.open.bind(this)(e)},dictionary:function(){var e=$rs.findIn(r,".rsbtn_play"),e=$rs.isArray(e)?rspkr.findHref():$rs.getAttr(e,"href");e&&"string"==typeof e&&e.length&&(e=rspkr.getParam("lang",e),rspkr.ui.Tools.Dictionary.dictionary.apply(this,[e]))},pagemask:function(e){rspkr.ui.Accessibility.escapes.menu(),rspkr.ui.Tools.PageMask.start("mask",e)},clicklisten:function(){rspkr.ui.Tools.ClickListen.toggle()},settings:function(){rspkr.Preferences.open.bind(this)()},textmode:function(){rspkr.ui.Tools.TextMode.start.bind(this)()},translation:function(){rspkr.ui.Tools.accessibility.restoreSelection()},voicesettings:function(){},download:function(){rspkr.ui.Tools.Download.download.bind(this)()}},s={register:function(e){var t,r=$rs.rsid(e);if(!a[r]){if(t=$rs.findIn(e,".rsbtn_tool"),(t=!$rs.isArray(t)?[t]:t).length)for(var s=0,n=t.length;s<n;s++)$rs.regEvent(t[s],"click",o.click),$rs.regEvent(t[s],"focus",o.focus);a[r]={element:e,initialized:!0}}}};return{init:function(){rspkr.Common.addEvent("onBeforeToolsOpen",[s.register,e])},btns:function(){return a},lastPlayer:function(){return t||(rspkr.getRSBtns().length?rspkr.getRSBtns()[0]:void 0)},accessibility:{storedSelection:void 0,isAccessKey:function(e){return!!rspkr.with.safari()||e&&0===e.clientX&&0===e.clientY&&0===e.screenX&&0===e.screenY},storeSelection:function(){var e=rspkr.c.data,t=rspkr.ui.Tools.accessibility.storedSelection={};(e.selectedText||e.selectedHTML||e.selectedRange)&&(t.text=rspkr.c.data.selectedText,t.html=rspkr.c.data.selectedHTML,t.range=rspkr.c.data.selectedRange)},restoreSelection:function(){var e,t=rspkr.ui.Tools.accessibility.storedSelection;t&&t.range&&(window.getSelection&&((e=window.getSelection()).removeAllRanges(),e.addRange(t.range)),rspkr.c.data.selectedText=t.text,rspkr.c.data.selectedHTML=t.html,rspkr.c.data.selectedRange=t.range)}}}}(),ReadSpeaker.Dialog=function(){function r(){C.close()||n.close()||v.close()||A.close()||(k.restoreScroll(),S.restoreAutoscroll(),function(){if(rspkr.runtime.revert.enlarge===true){rspkr.hl.enlarge.enable();delete rspkr.runtime.revert.enlarge}if(rspkr.runtime.revert.clicklisten===true){rspkr.ui.Tools.ClickListen.activate();delete rspkr.runtime.revert.clicklisten}}(),d&&(S.destroyPlayer(),y.kill(),d===o&&(d.close(),document.querySelector("#rs-dialog").style.display="none"),d===i&&(i.style.display="none"),o.removeAttribute("data-mode"),i&&i.removeAttribute("data-mode"),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.DIALOG.CLOSE,rspkr.ui.getActivePlayerElm()),rspkr.devt("onLightboxClosed",window,[])))}function p(){return o&&$rs.isVisible(o)?o:i&&$rs.isVisible(i)?i:void 0}function c(){return d.querySelector("#"+S.playerId)}function a(){return!(!p()||!$rs.isVisible(p()))}var d,o,i,s,u,l=!1,h=function(e){rspkr.preventDefault(e);var t=d.querySelector(".label-toggler"),r=d.querySelector("#rs-dialog-main");r.removeEventListener("click",h);e=!d.querySelector(":scope > nav").classList.contains("show-labels");t.setAttribute("data-rslang","title/arialabel:"+(e?"collapsenavigation":"expandnavigation")),rspkr.mobile()&&(r.style.width=r.getBoundingClientRect().width,e?d.style.width="auto":setTimeout(function(){d.style.width="100%"},200)),d.querySelector(":scope > nav").classList.toggle("show-labels",e),rspkr.Lang.updateUi(t),rspkr.mobile()?e&&r.addEventListener("click",h):(b.layout(),setTimeout(b.layout,200))},g=function(e){return $rs.createElm("div",{cls:"rs-dialog-content",content:e,parent:d.querySelector("#rs-dialog-contents")})},m={generic:function(t){var e={"data-placement":"toolbar","data-rslang":"arialabel/title:%name%".replace("%name%",t.nameKey),"data-rsshortcut":t.shortcut||"0","data-rsshortcut-prioritize":1,role:"button",tabindex:"0"};t.ariaExpand&&(e["aria-expanded"]="false");var r=$rs.createElm(t.nodeType||"li",{cls:["wr-dialog-toolbar-btn","rsicn","rsicn-%i".replace("%i",t.icon),t.type+"-"+t.name,t.cls||""],content:"toolbar"===t.type?"":'<label data-rslang="content:%name%"></label>'.replace("%name%",t.displayNameKey||t.nameKey),attributes:e,buttonesque:!0,click:function(e){!1!==t.preventDefault&&rspkr.preventDefault(e),t.callback.call(this)},parent:d.querySelector("toolbar"===t.type?"header > ul":"footer > ul")});t.nodeType&&r.setAttribute("role","button"),t.attributes&&Object.keys(t.attributes).forEach(function(e){r.setAttribute(e,t.attributes[e])})},cancel:function(){m.generic({nameKey:"toudecline",name:"cancel",icon:"cross",callback:r,type:"buttons"})},play:function(){m.generic({nameKey:"readdialog",name:"play",icon:"play",callback:S.play,shortcut:"play pause",type:"toolbar"})},stop:function(){m.generic({nameKey:"stopreaddialog",name:"stop",icon:"stop",callback:S.stop,shortcut:"stop",type:"toolbar"})},volume:function(){m.generic({nameKey:"volume",name:"volume",icon:"volume",callback:n.open,type:"toolbar",ariaExpand:!0})},speed:function(){m.generic({nameKey:"speed",name:"speed",icon:"speed",callback:v.open,type:"toolbar",ariaExpand:!0})},fontplus:function(){m.generic({nameKey:"fontsizeplus",name:"fontplus",icon:"font-plus",callback:t.increase,shortcut:"fontsizeplus",type:"toolbar"})},fontminus:function(){m.generic({nameKey:"fontsizeminus",name:"fontminus",icon:"font-minus",callback:t.decrease,shortcut:"fontsizeminus",type:"toolbar"})},textsettings:function(){m.generic({nameKey:"textsettings",name:"textsettings",icon:"text-settings",callback:C.open,type:"toolbar",ariaExpand:!0})},fullscreen:function(){m.generic({nameKey:"fullscreen",name:"fullscreen",icon:"maximize",callback:w.toggleFullscreen,type:"toolbar",cls:"rs-dialog-fullscreen"})},close:function(e){m.generic({nameKey:"closedialog",displayNameKey:"close",name:"close",icon:"cross",callback:r,type:e.type})},moretools:function(){m.generic({nameKey:"moretools",name:"moretools",icon:"hamburger",callback:A.open,type:"toolbar"})}},k={disableScroll:function(){var e=document.querySelector("html"),t=window.getComputedStyle(e);t.overflow?e.setAttribute("data-rs-overflow",t.overflow):(e.setAttribute("data-rs-overflowx",t.overflowX),e.setAttribute("data-rs-overflowy",t.overflowY)),e.style.overflow="hidden"},restoreScroll:function(){var e=document.querySelector("html");e.hasAttribute("data-rs-overflow")?(e.style.overflow=e.getAttribute("data-rs-overflow"),e.removeAttribute("data-rs-overflow")):e.hasAttribute("data-rs-overflowx")&&(e.style.overflowX=e.getAttribute("data-rs-overflowx"),e.style.overflowY=e.getAttribute("data-rs-overflowy"),e.removeAttribute("data-rs-overflowx"),e.removeAttribute("data-rs-overflowy"))}},f={addEvents:function(){d.addEventListener("click",f.onClick)},onClick:function(e){var t;y.active||b.active||0===e.clientX&&0===e.clientY&&e.target.closest(".rs-dialog-esque")||(t=d.getBoundingClientRect(),e.clientY>t.top&&e.clientY<t.top+t.height&&e.clientX>t.left&&e.clientX<t.left+t.width||r())}},y={init:function(){d.querySelector("header").addEventListener("mousedown",y.mousedown),document.addEventListener("mousemove",y.mousemove),document.addEventListener("mouseup",y.mouseup),d.querySelector("header").classList.add("rs-dialog-grabbable"),window.removeEventListener("resize",y.do),rspkr.item("ui.preventLightboxResize")||window.addEventListener("resize",y.do)},mousedown:function(e){e.target.closest("ul")||(y.mouseStartX=e.pageX,y.mouseStartY=e.pageY,y.dialogStartX=parseInt(d.style.left)||0,y.dialogStartY=parseInt(d.style.top)||0,y.active=!0,d.classList.add("unselectable"),d.querySelector("header").classList.add("rs-dialog-grabbed"))},mousemove:function(e){var t;y.active&&(t=y.dialogStartX-2*(y.mouseStartX-e.pageX),e=y.dialogStartY-2*(y.mouseStartY-e.pageY),y.do(void 0,{left:t,top:e}))},mouseup:function(){y.active&&(d.classList.remove("unselectable"),d.querySelector("header").classList.remove("rs-dialog-grabbed"),rspkr.st.set("dialogx",parseInt(d.style.left)),rspkr.st.set("dialogy",parseInt(d.style.top)),setTimeout(function(){y.active=!1},0))},do:function(e,t){t=t||{left:parseInt(d.style.left)||0,top:parseInt(d.style.top)||0};var r=d.getBoundingClientRect();d.style.left=Math.max(Math.min(t.left,window.innerWidth-r.width),-1*window.innerWidth+r.width)+"px",d.style.top=Math.max(Math.min(t.top,window.innerHeight-r.height),-1*window.innerHeight+r.height)+"px"},kill:function(){d.querySelector("header").removeEventListener("mousedown",y.mousedown),document.removeEventListener("mousemove",y.mousemove),document.removeEventListener("mouseup",y.mouseup),d.querySelector("header").classList.remove("rs-dialog-grabbable")}},b={minWidth:280,minHeight:250,createResize:function(){$rs.createElm("li",{cls:"rs-dialog-resize rsicn rsicn-resize",parent:d.querySelector("footer > ul"),attributes:{role:"button",tabindex:"0","data-rslang":"title/arialabel:resizedialog"},buttonesque:!0}),b.init()},init:function(){d.querySelector(".rs-dialog-resize").addEventListener("mousedown",b.begin),d.querySelector(".rs-dialog-resize").addEventListener("focus",b.begin),document.removeEventListener("mousemove",b.move),document.addEventListener("mousemove",b.move),document.removeEventListener("mouseup",b.end),document.addEventListener("mouseup",b.end),d.querySelector(".rs-dialog-resize").addEventListener("keydown",b.keydown),d.querySelector(".rs-dialog-resize").addEventListener("blur",b.end),d.querySelector(".rs-dialog-resize").classList.add("rs-dialog-grabbable"),window.removeEventListener("resize",b.layout),window.addEventListener("resize",b.layout)},keydown:function(e){if("Arrow"===e.code.substr(0,5)){var t=this.getBoundingClientRect().left,r=this.getBoundingClientRect().top;switch(e.code){case"ArrowRight":t+=10;break;case"ArrowLeft":t-=10;break;case"ArrowDown":r+=10;break;case"ArrowUp":r-=10;break;default:return}b.move(e,{x:t,y:r})}},begin:function(e){"focus"===e.type&&"mousedown"===b.mode||("mousedown"===e.type&&(b.mouseStartX=void 0,b.mouseStartY=void 0),b.mode=e.type,b.active&&b.mouseStartX||(b.active=!0,b.mouseStartX=e.pageX||this.getBoundingClientRect().left,b.mouseStartY=e.pageY||this.getBoundingClientRect().top,b.dialogStartWidth=d.getBoundingClientRect().width,b.dialogStartHeight=d.getBoundingClientRect().height,d.querySelector(".rs-dialog-resize").classList.add("rs-dialog-grabbed")))},move:function(e,t){var r,s;b.active&&("mousemove"===e.type&&"focus"===b.mode||(r="rtl"===window.getComputedStyle(d).direction?-2:2,s=t?t.x:e.pageX,e=t?t.y:e.pageY,d.style.width=Math.max(b.dialogStartWidth+r*(s-b.mouseStartX),b.minWidth)+"px",d.style.height=Math.max(b.dialogStartHeight+2*(e-b.mouseStartY),b.minHeight)+"px",b.layout(),y.do()))},end:function(e){b.active&&(b.mode=void 0,rspkr.st.set("dialogwidth",parseInt(d.style.width)),rspkr.st.set("dialogheight",parseInt(d.style.height)),S.adjustAutoscroll(),rspkr.preventDefault(e),d.querySelector(".rs-dialog-resize").classList.remove("rs-dialog-grabbed"),setTimeout(function(){b.active=!1},0))},layout:function(){var t,r,s,e,n,a,o,i,l,c;p()&&(t=d.getBoundingClientRect().width,a=d.getBoundingClientRect().height,o=d.querySelector("header").getBoundingClientRect().height,r=d.querySelector(":scope > nav").getBoundingClientRect().width,d.querySelector("#rs-dialog-main").style.height=a+"px",d.querySelector("#rs-dialog-contents").style.height=a-o+"px",d.querySelectorAll("#rs-dialog-main").forEach(function(e){e.style.width=t-r+"px"}),s=d.querySelector("#rs-dialog-main > header"),e=d.querySelector("header > h1 > label"),c=s.querySelector("ul"),e.hasAttribute("data-fullsize")||(i=$rs.createElm("label",{content:e.innerText,attributes:{style:"position: absolute; top: -10000px; font-size: "+window.getComputedStyle(e).fontSize},parent:document.body}),e.setAttribute("data-fullsize",i.getBoundingClientRect().width),i.parentElement.removeChild(i)),c.hasAttribute("data-fullsize")||c.setAttribute("data-fullsize",c.getBoundingClientRect().width),l=c.getAttribute("data-fullsize"),n=s.querySelector("h1 > .rsicn").getBoundingClientRect().width,a=parseInt(window.getComputedStyle(s).paddingLeft)+parseInt(window.getComputedStyle(s).paddingRight),o=e.getAttribute("data-fullsize"),i=d.querySelector("#rs-dialog-main").getBoundingClientRect().width,l=function(){for(var e,t=0,r=d.querySelectorAll("#rs-dialog-contents .rs-dialog-content");e=r[t];t++)if($rs.isVisible(e))return e.getBoundingClientRect().width}()-a-l-n-40,e.style.transform=l<o?"scale(%scale%)".replace("%scale%",l/o):null,s.classList.toggle("no-label",l<=.47*o),s.classList.toggle("no-tools1",i-n-a<10*c.querySelector(":scope > li").getBoundingClientRect().width),document.querySelectorAll(".wr-dialog-toolbar-btn[data-placement]").forEach(function(e){e.setAttribute("data-placement","toolbar")}),!rspkr.mobile()&&s.classList.contains("no-tools1")&&document.querySelector(".toolbar-volume").setAttribute("data-placement","hamburger"),!rspkr.mobile()&&s.classList.contains("no-tools1")&&document.querySelector(".toolbar-speed").setAttribute("data-placement","hamburger"),s.classList.contains("no-tools1")&&document.querySelector(".toolbar-fontplus").setAttribute("data-placement","hamburger"),s.classList.contains("no-tools1")&&document.querySelector(".toolbar-fontminus").setAttribute("data-placement","hamburger"),s.classList.contains("no-tools1")&&document.querySelector(".toolbar-textsettings").setAttribute("data-placement","hamburger"),A.create(),c=document.querySelectorAll('.wr-dialog-toolbar-btn[data-placement="hamburger"]').length,document.querySelectorAll("[data-placement]").forEach(function(e){"hamburger"!==e.getAttribute("data-placement")||u.contains(e)||u.appendChild(e),"toolbar"===e.getAttribute("data-placement")&&u.contains(e)&&s.querySelector(":scope > ul").appendChild(e)}),document.querySelectorAll('.wr-dialog-toolbar-btn[data-placement="hamburger"]').length!==c&&Array.from(d.querySelectorAll("header ul li")).sort(function(e,t){return e.getAttribute("wr-toolbar-order")-t.getAttribute("wr-toolbar-order")}).forEach(function(e){e.parentElement.appendChild(e)}),s.querySelector(".toolbar-moretools").classList.toggle("active",u.childElementCount))}},n={open:function(){A.close();var e=$rs.isVisible(d.querySelector(".toolbar-moretools"))?d.querySelector(".toolbar-moretools"):d.querySelector(".toolbar-volume");n.container||(n.container=$rs.createElm("dialog",{cls:["rs-dialog-slider-dropdown","volume-dropdown"],parent:document.body}),new rspkr.ui.Slider({direction:"v",drop:function(){var e=this.value||100;rspkr.st.set("hlvol",e),rspkr.pl.setVolume(e),rspkr.Common.dispatchEvent("onVolumeChanged"),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.VOLUMECHANGED,rspkr.ui.getActivePlayerElm(),[e])},min:0,max:100,step:10,datalist:[0,10,20,30,40,50,60,70,80,90,100],container:n.container}),n.addEvents()),n.container.querySelector("input").value=rspkr.st.get("hlvol")||100,rspkr.Lang.updateUi(n.container),n.container.removeAttribute("style"),n.container.style.display="flex",n.container.showModal();var t=e.getBoundingClientRect();n.container.style.width=t.width-1+"px";e=n.container.getBoundingClientRect();n.container.style.left=2*(t.left-e.left)+"px",n.container.style.top=2*(t.bottom-e.top)+"px",d.querySelector(".toolbar-volume").setAttribute("aria-expanded","true")},addEvents:function(){n.container.addEventListener("cancel",rspkr.preventDefault),n.container.addEventListener("click",n.onClick)},onClick:function(e){var t;n.container.querySelector(".mouse-controlled")||(t=n.container.getBoundingClientRect(),e.clientY>t.top&&e.clientY<t.top+t.height&&e.clientX>t.left&&e.clientX<t.left+t.width||n.close())},close:function(){return!(!n.container||!n.container.open)&&(n.container.close(),n.container.style.display="none",d.querySelector(".toolbar-volume").setAttribute("aria-expanded","false"),!0)}},v={open:function(){A.close();var e=$rs.isVisible(d.querySelector(".toolbar-moretools"))?d.querySelector(".toolbar-moretools"):d.querySelector(".toolbar-speed");v.container||(v.container=$rs.createElm("dialog",{cls:["rs-dialog-slider-dropdown","speed-dropdown"],parent:document.body}),new rspkr.ui.Slider({direction:"v",drop:function(){this.value!==rspkr.st.get("hlspeed")&&(S.stop(),S.destroyPlayer(),rspkr.st.set("hlspeed",this.value),rspkr.Common.dispatchEvent("onSpeedChanged"))},min:5,max:200,step:5,datalist:[5,20,40,60,80,100,120,140,160,180,200],container:v.container}),v.addEvents()),v.container.querySelector("input").value=rspkr.st.get("hlspeed")||100,rspkr.Lang.updateUi(v.container),v.container.removeAttribute("style"),v.container.style.display="flex",v.container.showModal();var t=e.getBoundingClientRect();v.container.style.width=t.width-2+"px";e=v.container.getBoundingClientRect();v.container.style.left=2*(t.left-e.left)+"px",v.container.style.top=2*(t.bottom-e.top)+"px",d.querySelector(".toolbar-speed").setAttribute("aria-expanded","true")},addEvents:function(){v.container.addEventListener("cancel",rspkr.preventDefault),v.container.addEventListener("click",v.onClick)},onClick:function(e){var t;v.container.querySelector(".mouse-controlled")||(t=v.container.getBoundingClientRect(),e.clientY>t.top&&e.clientY<t.top+t.height&&e.clientX>t.left&&e.clientX<t.left+t.width||v.close())},close:function(){return!(!v.container||!v.container.open)&&(v.container.close(),v.container.style.display="none",d.querySelector(".toolbar-speed").setAttribute("aria-expanded","false"),!0)}},t={increase:function(){var e=(parseFloat(d.querySelector("#rs-dialog-contents").style.fontSize)+parseFloat(rspkr.item("general.fontSizes.increment"))).toFixed(1),e=Math.min(e,parseFloat(rspkr.item("general.fontSizes.max")));rspkr.st.set("lbfontsize",e.toFixed(1)),rspkr.devt("onTextSettingChanged",window[e.toFixed(1)]),t.setFontsize(e.toFixed(1))},decrease:function(){var e=(parseFloat(d.querySelector("#rs-dialog-contents").style.fontSize)-parseFloat(rspkr.item("general.fontSizes.increment"))).toFixed(1),e=Math.max(e,parseFloat(rspkr.item("general.fontSizes.min")));rspkr.st.set("lbfontsize",e.toFixed(1)),rspkr.devt("onTextSettingChanged",window[e.toFixed(1)]),t.setFontsize(e.toFixed(1))},setFontsize:function(e){d.querySelector("#rs-dialog-contents").style.fontSize=(e||rspkr.st.get("lbfontsize"))+"em"}},C={open:function(){A.close();var e=$rs.isVisible(d.querySelector(".toolbar-moretools"))?d.querySelector(".toolbar-moretools"):d.querySelector(".toolbar-textsettings");s||(s=$rs.createElm("dialog",{id:"rs-textsettings",content:C.content(),parent:document.body}),C.addEvents()),rspkr.Lang.updateUi(s),s.querySelectorAll("select, input").forEach(function(e){var t=e.getAttribute("data-textsetting");e.value=rspkr.st.get(t)}),s.removeAttribute("style"),s.showModal(),s.style.display="flex";var t=e.getBoundingClientRect(),e=s.querySelector(".rs-textsettings-arrow").getBoundingClientRect();s.style.left=2*(t.left+t.width/2-(e.left+e.width/2))+"px",s.style.top=+(2*(t.top-e.top)+15)+"px",document.querySelector(".toolbar-textsettings").setAttribute("aria-expanded","true")},content:function(){function e(e){return $rs.createElm("option",{attributes:{value:e.value,"data-rslang":"ph_"===e.phrase.substr(0,3)?"content:"+rspkr.Util.legacyPhrase(e.phrase):""},content:e.phrase})}var t=rspkr.st.getSettingsConf().textsettings.items,r=$rs.createElm("div",{cls:"rs-textsettings-arrow"}),s=$rs.createElm("label",{attributes:{"data-rslang":"title/arialabel/content:fontsize",for:"rs-dialog-textsettings-size"}}),n=$rs.createElm("select",{id:"rs-dialog-textsettings-size",content:t.lbfontsize.options.map(e),change:C.onChange,click:function(e){rspkr.preventDefault(e)},attributes:{"data-textsetting":"lbfontsize"}}),a=$rs.createElm("label",{attributes:{"data-rslang":"title/arialabel/content:fontface",for:"rs-dialog-textsettings-font"}}),o=$rs.createElm("select",{id:"rs-dialog-textsettings-font",content:t.fontface.options.map(e),change:C.onChange,click:function(e){rspkr.preventDefault(e)},attributes:{"data-textsetting":"fontface"}}),i=$rs.createElm("label",{attributes:{"data-rslang":"title/arialabel/content:textstyle",for:"rs-dialog-textsettings-color"}}),l=$rs.createElm("select",{id:"rs-dialog-textsettings-color",content:t.textstyle.options.map(e),change:C.onChange,click:function(e){rspkr.preventDefault(e)},attributes:{"data-textsetting":"textstyle"}}),c=$rs.createElm("label",{attributes:{"data-rslang":"title/arialabel/content:textspacing",for:"rs-dialog-textsettings-spacing"}}),p=$rs.createElm("div",{cls:"slider-container"}),d=$rs.createElm("div",{cls:"slider-label-row"});return $rs.createElm("span",{parent:d,content:t.textspacing.options.labelStart}),new rspkr.ui.Slider({id:"rs-dialog-textsettings-spacing",container:p,direction:"h",change:C.onChange,attributes:{"data-textsetting":"textspacing"},min:t.textspacing.options.min,max:t.textspacing.options.max,step:t.textspacing.options.step}),$rs.createElm("span",{parent:d,content:t.textspacing.options.labelEnd}),[r,s,n,a,o,i,l,c,p,d]},addEvents:function(){s.addEventListener("cancel",rspkr.preventDefault),s.addEventListener("click",C.onClick)},onClick:function(e){var t;s.querySelector(".mouse-controlled")||(t=s.getBoundingClientRect(),e.clientY>t.top&&e.clientY<t.top+t.height&&e.clientX>t.left&&e.clientX<t.left+t.width||C.close())},onChange:function(){var e=this.getAttribute("data-textsetting");rspkr.st.set(e,this.value),C.types[e](this.value),rspkr.devt("onTextSettingChanged",window[this.value])},types:{lbfontsize:function(e){t.setFontsize(e)},fontface:function(e){d.querySelector("#rs-dialog-contents").style.fontFamily=rspkr.item("fontmap."+(e||rspkr.st.get("fontface")))||"sans-serif"},textstyle:function(e){var t=rspkr.item("textstyles."+(e||rspkr.st.get("textstyle"))).split(","),e=t.shift(),t=t.shift();d.querySelector("#rs-dialog-contents").style.color=e||"#000",d.querySelector("#rs-dialog-contents").style.background=t||"#fff"},textspacing:function(e){e=e||(rspkr.st.get("textspacing")||0);var t=d.querySelector("#rs-dialog-contents"),e=rspkr.item("textspacings.s"+e);t.style.letterSpacing=e.letterspacing,t.style.wordSpacing=e.wordspacing,t.style.lineHeight=e.lineheight}},close:function(){return!(!s||!s.open)&&(s.close(),s.style.display="none",document.querySelector(".toolbar-textsettings").setAttribute("aria-expanded","false"),!0)}},A={create:function(){u=u||$rs.createElm("dialog",{id:"rs-dialog-moretools",parent:document.body}),A.addEvents()},open:function(){var e,t=d.querySelector(".toolbar-moretools");t&&$rs.isVisible(t)&&(A.create(),u.removeAttribute("style"),u.style.display="flex",u.showModal(),e=t.getBoundingClientRect(),u.style.width=e.width-2+"px",t=u.getBoundingClientRect(),u.style.left=2*(e.left-t.left)-10+"px",u.style.top=2*(e.bottom-t.top)+8+"px")},addEvents:function(){u.addEventListener("cancel",rspkr.preventDefault),u.addEventListener("click",A.onClick)},onClick:function(e){var t=u.getBoundingClientRect();e.clientY>t.top&&e.clientY<t.top+t.height&&e.clientX>t.left&&e.clientX<t.left+t.width||A.close()},close:function(){return!(!u||!u.open)&&(u.close(),u.style.display="none",!0)},empty:function(){u&&(u.innerHTML="")}},w={toggleFullscreen:function(){l?w.doDialog(!0):w.doFullscreen(!0)},doFullscreen:function(e){l=!0,i||(i=$rs.createElm("div",{id:"rs-dialog-fullscreen",cls:"rs-dialog-esque",parent:document.body,attributes:{"aria-labelledby":"rs-dialog-header"}}),rspkr.mobile()&&i.classList.add("mobile")),"unknown"!==o.getAttribute("data-mode")&&i.setAttribute("data-mode",o.getAttribute("data-mode"));for(var t=o.childNodes,r=t.length-1;0<=r;r--)i.prepend(t[r]);rspkr.ui.utils.setZIndex(i,!0),i.style.display="flex",o&&(o.style.display="none"),o.close(),d=i,rspkr.st.set("dialogfullscreen","1"),b.layout(),S.adjustAutoscroll(),e&&i.querySelector(".rs-dialog-fullscreen").focus()},doDialog:function(e){l=!1;for(var t=i.childNodes,r=t.length-1;0<=r;r--)o.prepend(t[r]);i.style.display="none",o.style.display="flex",o.showModal(),d=o,rspkr.st.set("dialogfullscreen","0"),b.layout(),S.adjustAutoscroll(),e&&o.querySelector(".rs-dialog-fullscreen").focus()}},S={playerId:"rs-dialog-player",playing:-1,callbacks:{play:function(){S.setState("playing")},pause:function(){S.setState("paused")},stop:function(){S.setState()}},createPlayer:function(){$rs.createElm("div",{id:S.playerId,cls:"rshidden rs_preserve rs_skip",parent:d}),rspkr.evt("onSpeedChanged",S.destroyPlayer,!0),rspkr.evt("onAPIPlay",S.callbacks.play,!0),rspkr.evt("onAPIPause",S.callbacks.pause,!0),rspkr.evt("onAPIStop",S.callbacks.stop,!0)},destroyPlayer:function(){rspkr.cevt("onSpeedChanged",S.destroyPlayer),rspkr.cevt("onAPIPlay",S.callbacks.play),rspkr.cevt("onAPIPause",S.callbacks.pause),rspkr.cevt("onAPIStop",S.callbacks.stop);var e=rspkr.ui.getActivePlayer();e&&(e.getContainer()||e.getMobileContainer()).id===S.playerId&&(S.setState(),rspkr.hl.clean(),rspkr.ui.destroyActivePlayer(),rspkr.mobile()&&rspkr.Common.Player.expandEmpty({forceOpen:!0}))},setState:function(e){d.querySelector("header > ul").classList.remove("rsplaying","rspaused","rsstopped"),e&&d.querySelector("header > ul").classList.add("rs"+e),"playing"===e&&(S.state=1),"paused"===e&&(S.state=0),e&&"stopped"!==e||(S.state=-1)},play:function(e){if(rspkr.preventDefault(e),1!==S.state)if(0!==S.state){S.adjustAutoscroll();var t=rspkr.ui.getActivePlayer();t&&t.getContainer().id!==S.playerId&&(t.close(),rspkr.ui.destroyActivePlayer()),S.stop();var r=c();if(s=rspkr.findHref()){var s=s.replace(/(readid|readclass)=.+?(&amp;|&|$)/gi,""),e=d.getAttribute("data-mode"),t=d.querySelector("#rs-dialog-contents .rs-dialog-content.active"),t=t.id||(t.id=rspkr.Util.randomString());s=rspkr.setParam("readid",t,s),s=rspkr.setParam("url","",s),"help"===e&&(s=rspkr.setParam("dict","no_customer,no_basic",s),s=rspkr.setParam("rule","none",s),s=rspkr.setParam("xslrule","none",s)),"translate"===e?s=rspkr.setParam("ignoreUserVoice","true",s):(r.removeAttribute("data-rs-lang"),r.removeAttribute("data-rs-voice"),r.removeAttribute("data-rs-cid"),r.removeAttribute("data-rs-stt"),r.removeAttribute("data-rs-stp"),r.removeAttribute("data-rs-set-by")),rspkr.item("general.usePost")||rspkr.hl.clean(),!rspkr.ui.Tools.lastPlayer()||(e=rspkr.ui.Tools.lastPlayer().querySelector(".rsbtn_play"))&&$rs.getAttr(e,"href")&&(n=$rs.getAttr(e,"href"));for(var n=n||rspkr.findHref(),a=[{attr:"lang",name:"lang",useDefault:!0,defaultVal:rspkr.getParam("lang",n)},{attr:"voice",name:"voice",useDefault:!0,defaultVal:rspkr.getParam("voice",n)},{attr:"cid",name:"customerid",useDefault:!1},{attr:"stt",name:"stattype",useDefault:!1},{attr:"stp",name:"statparam",useDefault:!1},{attr:"proxy",name:"useProxy",useDefault:!1}],o=0;o<a.length;o++){var i=a[o],l=r.getAttribute("data-rs-"+i.attr);l?s=rspkr.setParam(i.name,l,s):i.useDefault&&i.defaultVal&&(s=rspkr.setParam(i.name,i.defaultVal,s))}rspkr.evt("onUIStop",S.stop,!0),S.setState("playing");n=rspkr.item("general.skipHiddenContent");rspkr.item("general.skipHiddenContent",!0),window.readpage(s,r,{source:"dialog",usePost:!0,disableCallbacks:!0,isClick:!0}),n||rspkr.item("general.skipHiddenContent",!1),d.querySelector("header > ul .toolbar-play").setAttribute("data-rslang","title/arialabel:pause"),rspkr.Lang.updateUi(d.querySelector("header > ul"))}}else S.resume();else S.pause()},pause:function(){rspkr.ui.getActivePlayer().pause(),S.setState("paused"),d.querySelector("header > ul .toolbar-play").setAttribute("data-rslang","title/arialabel:resume"),rspkr.Lang.updateUi(d.querySelector("header > ul"))},resume:function(){rspkr.ui.getActivePlayer().play(),S.setState("playing"),d.querySelector("header > ul .toolbar-play").setAttribute("data-rslang","title/arialabel:pause"),rspkr.Lang.updateUi(d.querySelector("header > ul"))},stop:function(){var e;!d.querySelector("header > ul").classList.contains("rsplaying")&&!d.querySelector("header > ul").classList.contains("rspaused")||(e=rspkr.ui.getActivePlayer())&&e.getContainer().id===S.playerId&&(rspkr.api.callback.execute(rspkr.api.callback.enums.UI.STOP,rspkr.ui.getActivePlayerElm()),e.close(!0),S.setState("stopped"),d.querySelector("header > ul .toolbar-play").setAttribute("data-rslang","title/arialabel:playfromstart"),rspkr.Lang.updateUi(d.querySelector("header > ul")))},adjustAutoscroll:function(){},restoreAutoscroll:function(){}};return{dependency:["Common","pub.Config"],close:r,getDialog:p,getPlayer:c,init:function(){},isOpen:a,open:function(e){if(!a()){if(!function(){if(rspkr.hl.enlarge.isActive()){rspkr.runtime.revert.enlarge=true;rspkr.hl.enlarge.disable()}if(rspkr.ui.Tools.ClickListen.active()){rspkr.runtime.revert.clicklisten=true;rspkr.ui.Tools.ClickListen.deactivate()}}(),rspkr.ui.ControlPanel&&rspkr.ui.ControlPanel.kill(),rspkr.ui.LoadIndicator.show(),rspkr.Popup.closePopup(void 0,!0),"function"!=typeof HTMLDialogElement)return e.legacyButtons&&(e.buttons=e.legacyButtons),e.legacyCallback&&(e.callback=e.legacyCallback),void rspkr.c.useLegacy(function(){rspkr.Legacy.Lightbox.show(e)});var r,s,t,n;l=!1,o&&(d=o),i&&(i.innerHTML=""),rspkr.ui.Accessibility.escapes.menu(),rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().pause(),(e=e||{}).width||(e.width=rspkr.st.get("dialogwidth"))||(e.width=600),e.height||(e.height=rspkr.st.get("dialogheight"))||(e.height=650),e.mode||(e.mode="unknown"),e.buttons||(e.buttons={close:!0}),e.toolbar||(e.toolbar=rspkr.mobile()?["play","stop","fontminus","fontplus","textsettings","moretools","fullscreen","close"]:["play","stop","volume","speed","fontminus","fontplus","textsettings","moretools","fullscreen","close"]),e.titleKey||rspkr.error("[rspkr.Dialog] Missing attribute titleKey"),e.icon||rspkr.error("[rspkr.Dialog] Missing attribute icon"),rspkr.c.dispatchEvent("onBeforeLightboxOpened",window,[]),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.DIALOG.BEFOREOPEN,rspkr.ui.getActivePlayerElm(),e.mode),o||(o=$rs.createElm("dialog",{id:"rs-dialog",cls:"rs-dialog-esque",parent:document.body,attributes:{"aria-labelledby":"rs-dialog-header"}}),rspkr.mobile()?o.classList.add("mobile"):(o.style.width=e.width+"px",o.style.height=e.height+"px",o.style.left=(rspkr.st.get("dialogx")||0)+"px",o.style.top=(rspkr.st.get("dialogy")||0)+"px"),o.addEventListener("cancel",function(e){rspkr.preventDefault(e)}),d=o,f.addEvents()),d.setAttribute("data-mode",e.mode),d.innerHTML='<nav></nav><div id="rs-dialog-main">\t<header><h1></h1><ul></ul></header>\t<div id="rs-dialog-contents" data-rs-autoscroll-offset="150" tabindex="0"></div>\t<footer><ul></ul></footer></div>',C.types.lbfontsize(),C.types.fontface(),C.types.textspacing(),C.types.textstyle(),e.tabs?(t=e.tabs,r=d.querySelector(":scope > nav"),s=$rs.createElm("ul",{parent:r,attributes:{role:"tablist"}}),t.forEach(function(e){e.nameKey&&e.content||rspkr.error("[rspkr.Dialog] Tab was insufficiently specified.");var t=rspkr.Util.randomString();$rs.createElm("li",{cls:"rs-tab-"+e.name,attributes:{"data-rslang":"title/arialabel:"+rspkr.Util.legacyPhrase(e.tabKey),"data-content-id":t,"data-tab-id":e.tabId||"",role:"tab",tabindex:"0","aria-controls":t,"aria-selected":"false"},buttonesque:!0,content:'<span class="rsicn rsicn-%icon%"></span><label data-rslang="content/arialabel:%name%"></label>'.replace("%icon%",e.icon).replace("%name%",rspkr.Util.legacyPhrase(e.tabKey)),click:function(e){var t;rspkr.preventDefault(e),this.classList.contains("active")||(S.destroyPlayer(),t=this.getAttribute("data-content-id"),d.querySelectorAll('.rs-dialog-content:not([id="%id"])'.replace("%id",t)).forEach(function(e){e.style.display="none",e.hidden=!0,e.setAttribute("aria-hidden",!0)}),this.parentElement.querySelector(".active").classList.remove("active"),this.parentElement.querySelector('[aria-selected="true"]').setAttribute("aria-selected","false"),this.classList.add("active"),this.setAttribute("aria-selected","true"),t=d.querySelector('.rs-dialog-content[id="%id"]'.replace("%id",t)),d.querySelector("#rs-dialog-contents .rs-dialog-content.active").classList.remove("active"),t.classList.add("active"),t.style.display="block",t.hidden=!1,t.setAttribute("aria-hidden",!1),rspkr.mobile()&&r.classList.contains("show-labels")&&h(e),rspkr.devt("onDialogTabChanged",window,[t,this]))},parent:s}),s.querySelector("li").classList.add("active"),s.querySelector("li").setAttribute("aria-selected","true");e=g(e.content);e.id=t,e.setAttribute("role","tabpanel")}),$rs.createElm("button",{cls:"label-toggler",attributes:{"data-rslang":"title/arialabel:expandnavigation"},parent:d.querySelector(":scope > nav")}),d.querySelector(":scope > nav").addEventListener("click",h)):d.querySelector(":scope > nav").style.display="none",A.empty(),t=e,d.querySelector("header h1").innerHTML='<span class="rsicn rsicn-%icon%"></span><label data-rslang="content:%title%" id="rs-dialog-header"></label>'.replace("%icon%",t.icon).replace("%title%",t.titleKey),"none"!==(t=e.toolbar)&&t.forEach(function(e){m[e].call(void 0,{type:"toolbar"})}),d.querySelectorAll("header ul li").forEach(function(e,t){e.hasAttribute("wr-toolbar-order")||e.setAttribute("wr-toolbar-order",t)}),e.content&&g(e.content),e.buttons&&function(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t]!==false){typeof e[t]==="object"&&(e[t].type="buttons");typeof m[t]==="function"?m[t].call(undefined,{type:"buttons"}):m.generic(e[t])}!rspkr.mobile()&&b.createResize()}(e.buttons),d.querySelector("#rs-dialog-contents .rs-dialog-content").classList.add("active"),S.createPlayer(),rspkr.mobile()||y.init(),rspkr.Lang.updateUi(d),"function"==typeof e.callback&&e.callback.apply(this,[d]),d.style.display="flex",d.showModal(),b.layout(),d.querySelector("#rs-dialog-contents").addEventListener("scroll",function(){d.querySelector("header").classList.toggle("content-scrolled",15<this.scrollTop)}),d.querySelector("header").addEventListener("mouseover",function(){this.classList.add("content-scrolled")}),d.querySelector("header").addEventListener("mouseout",function(){d.querySelector("#rs-dialog-contents").scrollTop<=15&&this.classList.remove("content-scrolled")}),k.disableScroll(),rspkr.mobile()&&w.doFullscreen(),"1"===rspkr.st.get("dialogfullscreen")&&w.doFullscreen(),e.trigger&&e.trigger.setAttribute&&(e.ariaExpand&&e.trigger.setAttribute("aria-expanded",!0),n=function(){e.trigger.setAttribute("aria-expanded",!1),rspkr.cevt("onLightboxClosed",n)},rspkr.evt("onLightboxClosed",n)),rspkr.ui.LoadIndicator&&rspkr.ui.LoadIndicator.hide({keepOverlay:!1}),rspkr.c.data.clearSelectedText(),d.querySelector("nav ul li, header ul li").focus(),rspkr.c.dispatchEvent("onAfterLightboxOpened",window,[]),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.DIALOG.OPEN,rspkr.ui.getActivePlayerElm(),e.mode)}},updateFontSize:C.types.lbfontsize,updateFontFace:C.types.fontface,updateTextColor:C.types.textstyle,updateTextSpacing:C.types.textspacing}}(),window.ReadSpeaker.ui.Overlay=function(){var o;return{hide:function(e){"player"!==(e=e||{}).type&&(o&&(o.style.display="none"),$rs.unregEvent(o,"click")),"fullscreen"!==e.type&&$rs.css($rs.arr(".rsbtn_status_overlay"),"display","none")},show:function(e){var t,r,s,n,a;(e=e||{}).player&&!0!==e.fullscreen?(t=e,rspkr.mobile()?n=rspkr.Mobile.ui.Player().getMobileContainer():("object"==typeof t.player&&t.player.getContainer&&(n=t.player.getContainer()),"string"==typeof t.player&&(n=document.querySelector("#"+t.player))),n&&($rs.removeClass(n,"rsloading"),(s=(r=(r=n.querySelector(".rsbtn_status_overlay"))||$rs.createElm("span",{cls:"rsbtn_status_overlay",content:'<span class="rsbtn_status"></span>',parent:n.querySelector(".rsbtn_exp_inner")||n.querySelector(".rsmpl-tools")})).querySelector(".rsbtn_status")).innerHTML="",t.message&&"nosound"===t.message?$rs.createElm("a",{cls:"rsbtn_nosound",content:rspkr.Lang.getPhrase("nosound"),click:function(){return rspkr.ui.getActivePlayer().nosound()}}):t.message&&"loaderror"===t.message?(s.innerHTML=rspkr.Lang.getPhrase("loaderror")||"An error has occurred, try again",(n=rspkr.Lang.getPhrase("nosoundlink"))&&n.trim().length&&"."!==n||(n="[?]"),a=rspkr.c.data.getSaveData("link"),$rs.createElm("a",{cls:"rsbtn_loaderror",content:n,href:a,attributes:{target:"_blank"},click:function(e){rspkr.preventDefault(e);rspkr.Dialog.open({titleKey:"error",icon:"error",content:"<div class='error'>Check the current service status on the <a href='https://announcements.readspeaker.com/' target='_blank'>ReadSpeaker Announcements Site</a>.</div>"+("<iframe src='"+a+"' style='height:300px;width:100%;border:0;'></iframe>"),forceHeight:300,height:300,toolbar:["fontminus","fontplus","textsettings","moretools","fullscreen","close"],mode:"loaderror"})},parent:s})):t.message&&(s.innerHTML=t.message),r.style.display="flex",rspkr.Util.fitText(s),rspkr.ui.LoadIndicator.hide())):(e=(e=e)||{},o?o.style.display="":o=$rs.createElm("div",{id:"rs_overlay",attributes:{"aria-hidden":!0},parent:document.body}),rspkr.ui.utils.setZIndex(o,!0),e.click&&"function"==typeof e.click&&$rs.regEvent(o,"click",e.click))}}}(),window.ReadSpeaker.ui.LoadIndicator=function(){function s(e){!0!==(e=e||{}).keepOverlay&&rspkr.ui.Overlay.hide({type:"fullscreen"}),n&&(n.style.display="none"),$rs.css($rs.arr(".rs-player-loadindicator"),"display","none")}var n,a=function(e){return e.nodeName?e:"object"==typeof e&&e.getContainer?e.getContainer():"string"==typeof e&&(e=$rs.arr(e))&&e.length?e[0]:void 0};return{hide:s,init:function(){ReadSpeaker.Common.addEvent("onUIStop",function(){$rs.css($rs.arr(".rsbtn-progress, .rsbtn-loading"),"display","none")})},show:function(e){var t,r,s;(e=e||{}).player&&(e.fullscreen,!0!==e.fullscreen)?(t=e,!0!==rspkr.features.loaderplayer||(s=a(t.player))&&$rs.isVisible(s)&&(r=s.querySelector(".rsbtn_play"),e=s.querySelector(".rsbtn_exp_inner")||s,(s=(s=s.querySelector(".rs-player-loadindicator"))||$rs.createElm("span",{cls:"rs-player-loadindicator",content:'<span class="rsbtn-progress"></span><span class="rsbtn-loading"></span>',parent:e})).style.left=r?-1*$rs.width(r)+"px":"0",!rspkr.mobile()&&rspkr.item("ui.toolbar.inverted")?s.style.top="2.25em":s.style.removeProperty("top"),s.style.display="block",s.querySelector(".rsbtn-progress").style.display="none",!0!==t.idle&&(s.querySelector(".rsbtn-loading").style.display="block"))):!0===rspkr.features.loaderscreen&&(rspkr.ui.Overlay.show(),(n=n||$rs.createElm("div",{id:"rs_loadindicator_fullscreen",attributes:{"aria-hidden":!0},content:['<div class="rs_spinner rs_spinner1"></div>','<div class="rs_spinner rs_spinner2"></div>','<div class="rs_spinner rs_spinner3"></div>'].join(""),parent:document.body})).style.display="block",rspkr.ui.utils.setZIndex(n,!0))},update:function(e){var t,r;(e=e||{}).player||(e.player=rspkr.ui.getActivePlayer()),e.progress||(e.progress=[0,0]),e.player&&(!0!==rspkr.features.progressbar&&s(),r=(t=a(e.player))&&t.querySelector(".rs-player-loadindicator"),t&&r&&(r.querySelector(".rsbtn-loading").style.display="none",(r=r.querySelector(".rsbtn-progress")).style.display="block",r.style.width=0===e.progress[0]?0:Math.round(e.progress[0]/e.progress[1]*100)+"%"))}}}(),ReadSpeaker.ui.Tools.PageMask=function(){function s(){i=!0,g[l].activate(),$rs.css("#rsmask-tools","display","block"),$rs.regEvent("#rsmask-tools-close","click",n),$rs.regEvent("#rsmask-tools-larger","click",h.larger),$rs.regEvent("#rsmask-tools-smaller","click",h.smaller),$rs.regEvent(document.body,"mousemove",h.mousemove),$rs.regEvent(document,"keydown",h.keyboard),$rs.regEvent(window,"resize",function(){g[l].resize()}),$rs.regEvent(window,"touchstart",function(e){c=!0,2===e.originalEvent.touches.length&&(t=!0)}),$rs.regEvent(window,"touchend",function(){t&&g[l].resize(),t=!1}),rspkr.mobile()&&(o=$rs.height(window)/2),h.mousemove(),$rs.setAttr($rs.arr('.rsbtn_tool[data-rs-tool="pagemask"]'),"aria-pressed",!0),rspkr.st.set("hlscroll","scrolloff"),rspkr.devt("onPageMaskOpened",window),rspkr.ui.Accessibility.ScreenReader.announce("announce-pagemaskactive")}function n(){i=!1,g[l].inactivate(),$rs.css("#rsmask-tools","display","none"),$rs.unregEvent("#rsmask-tools-close, #rsmask-tools-larger, #rsmask-tools-smaller","click"),$rs.unregEvent(document.body,"mousemove"),$rs.unregEvent(document,"keydown"),$rs.unregEvent(window,"touchstart touchend"),$rs.setAttr($rs.arr('.rsbtn_tool[data-rs-tool="pagemask"]'),"aria-pressed",!1),rspkr.devt("onPageMaskClosed",window,[l]),rspkr.ui.Accessibility.ScreenReader.announce("announce-pagemaskinactive")}function e(){a.mask.height=parseInt(ReadSpeaker.Common.Settings.get("maskh")||70),document.querySelectorAll('.rsbtn_tool[data-rs-tool="pagemask"]').forEach(function(e){e.setAttribute("aria-pressed",!1)})}var o,a={mask:{height:70,min:10,max:250,increment:10}},i=!1,l="",c=!1,t=!1,p=!1,d=['<div id="rsmasking-container">','\t<div id="rsmask-top"></div>','\t<div id="rsmask-middle">','\t\t<span class="rsicn rsicn-keyboard" aria-hidden="true"></span>',"\t</div>",'\t<div id="rsmask-tools">','\t\t<div id="rsmask-tools-larger" role="button" data-rslang="title/arialabel:pagemaskplus"></div>','\t\t<div id="rsmask-tools-smaller" role="button" data-rslang="title/arialabel:pagemaskminus"></div>','\t\t<div id="rsmask-tools-close" role="button" data-rslang="title/arialabel:close"></div>',"\t</div>",'\t<div id="rsmask-bottom"></div>',"</div>"],u=!1,h={mousemove:function(e){g[l].mousemove(e)},touchmove:function(e){c=!0;var t=e.originalEvent,e=t.targetTouches[0];t.preventDefault(),g[l].mousemove(e)},larger:function(e){h.resize(e,a[l].increment)},smaller:function(e){h.resize(e,-a[l].increment)},resize:function(e,t){var r=a[l];r.height+=t,r.height=0<t?r.height>r.max?r.max:r.height:r.height<r.min?r.min:r.height,g[l].mousemove(e),h.storeSize(r.height)},storeSize:function(e){rspkr.st.set(l+"h",e)},keyboard:function(e){g[l].keyboard(e)}},g={mask:{activate:function(){$rs.css("#rsmask-top, #rsmask-middle, #rsmask-bottom","display","block"),$rs.regEvent("#rsmask-middle","touchmove",h.touchmove)},inactivate:function(){$rs.css("#rsmask-top, #rsmask-middle, #rsmask-bottom","display","none"),$rs.unregEvent("#rsmask-middle","touchmove")},mousemove:function(e){var t,r;e&&e.clientY?t=e.clientY:isNaN(o)?(r=$rs.get("#rsmask-middle"),o=t=r&&!$rs.isArray(r)&&$rs.isVisible(r)?$rs.offset(r).top+$rs.height(r)/2:$rs.height(window)/2):t=o,$rs.css("#rsmask-top","height",t-a.mask.height/2+"px"),$rs.css("#rsmask-middle",{top:t-a.mask.height/2+"px",height:a.mask.height+"px"}),$rs.css("#rsmask-bottom","height",(c?window.innerHeight:$rs.height(window))-t-a.mask.height/2+"px"),$rs.css("#rsmask-tools","top",t-$rs.outerHeight("#rsmask-tools")/2+"px"),e&&(o=t)},adjustbottom:function(){$rs.css("#rsmask-middle",{top:$rs.css("#rsmask-top","height"),height:a.mask.height+"px"}),$rs.css("#rsmask-bottom","height",(c?window.innerHeight:$rs.height(window))-($rs.height("#rsmask-top")+a.mask.height)+"px")},resize:function(){g.mask.adjustbottom()},keyboard:function(e){function t(){e.preventDefault&&e.preventDefault(),e.originalEvent&&e.originalEvent.preventDefault&&e.originalEvent.preventDefault()}var r=this,s=e.originalEvent,n={ArrowUp:function(){o=Math.max(o-10*(s.shiftKey?10:1),0),r.mousemove()},ArrowDown:function(){o=Math.min(o+10*(s.shiftKey?10:1),$rs.height(window)),r.mousemove()},Plus:function(){h.larger()},Minus:function(){h.smaller()}};"Space"===s.code&&((u=!u)?$rs.addClass($rs.findIn("#rsmask-middle",".rsicn-keyboard"),"active"):$rs.removeClass($rs.findIn("#rsmask-middle",".rsicn-keyboard"),"active"),t());var a=s.key;"-"===(a="+"===a?"Plus":a)&&(a="Minus"),u&&n[a]&&(n[a](),t())}}};return ReadSpeaker.Common.addEvent("onToolsInitialized",function(){e()}),{init:e,start:function(e,t){var r;p||(r=$rs.createElm("div",{content:d.join("\n")}).childNodes[0],rspkr.Lang.updateUi(r),rspkr.ui.utils.setZIndex(r,!0),document.body.appendChild(r),p=!0),l.length&&e!==l&&n(),l.length&&i&&e===l?n():(l=e,s(),rspkr.mobile()||h.mousemove(t))},inactivate:n,activate:s,isActive:function(){return i}}}(),ReadSpeaker.ui.Tools.Dictionary=function(){function r(e){var t=$rs.findIn(e,".rsbtn_play");(t=$rs.isArray(t)?rspkr.findHref():$rs.getAttr(t,"href"))&&"string"==typeof t&&t.length&&(t=rspkr.getParam("lang",t),-1===a.indexOf(t)&&-1===a.indexOf(t.substr(0,2))&&(rspkr.log("[Dictionary] Dictionary tool not supported by language "+t+", removing button",1),t=$rs.findIn(e,".rsbtn_tool_dict"),$rs.isArray(t)||t&&t.parentElement.removeChild(t),t=$rs.findIn(e,".rsmpl-dictionary"),$rs.isArray(t)||t&&t.parentElement.removeChild(t)))}var a=rspkr.API.tools.Dictionary.supportedLanguages(),d={createElement:function(e){var t,r;if(e.id&&(t=document.getElementById(e.id)))return t;if(t=e.type?document.createElement(e.type):document.createElement("div"),e.id&&(t.id=e.id),e.class&&(t.className=e.class),e.value&&(t.value=e.value),e.click&&$rs.regEvent(t,"click",e.click),e.attributes&&$rs.isArray(e.attributes))for(var s=0,n=e.attributes.length;s<n;s++)-1<e.attributes[s].indexOf("=")&&$rs.setAttr(t,e.attributes[s].split("=").shift(),e.attributes[s].split("=").pop());return e.content&&("object"==typeof e.content?((r=document.createElement("div")).appendChild(e.content),t.innerHTML=r.innerHTML):t.innerHTML=e.content),(e.container||document.body).appendChild(t),t},addServerMarkup:function(e){var t=document.createElement("div"),r=d.createElement({class:"rs-dictionary server-markup",container:t}),s=d.createElement({class:"rs-dictionary-toprow",container:r,attributes:["role=heading","aria-level=2"]}),n='<a href="'+e.source+'" target="_blank"><span data-rslang="content:source"></span>: <span data-rslang="content:wiktionary"></span></a>';return d.createElement({type:"span",class:"rs-dictionary-source",content:" ("+n+")",container:s}),d.createElement({type:"span",class:"rs-dictionary-query",content:e.query,container:s}),d.createElement({class:"rs-dictionary-definition",content:e.markup.replace(/H3/gi,"H2"),container:r}),t.innerHTML},createDictMarkup:function(e){if(e.markup&&e.markup.length)return d.addServerMarkup(e);for(var t,r,s,n,a,o,i=document.createElement("div"),l=0,c=e.definitions.length;l<c;l++){for(t=e.definitions[l],r=document.createElement("div"),s=d.createElement({type:"span",class:"rs-dictionary-toprow",container:r,attributes:["role=heading","aria-level=2"]}),n=d.createElement({type:"ol",attributes:["type=a"],class:"rs-dictionary-definition-list",container:r}),$rs.isArray(t.definition)||(t.definition=[t.definition]),d.createElement({type:"span",content:Number(l+1).toString()+".",class:"rs-dictionary-index",container:s}),d.createElement({type:"span",content:t.word,class:"rs-dictionary-word",container:s}),d.createElement({type:"span",content:t.class,class:"rs-dictionary-class",container:s}),t.pronunciation&&t.pronunciation.length,a=0,o=t.definition.length;a<o;a++)d.createElement({type:"li",content:t.definition[a],class:"rs-dictionary-definition-item",container:n});if(t.examples&&t.examples.length){$rs.createElm("span",{attributes:{"data-rslang":"title/arialabel/content:examples"},cls:"rs-dictionary-examples-header",parent:r});var p=d.createElement({type:"ol",attributes:["type=1"],class:"rs-dictionary-examples-list",container:r});for(d.createElement({type:"span",content:""}),a=0;a<t.examples.length;a++)d.createElement({type:"li",content:t.examples[a],class:"rs-dictionary-examples-item",container:p})}r=r.innerHTML.split("</span>").join("</span>\n"),d.createElement({class:"rs-dictionary",content:r,container:i})}return i.innerHTML.replace(/H3/gi,"H2")},triggerLuMsg:function(e){$rs.regEvent($rs.findIn(e,".rslightbox-trmessage-button"),"click",function(){rspkr.st.set("lu_agreed","1");var e=this.closest(".rslightbox-trmessage");e&&e.parentElement.removeChild(e)})},errorMessages:{unsupportedLanguage:function(e){for(var t="",r=0,s=a.length;r<s;r++)t+='<li data-rslang="content:%langName">'.replace("%langName",a[r])+a[r]+"</li>";d.openDialog('<p><span data-rslang="content:languagenotsupported"></span>: <span data-rslang="%lang"></span></p>'.replace("%lang",e)+'<p><span data-rslang="content:supportedlanguages"></span>:</p><ul>'+t+"</ul>")},notFound:function(e){d.openDialog('<span data-rslang="content:wordnotfound" data-rslangfilter="transWordNotFound" data-word="%word"></span>'.replace("%word",e.trim()))},loadError:function(){d.openDialog('<span data-rslang="content:loaderror"></span>')},noSelection:function(){d.openDialog('<span data-rslang="content:selectionrequireddict"></span>')},xhrError:function(e){rspkr.error("[Tools.Dictionary] Error looking up text: "+e.message),d.openDialog('<span data-rslang="content:loaderror"></span><br/>Error: '+e.message)}},openDialog:function(e,t){rspkr.Dialog.open({icon:"dictionary",titleKey:"dictionary",content:e,callback:t||void 0,mode:"dictionary"})},dictionary:function(e,t){if(-1===a.map(e=>e.substr(0,2)).indexOf(e.toLowerCase().substr(0,2)))return d.errorMessages.unsupportedLanguage(e);var r=t||(r=rspkr.c.data.getSelectedText(),r=rspkr.c.data.cleanSkippedContent(r,{cleanAlwaysSkipped:!0}),rspkr.c.data.cleanSecretContent(r)),s=document.createElement("div");if(s.innerHTML=r,"string"==typeof(r=(r=(s.innerText||s.textContent).trim().split(/\s/).shift().toLowerCase()).replace(/[\?\.\,\;\:\-\!]/,"").trim())&&r.length){var n,t=rspkr.item("general.wrapiUrl")||rspkr.c.data.setWrapiUrl(),s=rspkr.findHref(),s=("cat=Dict&w=[[text]]&l=[[source]]&cid=[[cid]]&inclAdult=[[inclAdult]]&url="+encodeURIComponent(document.location.href)).replace("[[text]]",encodeURIComponent(r.trim())).replace("[[source]]",e.substr(0,2)).replace("[[cid]]",s?rspkr.getParam("customerid",s):void 0).replace("[[inclAdult]]",!0===rspkr.item("general.inclAdult")?1:0);s+="&prod=wr",window.XMLHttpRequest&&(n=new XMLHttpRequest),rspkr.c.data.clearSelectedText(),n.onreadystatechange=function(){if(4!==this.readyState||200!==this.status)return 4===this.readyState&&404===this.status?d.errorMessages.notFound(r):4===this.readyState?d.errorMessages.loadError():void 0;var e=JSON.parse(this.responseText),t="";!e.definitions||e.definitions.length?("1"!==rspkr.st.get("lu_agreed")&&(t=['<div class="rs_skip rs_preserve">','\t<div class="rslightbox-trmessage rs_skip" lang="'+rspkr.Lang.getUiLang().substr(0,2)+'" role="note">','\t\t<div class="rslightbox-trmessage-text" data-rslang="content:dictionarymessage"></div>','\t\t<div class="rslightbox-trmessage-buttons"><button type="button" class="rslightbox-trmessage-button" data-rslang="content:iunderstand"></button></div>',"\t</div>","</div>"].join("")),d.openDialog(t+d.createDictMarkup(e),function(e){$rs.findIn(e,".rslightbox-trmessage")&&d.triggerLuMsg(e)})):d.errorMessages.notFound(r)}.bind(n);try{n.open("GET",t+"?"+s,!0),n.send()}catch(e){return d.errorMessages.xhrError(e)}}else d.errorMessages.noSelection()}};return ReadSpeaker.Common.addEvent("onToolsInitialized",function(e,t){!0===rspkr.features.dictionary_toolbar&&r(e)}),{init:r,dictionary:d.dictionary}}(),ReadSpeaker.ui.Tools.ClickListen=function(){function r(){(!i&&rspkr.audio||rspkr.pl.playerRef)&&v();var e=rspkr.mobile()?document.querySelector("#rsmpl_container .rsmpl-clicklisten"):document.querySelector('.rsbtn_tool[data-rs-tool="clicklisten"]');e&&$rs.addClass(e,"active"),e&&$rs.setAttr(e,"aria-pressed","true"),i||(rspkr.st.set(c,p),a=(i=!0)===rspkr.item("general.usePost"),rspkr.item("general.usePost",!0),rspkr.item("general.premarkup")&&(h=h.filter(e=>!e.match("sync"))),f(),k(),rspkr.mobile()||w.init(),rspkr.ui.Accessibility.ScreenReader.announce("announce-clicklistenactive"))}function e(e){if(!rspkr.c.data.selectedText){for(var t=e.originalEvent.srcElement;rspkr.c.data.params.synccontainer&&t.nodeName.toLowerCase()===rspkr.c.data.params.synccontainer.toLowerCase()&&t.parentElement&&t!==document.body;)t=t.parentElement;y(t)&&(rspkr.mobile()||(w.setTabbedElm(t),w.identifyAreas(w.tabbedElm.parentElement,{elm:w.tabbedElm})),$rs.hasClass(t,l)||C(),b(t))}}function s(e){C({forceOpen:!1}),"userclick"===e&&$rs.removeClass($rs.arr("."+w.tabCls),w.tabCls),"userclick"===e&&document.querySelector(".rs_splitbutton")&&m()}function t(){C({forceOpen:!0})}function n(){var e=rspkr.item("settings."+c)===p,t=!!rspkr.st.get(c);(rspkr.st.get(c)===p||e&&!t)&&rspkr.getRSBtns().length&&r(),h.push(rspkr.rsbtnClass()),rspkr.c.clearEvent("onUIClosePlayer",s),rspkr.c.addEvent("onUIClosePlayer",s)}var a,o,i=!1,l="rs-click-listen",c="clicklisten",p="on",d="off",u=["html","body","noscript","rs:span"],h=["rsbtn",rspkr.cls.textnode,"sync_sent","sync_word",rspkr.cls.skipalways,"rs-dialog-esque"],g=["rs-controlpanel","rs_enlargeHL_box"],m=function(){var e;i&&(v(),(e=rspkr.mobile()?document.querySelector("#rsmpl_container .rsmpl-clicklisten"):document.querySelector('.rsbtn_tool[data-rs-tool="clicklisten"]'))&&$rs.removeClass(e,"active"),e&&$rs.setAttr(e,"aria-pressed","false"),rspkr.st.set(c,d),(i=!1)===a&&rspkr.item("general.usePost",!1),f(),$rs.removeClass($rs.get("."+l),l),$rs.removeClass($rs.get("."+w.tabCls),w.tabCls),rspkr.ui.Accessibility.ScreenReader.announce("announce-clicklisteninactive"))},k=function(){$rs.regEvent(document,"click",e),rspkr.c.addEvent("onUIStop",t)},f=function(){$rs.unregEvent(document,"click",e),rspkr.c.clearEvent("onUIStop",t)},y=function(e){if(!e||e===document)return!1;if(1!==e.nodeType)return!1;if(0<=u.indexOf(e.tagName.toLowerCase()))return!1;var t=e.textContent||e.alt||e.title||e.getAttribute("aria-label");if(!t||!t.trim().length)return!1;if(!$rs.isVisible(e))return!1;for(var r=0;r<h.length;r++)if($rs.closest(e,"."+h[r]))return!1;for(var s=0;s<g.length;s++)if($rs.closest(e,"#"+g[s]))return!1;for(var n,a=Array.prototype.slice.call(rspkr.getRSBtns()),o=0;n=a[o];o++)if(n.contains(e))return!1;t=rspkr.item("ui.clickListenExclude");if(t&&$rs.closest(e,t))return!1;t=e.outerHTML,t=rspkr.c.data.cleanSkippedContent(t,{cleanAllSkipped:!0});return t=rspkr.c.data.cleanSecretContent(t),!!$rs.createElm("div",{content:t}).textContent.length},b=function(e){var t;rspkr.ui.Accessibility.escapes.menu(),$rs.hasClass(e,l)?((t=rspkr.ui.getActivePlayer()).getMobileContainer?t.getMobileContainer():t.getContainer()).classList.contains("rsplaying")?t.pause():t.play():(rspkr.c.data.selectedHTML="",rspkr.c.data.selectedText="",t=e,A(),$rs.addClass(t,"rs-outline"),$rs.removeClass($rs.arr("."+l),l),$rs.addClass(e,l),e=rspkr.findHref(),e=rspkr.setParam("readclass",l,e),e=rspkr.setParam("readid","",e),rspkr.pl.releaseAdapter(),window.readpage(e,void 0,{source:"clicklisten",usePost:!0}))},v=function(){document.querySelectorAll("."+l).length&&C({forceOpen:!0}),w.exit()},C=function(e){e=e||{},rspkr.ui.getActivePlayer()&&rspkr.pl.releaseAdapter(),e.forceOpen&&rspkr.Common.Player.expandEmpty({source:"clicklisten"}),$rs.removeClass($rs.arr("."+l),l),A()},A=function(){$rs.removeClass($rs.arr(".rs-outline"),"rs-outline")},w={tabCls:"rs-cl-tabbable",elmList:[],elmIndex:0,tabbedElm:void 0,createFocus:function(e){o=(o=!o&&rspkr.ui.getActivePlayer()?rspkr.ui.getActivePlayer().getContainer():o)||rspkr.getRSBtns()[0],e=e||(o&&o.parentElement?o.parentElement:document.body),w.identifyAreas(e)},init:function(){w.addEvents()},addEvents:function(){document.addEventListener("keydown",w.keydown)},removeEvents:function(){document.removeEventListener("keydown",w.keydown)},keydown:function(e){if(-1!==[37,38,39,40,76].indexOf(e.which))switch(e.which){case 37:return w.movePrev(e);case 38:return w.moveUp(e);case 39:return w.moveNext(e);case 40:return w.moveDown(e);case 76:return w.run(e)}},identifyAreas:function(e,t){var r,s=[];e.childNodes.forEach(function(e){y(e)&&(t&&e===t.elm&&(r=s.length),w.tabbedElm||e!==o?s.push(e):r=s.length-1)}),s.length&&(w.elmList=s,w.elmIndex=r||0,w.setTabbedElm(w.elmList[w.elmIndex]))},setTabbedElm:function(e){w.tabbedElm=e,$rs.removeClass($rs.get("."+w.tabCls),w.tabCls),$rs.addClass(e,w.tabCls),rspkr.ui.utils.playerInViewport(e)||rspkr.ui.AutoScroll.scroll(e,!0)},moveNext:function(e){e.preventDefault(),w.tabbedElm||w.createFocus(),w.elmIndex===w.elmList.length-1?w.moveUp(e):w.setTabbedElm(w.elmList[++w.elmIndex])},movePrev:function(e){e.preventDefault(),w.tabbedElm||w.createFocus(),0===w.elmIndex?w.moveUp(e):w.setTabbedElm(w.elmList[--w.elmIndex])},moveDown:function(e){e.preventDefault(),w.tabbedElm||w.createFocus(),w.tabbedElm.childElementCount&&w.identifyAreas(w.tabbedElm),rspkr.ui.AutoScroll.wait()},moveUp:function(e){e.preventDefault(),w.tabbedElm||w.createFocus(),w.tabbedElm.parentElement&&w.tabbedElm.parentElement.parentElement&&w.tabbedElm!==document.body&&w.tabbedElm.parentElement!==document.body&&(w.identifyAreas(w.tabbedElm.parentElement.parentElement,{elm:w.tabbedElm.parentElement}),rspkr.ui.AutoScroll.wait())},run:function(e){e.preventDefault(),w.tabbedElm&&b(w.tabbedElm)},exit:function(){w.removeEvents()}};return ReadSpeaker.q(function(){n()}),ReadSpeaker.Common.addEvent("onToolsInitialized",function(){n()}),{active:function(){return i},toggle:function(e){(i&&!0!==e?m:r)()},activate:r,deactivate:m}}(),ReadSpeaker.ui.Accessibility=function(){var t,e,r,s,u,h,g,m,n,a=!1,o=(g=!(h="."),{init:function(){if(!rspkr.features.tooltips)return!1;$rs.regEvent(document,"keydown",function(e){e&&9===e.keyCode&&(g=!0,setTimeout(function(){g=!1},100))}),document.body&&document.body.addEventListener("focus",y,!0),document.body&&document.body.addEventListener("blur",b,!0)},hide:b}),i={init:function(){var e,t;rspkr.with.chrome()&&(t=document.getElementsByTagName("html"),s=null!=t[0].getAttribute("hc")),s||((e=document.createElement("div")).style.color="rgb(31, 41, 59)",document.body.appendChild(e),t=(t=(document.defaultView?document.defaultView.getComputedStyle(e,null):e.currentStyle).color).replace(/ /g,""),document.body.removeChild(e),s="rgb(31,41,59)"!==t),rspkr.log("[ReadSpeaker.q] High Contrast Mode = "+s,1),s&&($rs.addClass(document.body,"rs_highcontrast"),ReadSpeaker.q(function(){rspkr.hl.css.setRule("word",".sync_word_highlighted","position: relative;"),rspkr.hl.css.setRule("word",".sync_word_highlighted:before",'content: ""; position: absolute; border: solid 2px '+(rspkr.Common.Settings.get("hlword")||"Red")+"; left: -2px; top: -1px; right: -2px; bottom: -1px;"),rspkr.hl.css.setRule("sent",".sync_sent_highlighted","border-bottom: solid 1px "+(rspkr.Common.Settings.get("hlword")||"Red")+";"),rspkr.hl.css.setRule("word",".enlarge_word_highlighted","position: relative;"),rspkr.hl.css.setRule("word",".enlarge_word_highlighted:before",'content: ""; position: absolute; border: solid 2px '+(rspkr.Common.Settings.get("hlword")||"Red")+"; left: -2px; top: -1px; right: -2px; bottom: -1px;")}),(t=rspkr.pub.Config.getSettingsConf()).highlighting&&t.highlighting.items&&(delete t.highlighting.items.hltext,delete t.highlighting.items.hlword,delete t.highlighting.items.hlsent,delete t.textsettings.items.textstyle))}},l=(t=s=!(m="durl"),{init:function(){document.addEventListener("keyup",d)},escape:r=function(){e.tooltip()||e.wrhelp_toc()||e.settings_infobox()||e.lightbox_submenu()||e.dialog()||e.pagemask()||e.langpicker()||e.popup()||e.dropdown()||e.menu()||e.clicklisten()||e.enlargeHL()||e.playback()||e.player()},escapes:e={wrhelp_toc:function(){var e=document.querySelector("#wrhelp-toc");return!(!e||$rs.hasClass(e,"rs-toc-hidden"))&&(document.querySelector("#wrhelp-toc-toggler").click(),!0)},lightbox_submenu:function(){if(!rspkr.Legacy)return!1;var e=document.querySelector("#rslightbox_toolbar_submenu");return!(!e||!$rs.isVisible(e))&&(rspkr.Legacy&&rspkr.Legacy.Lightbox.ToolbarHelper.closeSubmenus(),!0)},settings_infobox:function(){var e=document.activeElement;if(e&&e.classList.contains("rsform-info-toggle")){var t=e.parentElement.querySelector(".rsform-info-container");if(t&&$rs.isVisible(t))return e.click(),!0}return!1},dialog:function(){var e=rspkr.Dialog&&rspkr.Dialog.getDialog();return!(!e||!$rs.isVisible(e))&&(rspkr.Dialog.close()||c(),!0)},pagemask:function(){return!!rspkr.ui.Tools.PageMask.isActive()&&(rspkr.ui.Tools.PageMask.inactivate(),c(),!0)},langpicker:function(){if(rspkr.Popup.container.langpicker&&$rs.isVisible(rspkr.Popup.container.langpicker.container))return rspkr.Popup.container.langpicker.close(),!0;if(rspkr.ui)for(var e=rspkr.ui.Tools.VoiceSettings&&rspkr.ui.Tools.VoiceSettings.getMenus(),t=0;t<e.length;t++)if(e[t][1].close())return e[t][0].querySelector("button").focus(),!0;return!1},popup:function(){var e=document.querySelector("#rsbtn_popup");return!(!e||!$rs.isVisible(e))&&(rspkr.Popup.closePopup(void 0,!0),c(),!0)},dropdown:function(e){e=e||{};var t,r=rspkr.ui.getActivePlayer(),s=!1;return $rs.arr(".rsbtn_dropdown").forEach(function(e){$rs.isVisible(e)&&r&&(r.closeDropdowns(),s=!0,t=e.querySelector(".rs-slider"))}),!t||!1===e.focus||(e=t.getAttribute("data-toggler"))&&$rs.get(e).focus(),s},menu:function(t){var r=!1;return $rs.arr(".rsbtn_toolpanel").forEach(function(e){e!==t&&$rs.isVisible(e)&&(e=e.parentElement.querySelector(".rsbtn_tooltoggle"),rspkr.tools.close.bind(e)(),e.focus(),r=!0)}),r},clicklisten:function(){return!(!rspkr.ui.Tools.ClickListen||!rspkr.ui.Tools.ClickListen.active())&&(rspkr.ui.Tools.ClickListen.deactivate(),p(),!0)},enlargeHL:function(){return!(!rspkr.HL.enlarge||!rspkr.HL.enlarge.isActive())&&(rspkr.ui.Tools.Enlarge.toggle(),p(),!0)},tooltip:function(){var e=document.querySelector("#readspeaker_tooltip");return!(!e||!$rs.isVisible(e))&&(o.hide(),!0)},playback:function(){var t=!1;rspkr.getRSBtns().forEach(function(e){($rs.hasClass(e,"rsplaying")||$rs.hasClass(e,"rspaused"))&&(rspkr.Common.Player.setStateClass(void 0,{global:!0}),t=!0)});var e=rspkr.ui.getActivePlayer();return e&&e.stop(),c(!0,t),t},player:function(){var e=rspkr.ui.getActivePlayer();return!!e&&(e.close(),c(!0),!0)}},returnPlayerFocus:c,returnTogglerFocus:p,suppress:k,lock:function(){k(!0)},unlock:f});function c(e,t){var r,s=rspkr.ui.getActivePlayer();if(s){var n=s.getContainer();if(n)return void((r=t?n.querySelector(".rsbtn_pause"):n.querySelector(".rsbtn_play"))&&e&&$rs.isWithinViewport(n)&&r.focus())}(n=rspkr.getRSBtns()).length&&$rs.isWithinViewport(n[0])&&(r=n[0].querySelector(".rsbtn_play"))&&r.focus()}function p(){var e=rspkr.getRSBtns();(e=e.length?e[0].querySelector(".rsbtn_tooltoggle"):void 0)&&$rs.isWithinViewport(e)&&e.focus()}function d(e){27===e.which&&(t||r())}function k(e){t=!0,e||setTimeout(f,100)}function f(){t=!1}function y(e){var t;if((e=e||window.event)&&(e.target&&e.target.getAttribute("data-rs-tooltip")?t=e.target:!0===rspkr.item("ui.toolbar.horizontal")&&e.target&&$rs.hasClass(e.target,"rs-contextmenu-item")&&((r=(s=$rs.closest(e.target,'li[class^="rsbtn_tool_"]'))?$rs.findIn(s,"button.rsbtn_tool"):void 0)&&r.getAttribute("data-rs-tooltip")&&(t=r)),g&&t)){var r,s=t.getAttribute("data-rs-tooltip");if(s=s===h?(r=t.querySelector(".rsbtn_btnlabel"))?r.innerText:t.getAttribute("title"):s){u?u.innerHTML=s:u=$rs.createElm("div",{id:"readspeaker_tooltip",cls:"rs_tooltip",attributes:{role:"tooltip","aria-hidden":!0},content:s,parent:document.body}),rspkr.ui.utils.setZIndex(u,!0),u.style.display="block";for(var n,a,o=$rs.offset(t),i=$rs.width(t),l=$rs.height(t),c=$rs.width(u),p=$rs.height(u),d=t.getAttribute("data-rs-direction")?function(e,t){for(var r=(t=t.split("")).length-1;0<=r;r--)0<=e.indexOf(t[r])&&t.splice(r,1);return e.split("").concat(t)}(t.getAttribute("data-rs-direction"),m):m.split("");d.length&&!n;)switch(d.shift()){case"l":if(o.left<c+5)continue;a=o.left-c-5+"px",n=o.top+l/2-p/2+"px";break;case"r":if(o.left+i+c+5>rspkr.ui.viewport.width)continue;a=o.left+i+5+"px",n=o.top+l/2-p/2+"px";break;case"u":if(o.top-$rs.scrollTop(document)<p+10)continue;a=Math.max(o.left+i/2-c/2,10)+"px",n=o.top-p-7+"px";break;default:if(o.top-$rs.scrollTop(document)+l+p+5>rspkr.ui.viewport.height||o.left+i/2-c/2<0)continue;a=o.left+i/2-c/2+"px",n=o.top+l+5+"px"}u.style.left=a,u.style.top=n}}}function b(){u&&(u.style.display="none")}return{dependency:["Common","pub.Config"],init:function(){function e(){a||(a=!0,o.init(),i.init(),l.init(),rspkr.log("[rspkr.ui.Accessibility] Heartbeat!"))}"complete"===document.readyState?e():document.addEventListener("readystatechange",function(){"complete"===document.readyState&&e()})},escape:l.escape,escapes:{menu:l.escapes.menu,langpicker:l.escapes.langpicker,dropdowns:l.escapes.dropdown,suppress:l.suppress,lock:l.lock,unlock:l.unlock},returnPlayerFocus:l.returnPlayerFocus,returnTogglerFocus:l.returnTogglerFocus,ScreenReader:{announce:function(e){(n=n||$rs.createElm("div",{id:"rs-screenreader-message",attributes:{"aria-live":"assertive","aria-atomic":"false"},parent:document.body})).innerHTML=rspkr.Lang.getPhrase(e)}}}}(),ReadSpeaker.q(function(){if(!rspkr.item("general.forceLoadCoreWait")&&!rspkr.item("general.noCookie")){var e=e||rspkr.item("general.cookiePath"),t=t||rspkr.item("general.cookieDomain"),t="_rspkrLoadCore=1"+(e?"; path="+e:"")+(t?"; domain="+t:"");"https:"===document.location.protocol?t+="; SameSite=None; Secure":t+="; SameSite=Lax";try{document.cookie=t}catch(e){return!1}}}),ReadSpeaker.q(function(){var u="1",r=16,h="f",g="r",m="v",k="p",f="t",t="rspkrSettings_";function e(){var e=rspkr.c.data.params,t=function(){var e=b(u,10),t="hlon"===rspkr.st.get("hltoggle"),r=rspkr.st.get("hl");if(t&&-1!==r.indexOf("sent")){for(var s=rspkr.st.get("hlsent"),n=rspkr.cfg.getSettingsConf().highlighting.items.hlsent.options,a=!1,o=0;o<n.length;o++)if(s===n[o].value){a=b(o,10);break}e+=!1!==a?a:b("F",16)}else e+=b("E",16);if(t&&-1!==r.indexOf("word")){for(var i=rspkr.st.get("hlword"),l=rspkr.cfg.getSettingsConf().highlighting.items.hlword.options,a=!1,o=0;o<l.length;o++)if(i===l[o].value){a=b(o,10);break}e+=!1!==a?a:b("F",16)}else e+=b("E",10);if(t&&"none"!==r){for(var c=rspkr.st.get("hltext"),p=rspkr.cfg.getSettingsConf().highlighting.items.hltext.options,a=!1,o=0;o<p.length;o++)if(c===p[o].value){a=b(o,10);break}e+=!1!==a?a:b("F",16)}else e+=b("E",16);r="";r+=y(h)?"1":"0",r+=y(g)?"1":"0",r+=y(m)?"1":"0",r+=y(k)?"1":"0",e+=b(r,2);r="";r+=rspkr.ui.Tools.ClickListen&&rspkr.ui.Tools.ClickListen.active()?"1":"0",r+=y(f)?"1":"0",r+="enlargeon"===rspkr.st.get("enlarge")?"1":"0",r+="scrollon"===rspkr.item("settings.hlscroll")?"1":"0",e+=b(r,2),r="",r+=!0===rspkr.item("general.usePost")?"1":"0",r+=!0===rspkr.item("general.noCookie")?"1":"0",r+=rspkr.DocReader&&rspkr.DocReader.AutoAdd?"1":"0",r+=rspkr.mobile()?"1":"0",e+=b(r,2),r="",r+="default"===rspkr.skin?"1":"0",r+="0";var d="00";switch(rspkr.pl.adapter){case"webAudio":d="01";break;case"html5":d="10"}return e+=b(r+=d,2)}();return rspkr.log("[rspkr] Settings string extracted: "+t,"1"),e.wrc=t,!0}function s(e){return"function"==typeof Storage&&!0!==rspkr.item("general.noCookie")?localStorage.setItem(t+e,1):rspkr.st.set(e,1)}function y(e){return"function"==typeof Storage&&!0!==rspkr.item("general.noCookie")?"1"===localStorage.getItem(t+e):"1"===rspkr.st.get(e)}function n(e){return"function"==typeof Storage?localStorage.removeItem(t+e):rspkr.st.set(e,0)}function b(e,t){t=t||2;return parseInt(e,t).toString(r).toUpperCase()}!1!==rspkr.item("general.sendSettings")&&(rspkr.evt("onAfterParamsSet",e),rspkr.evt("onAPIFastForward",function(){return s(h)}),rspkr.evt("onAPIRewind",function(){return s(g)}),rspkr.evt("onVolumeChanged",function(){return s(m)}),rspkr.evt("onPageMaskClosed",function(){return s(k)}),rspkr.evt("onTextModeLoaded",function(){return s(f)}),rspkr.evt("onBeforeGetAudioLink",function(){n(h),n(g),n(m),n(k),n(f)}))}),window.ReadSpeaker.Mobile||(window.ReadSpeaker.Mobile={}),window.ReadSpeaker.Mobile.Common=function(){function e(){rspkr.item("customSettings")&&rspkr.cfg.mergeObj(rspkr.item("customSettings"),rspkr.cfg.getSettingsConf())}function t(){var e=$rs.get("#rslightbox_contentcontainer #rscontrol_langvoice select");rspkr.c.sorting.sortArrayByObjKey(e.options,"text")}function r(){var e;!rspkr.ui||rspkr.ui.getActivePlayer()||"1"!==rspkr.c.cookie.read("_rspkrLoadCore")||"1"!==rspkr.st.get("openmobile")||(e=rspkr.getRSBtns()).length&&(e=e[0],$rs.addClass(e,"rs_mobile"),"string"==typeof(e=$rs.findIn(e,".rsbtn_play").href)&&e.length&&window.readpage(e,null,{preventPlay:!0,noPrevPlay:!0}))}function s(){ReadSpeaker.ds.unload(),"html5"===rspkr.pl.adapter&&rspkr.item("general.usePost",!0)}var n=['<div class="rsmpl-tools">','\t<div class="rsmpl-collapse rsmpl-tool"><button type="button" title="[[ph_collapse]]" aria-expanded="true" aria-controls="rsmpl_container"><span class="rsicn rsicn-slide-right" aria-hidden="true"></span> <span class="rsbtn_btnlabel">[[ph_menu]]</span></button></div>','\t<div class="rsmpl-settings rsmpl-tool"><button type="button" title="[[ph_settings]]" class="rsbtn_tool" data-rs-tool="settings"><span class="rsicn rsicn-settings" aria-hidden="true"></span> <span class="rsbtn_btnlabel">[[ph_settings]]</span></button></div>','\t<div class="rsmpl-pagemask rsmpl-tool"><button type="button" title="[[ph_pagemask]]"><span class="rsicn rsicn-pagemask" aria-hidden="true"></span> <span class="rsbtn_btnlabel">[[ph_pagemask]]</span></button></div>','\t<div class="rsmpl-dictionary rsmpl-tool"><button type="button" title="[[ph_dictionary]]"><span class="rsicn rsicn-dictionary" aria-hidden="true"></span> <span class="rsbtn_btnlabel">[[ph_dictionary]]</span></button></div>','\t<div class="rsmpl-clicklisten rsmpl-tool"><button type="button" title="[[ph_clicklisten]]"><span class="rsicn rsicn-click-listen" aria-hidden="true"></span> <span class="rsbtn_btnlabel">[[ph_clicklisten]]</span></button></div>','\t<div class="rsmpl-dl rsmpl-tool"><button type="button" title="[[ph_download]]"><span class="rsicn rsicn-download" aria-hidden="true"></span> <span class="rsbtn_btnlabel">[[ph_download]]</span></button></div>','\t<div class="rsmpl-player rsmpl-tool">','\t\t<div class="rsmpl-playpause rsmpl-player-tool"><button type="button" title="[[ph_play]]"><span class="rsicn rsicn-pause" aria-hidden="true"></span> <span class="rsbtn_btnlabel">[[ph_play]]</span></button></div>','\t\t<div class="rsmpl-stop rsmpl-player-tool"><button type="button" title="[[ph_stop]]"><span class="rsicn rsicn-stop" aria-hidden="true"></span> <span class="rsbtn_btnlabel">[[ph_stop]]</span></button></div>',"\t</div>",'\t<div class="rsmpl-closer rsmpl-tool"><button type="button" title="[[ph_close]]"><span class="rsicn rsicn-cross" aria-hidden="true"></span> <span class="rsbtn_btnlabel">[[ph_close]]</span></button></div>',"</div>"],a={audio:null,timer:void 0,start:function(){"webAudio"===rspkr.pl.adapter&&(a.audio&&!a.audio.paused||(a.audio||(a.audio=document.createElement("audio"),a.audio.type="audio/mpeg",a.audio.pause(),a.audio.src=rspkr.baseUrl+rspkr.revPath+"media/silence.mp3"),a.prolong()))},prolong:function(){var e;a.audio&&(a.audio.pause(),void(a.audio.currentTime=0)!==(e=a.audio.play())&&e.then(function(){}).catch(function(){}),a.timer=setTimeout(a.prolong,9500))},stop:function(){a.audio&&!a.audio.paused&&(clearTimeout(a.timer),a.timer=void 0,a.audio.pause())}};return{bypassMute:a,getMarkup:function(e){e=e||rspkr.item("ui.mobilePlayer")||n;return $rs.isArray(e)&&(e=e.join("\n")),e=rspkr.ui.utils.populatePhrases(e)},init:function(){rspkr.Common.addEvent("onBeforeSettingsOpened",e),rspkr.Common.addEvent("onSettingsLoaded",t),rspkr.Common.addEvent("onAfterModsLoaded",s),rspkr.Common.addEvent("onReady",r),rspkr.q(function(){!1!==rspkr.conf("mobile.ignoreMute")&&(rspkr.with.iphone()||rspkr.with.ipad())&&(rspkr.Common.addEvent("onAPIPlay",a.start),rspkr.Common.addEvent("onAPIPause",a.stop),rspkr.Common.addEvent("onAPIStop",a.stop))})},meta:{revision:"2489"}}}(),ReadSpeaker.Mobile||(ReadSpeaker.Mobile={}),ReadSpeaker.Mobile.ui||(ReadSpeaker.Mobile.ui={}),window.ReadSpeaker.Mobile.ui.Player=function(e){function t(){return console.log("Not implemented:"),console.trace(),!1}var a,r=e,s=!1,n=(rspkr.getID(),null),o=this,i=!1,l="",c=!1,p=null,d=null,u=0,h=!1,g=null,m=!1,k=function(){return a.querySelector(".rsmpl-playpause button")},f=function(){return a.querySelector(".rsmpl-stop button")},y=function(){return a.querySelector(".rsmpl-collapse button")},b=function(){return a.querySelector(".rsmpl-closer button")},v=function(){return a.querySelector(".rsmpl-pagemask button")},C=function(){return a.querySelector(".rsmpl-dictionary button")},A=function(){return a.querySelector(".rsmpl-dl button")},w=function(){return a.querySelector(".rsmpl-clicklisten button")},S={reinit:function(){rspkr.pl.getProgress.apply(rspkr.pl,[!0,S.updateProgress,o])},play:function(e){rspkr.ui.LoadIndicator.show({player:P()}),!d&&p&&(d=p),e=e||"fullpage";var t=!(m=!0);"webAudio"===rspkr.pl.adapter&&(t=("fullpage"===e||"dialog"===e)&&g===e&&rspkr.pl.audio.state.current!==rspkr.pl.audio.states.notStarted),g=e,rspkr.c.dispatchEvent("onUIBeforePlay"),$rs.addClass(a,"running"),rspkr.Common.Player.setStateClass("rsplaying"),f()&&f().removeAttribute("disabled"),S.togglePlayPause(!1),c&&((p=p||d)||d)&&(rspkr.c.data.selectedText="",rspkr.c.data.selectedHTML=p.outerHTML,p=null),rspkr.ui.getActivePlayerElm()===L()?("webAudio"!==rspkr.pl.adapter&&!0!==rspkr.item("general.noLazyLoad")&&!0!==rspkr.params.noLazyLoad&&h?(rspkr.createAudio(),h=!1,E.lazyLoad.readNodeList(rspkr.c.data.getDefaultReadElements())):rspkr.pl.play(t,e),i&&rspkr.pl.getProgress.apply(rspkr.pl,[!0,S.updateProgress,o]),rspkr.c.addEvent("onBeforeSyncInit",function(){i=!0,rspkr.pl.getProgress.apply(rspkr.pl,[!0,S.updateProgress,o])}),rspkr.c.dispatchEvent("onUIAfterPlay"),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.PLAY,a),x.playbar.expand()):(rspkr.ui.getActivePlayer()&&rspkr.ui.getActivePlayer().close(!0),e=$rs.findIn(L(),".rsbtn_play"),window.readpage(e))},restart:function(){rspkr.pl.restart(),x.show()},pause:function(e){rspkr.Common.Player.setStateClass("rspaused"),S.togglePlayPause(!0),rspkr.pl.pause(),rspkr.pl.getProgress(!1),m=!m,e||(rspkr.c.dispatchEvent("onUIPause"),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.PAUSE,a),rspkr.log("ReadSpeaker.ui.pause"))},stop:function(e){var t=a&&"rsmpl_container"===a.id;t&&(rspkr.Common.Player.setStateClass("rsstopped"),$rs.setAttr(f(),"disabled"),S.togglePlayPause(!0),rspkr.pl.getProgress(!1),rspkr.ui.LoadIndicator.update({player:P(),progress:[0]})),S.reset(),rspkr.pl.stop(),rspkr.c.dispatchEvent("onUIStop",a),"html5"===rspkr.pl.adapter&&E.lazyLoad.sentenceIndex<E.lazyLoad.sentList.length&&e&&!0===e.rshlexit||(m=!1),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.STOP,a),!rspkr.item("ui.preventPlaybackFocus")&&t&&k()&&k().focus(),1<rspkr.HL.chunking.currentChunkNumber&&(rspkr.HL.chunking.destroy(),rspkr.pl.hasOwnProperty("releaseAdapter")&&rspkr.pl.releaseAdapter())},cleanUp:function(){var e=E.region.prevNode;rspkr.hl.engine.useTextNodeMarkup?rspkr.hl.clean():(s=e.getElementsByTagName("rs:span"),Array.from(s).forEach(function(e){var t;e.parentElement&&(e=(t=e.parentElement).textContent,t.childNodes.forEach(function(e){t.removeChild(e)}),t.innerHTML=e)}));for(var t=0;t<e.classList.length;t++){var r=e.classList[t];r===E.region.tempReadClass&&e.classList.remove(r)}var s=$rs.get(rspkr.rsbtnClass(!0));(s=$rs.isArray(s)&&s.length?s[0]:s)&&void 0!==rspkr.Common.data.getDefaultReadElements()&&0===rspkr.Common.data.getDefaultReadElements().length&&(s=$rs.getAttr($rs.findIn(s,".rsbtn_play"),"href"),rspkr.c.data.setParams(s)),rspkr.Common.data.selectedHTML="",rspkr.Common.data.selectedText="",rspkr.Common.data.selectedRange=""},reset:function(){p=null,$rs.removeClass(a,"rsloading")},close:function(e){rspkr.HL.chunking.destroy(),e||rspkr.api.callback.execute(rspkr.api.callback.enums.UI.BEFORECLOSE,a),rspkr.pl.getProgress(!1),rspkr.pl.releaseAdapter(),m&&rspkr.devt("onAPIStop"),m=!1,x.hide(),S.dictionary.stopCapture(),u=0,e||(rspkr.c.dispatchEvent("onUIClosePlayer",a,["userclick"]),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.CLOSE,a)),g=null},togglePlayPause:function(e){k()&&(e=rspkr.Lang.getPhrase(e?"play":"pause"),$rs.setAttr(k(),"title",rspkr.c.decodeEntities(e)),$rs.findIn(k(),".rsbtn_btnlabel").innerHTML=e)},updateProgress:function(e){var t,r,s;e.length&&(t=parseInt(e[0]),s=0===(r=parseInt(e[1]))?0:Math.round(t/r*100),isNaN(t)||rspkr.ui.LoadIndicator.update({player:P(),progress:e}),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.PROGRESSCHANGED,P(),[s]),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.TIMEUPDATED,P(),[rspkr.Util.convertTime(t),rspkr.Util.convertTime(r)]))},resetProgress:function(){rspkr.ui.LoadIndicator.update({player:P(),progress:[0]})},dropSpeed:function(){var e,t=rspkr.ui.getActivePlayer();t&&"rs-dialog-player"!==t.id&&(e=(e=t.getContainer()).querySelector(".rsbtn_play")?e.querySelector(".rsbtn_play").href:rspkr.findHref(),t.close(),window.readpage(e,void 0,{preventPlay:!0}),rspkr.Common.Player.setStateClass("rsidle"),rspkr.HL.clean())},dictionary:{capture:function(){var e,t=window.getSelection();!t.isCollapsed&&t.toString().length&&(e=3===(e=rspkr.c.data.selectedRange).commonAncestorContainer.nodeType?e.commonAncestorContainer.parentElement:e.commonAncestorContainer,rspkr.c.data.cleanSecretContent(e.outerHTML)!==e.outerHTML||e.closest(rspkr.selector.secret)?rspkr.c.data.clearSelectedText():l=t.toString())},startCapture:function(){$rs.regEvent(document,"selectionchange",S.dictionary.capture)},stopCapture:function(){$rs.unregEvent(document,"selectionchange",S.dictionary.capture)},dictionary:function(){S.stop();var e=$rs.findIn(L(),"a.rsbtn_play"),t=e&&e.href?e.href:rspkr.findHref(),e=l;t&&"string"==typeof t&&t.length&&(t=rspkr.getParam("lang",t),rspkr.ui.LoadIndicator.show(),rspkr.ui.Tools.Dictionary.dictionary(t,e),l="")}},pageMask:{open:function(e){rspkr.ui.Tools.PageMask.start("mask",e)},close:function(){}},dl:function(){$rs.removeClass(a,"running");function t(t){if(/ios/i.test(rspkr.c.data.browser.OS)){var e=$rs.createElm("a",{attributes:{href:r,target:"_blank",style:"position:absolute;left:10000px;"},content:".",parent:document.body});return e.click(),e.parentElement.removeChild(e),1}if(rspkr.preventDefault(t),t=null,document.getElementById("dliframe"))t=document.getElementById("dliframe");else{if(document.selection)try{t=document.createElement('<iframe name="dliframe">')}catch(e){t=document.createElement("iframe")}else t=document.createElement("iframe");$rs.setAttr(t,"name","dliframe"),$rs.setAttr(t,"id","dliframe"),rspkr.with.explorer()||$rs.setAttr(t,"sandbox","allow-same-origin allow-scripts allow-downloads"),$rs.css(t,"display","none"),$rs.css(t,"position","absolute"),document.body.appendChild(t)}return $rs.setAttr(t,"src",r),0}var e=$rs.getAttr($rs.findIn(L(),".rsbtn_play"),"href"),r=e?rspkr.c.data.getSaveData("dialog",e,!0):rspkr.c.data.getSaveData("dialog",!1,!0),s=/ios/i.test(rspkr.c.data.browser.OS);$rs.hasClass(a,"rsstopped")||$rs.hasClass(a,"rsidle")||(S.stop(),rspkr.pl.releaseAdapter(),rspkr.audio=null,$rs.removeClass(a,"rsloading")),rspkr.item("general.directDownload")?(t(),rspkr.api.callback.execute(rspkr.api.callback.enums.AUDIO.DOWNLOAD,rspkr.ui.getActivePlayerElm())):rspkr.Dialog.open({icon:"download",titleKey:"download",content:rspkr.item("ui.dldialog").join("\n"),lbButtons:S.getDlButtons(s,r),buttons:{close:!1,cancel:!0,save:{nameKey:"touaccept",icon:"download",nodeType:"a",attributes:{href:r,target:"_blank"},preventDefault:!1,callback:function(e){rspkr.Dialog.close(e,s),t(e),rspkr.api.callback.execute(rspkr.api.callback.enums.AUDIO.DOWNLOAD,rspkr.ui.getActivePlayerElm())}}},forceReload:!0,cssDimensions:!0,mode:"download"})},getDlButtons:function(e,t){var r,s=rspkr.item("ui.dlbuttons").join("\n");return e&&t&&((r=document.createElement("div")).innerHTML=s,(e=$rs.findIn(r,"#rsdl_button_accept"))&&(e.href=t,$rs.setAttr(e,"target","_blank"),$rs.setAttr(e,"download",""),s=r.innerHTML)),s},nosound:function(){var e=rspkr.c.data.getSaveData("link");return $rs.setAttr(S.nosound(),"href",e),!0}},E={lazyLoad:{isLazyLoad:!1,containerList:[],sentList:[],containerIndex:0,sentenceIndex:0,readNodeList:function(e){$rs.isArray(e)||(e=[e]),rspkr.pl.html5.adapter.releaseAdapter(),c=!(u=0),E.lazyLoad.isLazyLoad=!0,E.lazyLoad.containerList=e,E.lazyLoad.containerIndex=0,E.lazyLoad.advanceContainer(E.lazyLoad.containerList)},startRecursion:function(e,t){if(!(e.isElement(t)&&e.notInToolbar(t)&&e.notInPlayer(t)))return!1;for(;!e.isBlockElement(t)||e.isSyncElement(t);)t=t.parentNode;t.id||(t.id=rspkr.getID());var r=t,s=!1,n=r.parentNode||null;if(!e.isBlockElement(n))for(;!e.isBlockElement(n)||e.isSyncElement(n);)n=n.parentNode;c=!0,E.lazyLoad.containerList=[],rspkr.c.clearEvent("onAfterSyncInit",E.utils.removeOutline),rspkr.evt("onAfterSyncInit",E.utils.removeOutline);for(var a,o=0,i=(a=n.children).length;o<i;o++)a[o]!==r&&!0!==s||(s=!0,E.lazyLoad.containerList.push(a[o]));E.lazyLoad.containerList=E.lazyLoad.containerList||[r],m=!0,E.lazyLoad.containerIndex=0,E.lazyLoad.advanceContainer(E.lazyLoad.containerList)},onBeforeSyncExit:function(){rspkr.hl.html5.handlers.release(),rspkr.item("general.postSettings.useExistingMarkup",!1),E.lazyLoad.sentenceIndex>=E.lazyLoad.sentList.length?(rspkr.devt("onSectionRead",window),rspkr.api.callback.execute(rspkr.api.callback.enums.AUDIO.ENDED,rspkr.ui.getActivePlayerElm())):m&&E.lazyLoad.advanceSentence(E.lazyLoad.sentList)},advanceContainer:function(e){if(E.lazyLoad.containerIndex>=e.length)return rspkr.devt("onLazyLoadFinished",window),u=0,E.lazyLoad.isLazyLoad=!1,void $rs.removeClass(a,"running");$rs.addClass(a,"running");e=e[E.lazyLoad.containerIndex++];rspkr.hl.clean(),rspkr.hl.engine.gecko.clientExtension.preProcess.addMarkup(e,!0),E.lazyLoad.sentList=$rs.findIn(e,".sync_user.sync_sent, img"),$rs.isArray(E.lazyLoad.sentList)||(E.lazyLoad.sentList=[E.lazyLoad.sentList]),E.lazyLoad.sentList.length&&(rspkr.c.clearEvent("onBeforeSyncExit",E.lazyLoad.onBeforeSyncExit),rspkr.evt("onBeforeSyncExit",E.lazyLoad.onBeforeSyncExit),E.lazyLoad.sentenceIndex=0,E.lazyLoad.advanceSentence(E.lazyLoad.sentList))},containsText:function(e){return!!e.textContent.trim().length||!!(e.getAttribute("alt")&&e.getAttribute("alt").trim().length||e.getAttribute("title")&&e.getAttribute("title").trim().length)},advanceSentence:function(e){p=e[E.lazyLoad.sentenceIndex++],$rs.hasClass(a,"running")&&E.lazyLoad.containsText(p)&&E.utils.filters.notInPlayer(p)?(rspkr.item("general.postSettings.useExistingMarkup",!0),u++,e={},p.textContent.trim().length<1e3&&(e.nocache="1"),1<u&&(e.stattype="rs_none"),Object.size(e)&&(rspkr.c.data.tempParams=e),window.readpage(n,null,{noCleanUp:!0,isClick:u<2,disableCallbacks:u<2})):rspkr.devt("onBeforeSyncExit",window)}},utils:{filters:{isElement:function(e){return e&&e.nodeType&&1===e.nodeType},hasText:function(e){if(e.hasChildNodes())for(var t=0,r=e.childNodes.length;t<r;t++){if(e.childNodes[t].nodeType&&3===e.childNodes[t].nodeType&&(e.childNodes[t].innerText||e.childNodes[t].textContent).replace(/^\s+|\s+$/g,"").length)return!0;if(e.childNodes[t].nodeType&&1===e.childNodes[t].nodeType)return E.utils.filters.hasText(e.childNodes[t])}},isBlockElement:function(e){return/^(article|blockquote|body|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h[1-6]|header|hgroup|li|main|nav|ol|output|p|pre|section|table|tfoot|ul)$/i.test(e.tagName)},notInToolbar:function(e){return void 0===$rs.closest(e,"#rsmpl_container")},notInPlayer:function(e){return void 0===$rs.closest(e,rspkr.rsbtnClass(!0))},isSyncElement:function(e){return e.nodeName.toLowerCase()===rspkr.br.info.syncContainer.toLowerCase()&&($rs.hasClass(e,"sync_sent")||$rs.hasClass(e,"sync_word")||$rs.hasClass(e,"sync_user")||$rs.hasClass(e,"synctemp"))}}}},x={positionToolbar:function(e){var t=/top/i.test(e)?"top":"bottom",r=-1<e.indexOf("=")?e.match(/=([0-9]*)/)[1]:40,s="top"==t?"bottom":"top",e={};isNaN(r)||(e[t]=r+"px",e[s]="auto",$rs.css(a,e))},show:function(e,t){t=t||{},rspkr.ui.Overlay.hide(),"dialog"!==t.source?(a=void 0===$rs.get("#rsmpl_container").id?x.injectMarkup():$rs.get("#rsmpl_container"),rspkr.ui.LoadIndicator.show({player:a,idle:!0}),w()&&rspkr.ui.Tools.ClickListen.active()&&w().parentElement.classList.add("active"),a.id=a.id||rspkr.getID(),rspkr.item("ui.mobileVertPos")&&rspkr.item("ui.mobileVertPos").length&&x.positionToolbar(rspkr.item("ui.mobileVertPos")),window.setTimeout(function(){$rs.addClass(a,"rs_visible")},0),s||a.dataset.initialized||(s=!0,a.dataset.initialized=!0,$rs.unregEvent($rs.findIn(a,"button:not(.rsbtn_tool)"),"click"),k()&&$rs.regEvent(k(),"click",function(e){rspkr.preventDefault(e),$rs.hasClass(a,"rsplaying")?S.pause():($rs.hasClass(a,"rsidle")||$rs.hasClass(a,"rsstopped")||$rs.hasClass(a,"rspaused"))&&S.play()}),f()&&$rs.regEvent(f(),"click",function(e){rspkr.preventDefault(e),u=0,S.stop()}),y()&&$rs.regEvent(y(),"click",function(e){rspkr.preventDefault(e),x.playbar.toggleCollapse()}),b()&&$rs.regEvent(b(),"click",function(e){rspkr.preventDefault(e),S.close()}),v()&&$rs.regEvent(v(),"click",function(e){rspkr.preventDefault(e),S.pageMask.open(e)}),C()&&$rs.regEvent(C(),"click",function(e){rspkr.preventDefault(e),S.dictionary.dictionary.apply(this,[e])}),w()&&w().addEventListener("click",function(e){rspkr.preventDefault(e);e=$rs.get("#rsmpl_container .rsmpl-clicklisten");$rs.hasClass(e,"active")?($rs.removeClass(e,"active"),rspkr.ui.Tools.ClickListen.deactivate()):($rs.addClass(e,"active"),rspkr.ui.Tools.ClickListen.activate())}),A()&&(!1===rspkr.item("ui.tools.download")&&A()&&!$rs.isArray(A())?A()&&A().parentNode.removeChild(A()):$rs.regEvent(A(),"click",function(e){rspkr.preventDefault(e),S.dl.apply(this,[e])})),!0!==t.disableCallbacks&&rspkr.api.callback.execute(rspkr.api.callback.enums.UI.OPEN,a),rspkr.devt("onBeforeToolsOpen","__self__",[a])),rspkr.st.set("openmobile","1"),S.dictionary.startCapture(),rspkr.item("ui.preventPlaybackFocus")||$rs.focus(k()),"1"===rspkr.st.get("playbarCollapse")&&x.playbar.collapse()):a=$rs.get("rs-dialog-player"),!0===t.usePost?(rspkr.runtime.revertGET||rspkr.item("general.usePost")||(rspkr.runtime.revertGET=!0),rspkr.item("general.usePost",!0)):(rspkr.runtime.revertGET&&rspkr.item("general.usePost",!1),delete rspkr.runtime.revertGET),!0===t.preventPlay?a.classList.contains("rsplaying")||(rspkr.Common.Player.setStateClass("rsidle"),!0===t.noPrevPlay&&(h=!0)):(h=!1,"webAudio"===rspkr.pl.adapter||!0===rspkr.item("general.noLazyLoad")||!0===rspkr.params.noLazyLoad&&!1!==rspkr.item("general.noLazyLoad")||0<u||"dialog"===t.source?S.play(t.source||void 0):(t=rspkr.c.data.getDefaultReadElements()).length?E.lazyLoad.readNodeList(t):rspkr.pl.play())},hide:function(){rspkr.Common.Player.setStateClass("rsidle"),$rs.removeClass(a,"rs_visible running"),S.resetProgress(),S.togglePlayPause(!0),x.playbar.expand(),rspkr.st.set("openmobile","0")},injectMarkup:function(){var e=document.createElement("div");e.id="rsmpl_container",rspkr.ui.utils.setZIndex(e,!0),e.innerHTML=rspkr.Mobile.Common.getMarkup();var t,r,s={settings:"settings",pagemask:"pagemask",dictionary:"dictionary"};for(r in s)(!1===rspkr.features[s[r]]||rspkr.notools()||rspkr.nofeatures())&&(t=$rs.findIn(e,".rsmpl-"+s[r]))&&t.parentNode&&t.parentNode.removeChild(t);return document.body.appendChild(e),e},playbar:{toggleCollapse:function(){$rs.hasClass(a,"rs_collapsed")?x.playbar.expand():x.playbar.collapse()},collapse:function(){$rs.addClass(a,"rs_collapsed");var e=$rs.findIn(a,".rsmpl-collapse"),t=$rs.outerWidth(a),r=$rs.outerWidth(e);$rs.css(a,"right","-"+(t-r)+"px");for(var s=$rs.findIn(a,".rsmpl-tool"),n=0;n<s.length;n++)$rs.hasClass(s[n],"rsmpl-collapse")||($rs.setAttr(s[n],"aria-hidden",!0),$rs.setAttr($rs.findIn(s[n],"button"),"aria-hidden",!0));$rs.setAttr($rs.findIn(e,"button"),"title",rspkr.Lang.getPhrase("expand")),$rs.setAttr($rs.findIn(e,"button"),"aria-expanded",!1),rspkr.st.set("playbarCollapse","1")},expand:function(){$rs.removeClass(a,"rs_collapsed"),a.style.removeProperty("right");for(var e=$rs.findIn(a,".rsmpl-tool"),t=0;t<e.length;t++)$rs.hasClass(e[t],"rsmpl-collapse")||($rs.setAttr(e[t],"aria-hidden",!1),$rs.setAttr($rs.findIn(e[t],"button"),"aria-hidden",!1));var r=$rs.findIn(a,".rsmpl-collapse");$rs.setAttr($rs.findIn(r,"button"),"title",rspkr.Lang.getPhrase("collapse")),$rs.setAttr($rs.findIn(r,"button"),"aria-expanded",!0),rspkr.st.set("playbarCollapse","0")}}},P=function(){return $rs.get("#rsmpl_container")},L=function(){return r};return{init:function(){rspkr.evt("onSpeedChanged",S.dropSpeed,!0),rspkr.evt("onVoiceChanged",S.emptyPlayer,!0)},initVolume:t,show:x.show,close:S.close,stop:S.stop,reinit:S.reinit,nosound:t,pause:S.pause,play:S.play,dl:S.dl,vol:t,restart:S.restart,updateProgress:t,setProgress:function(){},getMobileContainer:P,getContainer:L,getID:function(){return L()},getWidth:t,setHref:function(e){n=e},getHref:function(){return n},pb:E,prevClickSource:function(){return g}}},ReadSpeaker.PlayerAPI.html5={init:function(){ReadSpeaker.log("PlayerAPI.html5 heartbeat!")},adapter:{adapter:"html5",playerRef:null,timerCallBack:null,timerContext:null,bufferedTime:null,play:function(){ReadSpeaker.log("[rspkr.pl.play]"),rspkr.HL.chunking.close(),rspkr.HL.chunking.chunkEnded?(rspkr.HL.chunking.chunkEnded=!1,rspkr.devt("onChunkResume",window)):rspkr.pl.playerRef?(rspkr.pl.playPromise(rspkr.pl.playerRef),rspkr.devt("onAPIPlay",window)):this.initAdapter()},mobilePause:function(e){rspkr.pl.playbackStarted||e.pause()},playPromise:function(r,s,t,n){var e=r.play();void 0!==e?e.then(function(){n?rspkr.pl.mobilePause(r):rspkr.pl.playbackStarted=!0,n||(r.muted=!1);var e=rspkr.ui.getActivePlayer(),t=e?rspkr.mobile()?e.getMobileContainer():e.getContainer():void 0;e&&t&&($rs.hasClass(t,"rspaused")?(e.pause(),$rs.removeClass($rs.findIn(t,".rsbtn_progress_container"),"rsloading")):$rs.hasClass(t,"rsstopped")?e.stop():$rs.hasClass(t,"rsexpanded")||rspkr.mobile()&&$rs.hasClass($rs.get("#rsmpl_container"),"rs_visible")||e.close(!0)),s&&"function"==typeof s&&(n?rspkr.pl.mobilePause(r):rspkr.pl.playbackStarted=!0,s.call())}).catch(function(e){rspkr.error("PlayPromise error: "+e),t&&"function"==typeof t&&t.call(e)}):"function"==typeof s&&s.call()},pause:function(){rspkr.pl.playerRef&&(rspkr.pl.playerRef.pause(),rspkr.devt("onAPIPause",window))},stop:function(){rspkr.pl.playerRef&&(rspkr.pl.playerRef.pause(),0<rspkr.pl.playerRef.readyState&&(rspkr.pl.playerRef.currentTime=0),rspkr.devt("onAPIStop",window))},restart:function(){rspkr.pl.playerRef&&(rspkr.pl.playerRef.pause(),rspkr.pl.playerRef.currentTime=0,rspkr.hl.html5.handlers.restart(),rspkr.hl.html5.States.setState(rspkr.hl.html5.States.USER_START_PLAYING),rspkr.pl.playerRef.play(),rspkr.hl.html5.refresh())},volUp:function(){rspkr.pl.playerRef&&(rspkr.pl.playerRef.volume=Math.min(1,rspkr.pl.playerRef.volume+.2),rspkr.st.set("hlvol",100*rspkr.pl.playerRef.volume),rspkr.devt("onAPIVolumeUp",window))},volDown:function(){rspkr.pl.playerRef&&(rspkr.pl.playerRef.volume=Math.max(0,rspkr.pl.playerRef.volume-.2),rspkr.st.set("hlvol",100*rspkr.pl.playerRef.volume),rspkr.devt("onAPIVolumeDown",window))},mute:function(){rspkr.pl.playerRef&&(rspkr.pl.playerRef.volume=0,rspkr.devt("onAPIMute",window))},forward:function(){var e;rspkr.pl.playerRef&&(e=parseInt(rspkr.item("general.skipIntervalSec"))||5,rspkr.pl.playerRef.currentTime+e<rspkr.pl.playerRef.duration?rspkr.pl.playerRef.currentTime+=e:rspkr.pl.playerRef.currentTime=rspkr.pl.playerRef.duration,rspkr.devt("onAPIFastForward",window),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.PROGRESSCHANGED,rspkr.ui.getActivePlayerElm(),[rspkr.pl.playerRef.currentTime/rspkr.pl.playerRef.duration*100]),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.TIMEUPDATED,rspkr.ui.getActivePlayerElm(),[rspkr.Util.convertTime(rspkr.pl.playerRef.currentTime),rspkr.Util.convertTime(rspkr.pl.playerRef.duration)]))},rewind:function(){var e;rspkr.pl.playerRef&&(e=parseInt(rspkr.item("general.skipIntervalSec"))||5,0<rspkr.pl.playerRef.currentTime-e?rspkr.pl.playerRef.currentTime-=e:rspkr.pl.playerRef.currentTime=0,rspkr.devt("onAPIRewind",window),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.PROGRESSCHANGED,rspkr.ui.getActivePlayerElm(),[rspkr.pl.playerRef.currentTime/rspkr.pl.playerRef.duration*100]),rspkr.api.callback.execute(rspkr.api.callback.enums.UI.TIMEUPDATED,rspkr.ui.getActivePlayerElm(),[rspkr.Util.convertTime(rspkr.pl.playerRef.currentTime),rspkr.Util.convertTime(rspkr.pl.playerRef.duration)]))},setVolume:function(e){rspkr.log("[setVolume] "+e,4),rspkr.pl.playerRef&&(rspkr.pl.playerRef.volume=parseFloat(e/200),rspkr.devt("onVolumeChanged",window))},setProgress:function(e){rspkr.pl.playerRef&&!isNaN(rspkr.pl.playerRef.duration)&&((e=parseInt(e))<parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime())&&e<rspkr.pl.playerRef.duration?rspkr.pl.playerRef.currentTime=e:rspkr.pl.playerRef.currentTime=rspkr.pl.playerRef.duration,rspkr.HL&&rspkr.HL.html5&&rspkr.HL.html5.lastcurrenttime&&(rspkr.HL.html5.lastcurrenttime=0),rspkr.devt("onAPISetProgress",window))},getProgress:function(e,t,r){rspkr.pl.playerRef&&(!1!==e?(this.timerCallBack=t,this.timerContext=r||t,rspkr.pl.playerRef.addEventListener("timeupdate",rspkr.pl.timer,!1),rspkr.devt("onAPIGetProgress",window)):rspkr.pl.playerRef.removeEventListener("timeupdate",rspkr.pl.timer,!1))},timer:function(){if(rspkr.pl.playerRef){var e=rspkr.pl.playerRef,t=1e3*parseInt(e.currentTime);rspkr.pl.bufferedTime=1e3*parseInt(ReadSpeaker.PlayerAPI.getProduct().html5.handlers.totalTime());var r=[t,rspkr.pl.bufferedTime];if(rspkr.hl.html5&&rspkr.hl.html5.synclist&&rspkr.hl.html5.synclist[rspkr.hl.html5.synclist.length-1]&&(e=rspkr.hl.html5.synclist[rspkr.hl.html5.synclist.length-1][0],rspkr.pl.bufferedTime>e&&(r=[t,e])),"function"==typeof rspkr.pl.timerCallBack)try{rspkr.pl.timerCallBack.apply(rspkr.pl.timerContext,[r])}catch(e){rspkr.error("timeupdate error")}}},checkNetworkStatus:function(){var r=rspkr.pl.playerRef;rspkr.pl.errorCount=rspkr.pl.errorCount||0,rspkr.pl.networkStates=rspkr.pl.networkStates||[0,0,0,0],setTimeout(function(){var e,t;r&&(rspkr.pl.networkStates[r.networkState]++,rspkr.pl.networkStates[4]=!!(r.buffered&&r.buffered.length&&0<r.buffered.end(0))&&r.buffered.end(0),rspkr.pl.networkStates[5]=!!(r.duration&&r.duration&&!isNaN(r.duration)&&0<r.duration)&&r.duration,3===r.networkState?(rspkr.pl.errorCount++,10<rspkr.pl.errorCount&&!rspkr.pl.networkStates[4]&&!rspkr.pl.networkStates[5]?(rspkr.error("[rspkr.pl] Cannot load audio!"),rspkr.ui.Overlay.show({player:rspkr.ui.getActivePlayer(),message:"loaderror"}),rspkr.devt("onAudioLoadError",window),rspkr.api.callback.execute(rspkr.api.callback.enums.AUDIO.LOADERROR,rspkr.ui.getActivePlayerElm())):rspkr.pl.checkNetworkStatus()):2===r.networkState?(rspkr.pl.errorCount=0,e=r.buffered.length?r.buffered.end(r.buffered.length-1):0,(0===(t=r.duration||0)||e<t)&&rspkr.pl.checkNetworkStatus()):rspkr.pl.errorCount=0,rspkr.log(rspkr.pl.networkStates,5))},rspkr.item("general.audioTimeout")||750)},initAdapter:function(){rspkr.devt("onAPIInitAdapter",window)},releaseAdapter:function(){if(rspkr.pl.playerRef){rspkr.pl.playerRef.pause();try{0<rspkr.pl.playerRef.readyState&&(rspkr.pl.playerRef.currentTime=0)}catch(e){}rspkr.pl.playerRef=null,rspkr.devt("onAPIReleaseAdapter",window)}},setEvents:function(){rspkr.evt("onAPIInitAdapter",rspkr.HL.html5.handlers.init),rspkr.evt("onAPIPlay",rspkr.HL.html5.handlers.play),rspkr.evt("onAPIPause",rspkr.HL.html5.handlers.pause),rspkr.evt("onAPIStop",rspkr.HL.html5.handlers.stop),rspkr.evt("onAPIRewind",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPISetProgress",rspkr.HL.html5.handlers.updateTime),rspkr.evt("onAPIReleaseAdapter",rspkr.HL.html5.handlers.release)}}},ReadSpeaker.math=function(){function r(){return!0===rspkr.item("general.enableMathReading")}function s(){return!!rspkr.c.data.params&&(rspkr.c.data.params.dict="math",rspkr.c.data.params.rule="math",rspkr.c.data.params.xslrule="math",!0)}var n=!1,a=".MathJax, .MathJax_Preview, math, [id^=MathJax]";return{meta:{revision:"2489"},init:function(){},enabled:r,check:function(e){if(!r())return!1;if(!$rs.isArray(e))return!1;for(var t=0;t<e.length;t++)if(function(e){var t=rspkr.item("general.MathSelector")||a,r=$rs.findIn(e,t),r;if((r=$rs.isArray(r)?r:[r]).length>0)return true;return false}(e[t]))return n=!0,s();n=!1},found:function(){return!!r()&&n},addParams:s}}();