window.ReadSpeaker||(window.ReadSpeaker={}),window.ReadSpeaker.DocReader||(window.ReadSpeaker.DocReader={}),window.ReadSpeaker.DocReader.AutoAdd=function(){function e(){return r||(r=!0,(i={params:{cid:"[[CID]]",lang:rspkr.uiLang()||"en_us"},documents:[{sel:"a",filter:'[href$=".pdf"], [href$=".doc"], [href$=".docx"], [href$=".odt"], [href$=".ppt"], [href$=".pptx"], [href$=".xls"], [href$=".xlsx"], [href$=".epub"], [href$=".rtf"], [href$="type=drlink"], [href$="type=pdf"]',hrefAttr:"href",excludeFilter:'div[id*="speed_grader_submission_comments_download_mount_point"] a, [href*="draftfile.php"], [href*="#"]'},{sel:"a",filter:'.ef-name-col__link[href*="/files/"], .inline_disabled.preview_in_overlay[href*="/files/"]',filterText:[".pdf",".doc",".docx",".odt",".ppt",".pptx",".xls",".xlsx",".epub",".rtf"],hrefAttr:function(e,r){var e=$rs.getAttr(e,"href");e.match(/files\/(\d+)/)&&e.match(/files\/(\d+)/)[1]?(e="/api/v1/files/"+e.match(/files\/(\d+)/)[1]+"/public_url",jQuery.ajax(e).done(function(e){r(e.public_url)})):r(!1)}},{sel:"a",filter:'[download][href*="/files/"]',hrefAttr:function(e,r){var e=$rs.getAttr(e,"href");e.match(/files\/(\d+)/)&&e.match(/files\/(\d+)/)[1]?(e="/api/v1/files/"+e.match(/files\/(\d+)/)[1]+"/public_url",jQuery.ajax(e).done(function(e){r(e.public_url)})):r(!1)}},{sel:"a",filter:'img[src*="document"], img[src*="epub"], img[src*="pdf"], img[src*="spreadsheet"], img[src*="powerpoint"], img[src*="writer"], img[src*="calc"]',excludeFilter:'[href*="draftfile.php"], [href*="#"]',hrefAttr:"href",addParam:"&redirect=1"},{sel:'a[href*="attachment"]',filterText:[".pdf",".doc",".docx",".odt",".ppt",".pptx",".xls",".xlsx",".epub",".rtf"],excludeFilter:'[href*="draftfile.php"], [href*="#"]',hrefAttr:"href",addParam:"&redirect=1"},{sel:".modtype_resource.media a, .snap-asset-link a.mod-link",filter:'a[href*="/resource/"]',excludeFilter:'[href*="draftfile.php"], [href*="#"]',hrefAttr:"href",addParam:"&redirect=1",addCss:{position:"absolute","z-index":"2"}},{sel:"a",filter:'a[href*="/bbcswebdav/"] img[alt*="File"], a[href*="/bbcswebdav/"][onclick*="this.href"]',hrefAttr:"href",excludeText:["mp3","zip","mp4"]}],iconBeforeLink:!1,useHrefLang:!0,imgHref:!1,docReaderLink:"https://docreader.readspeaker.com/docreader/?",proxypath:!!$rs.arr("#rs_Req_blackboard")[0]&&($rs.getAttr("#rs_Req_blackboard","data-rsvalue-uristem")+"open2.jsp"||"/webapps/rs-readspeaker-bb_bb60/open2.jsp"),proxydocument:!!(window.rsConf&&window.rsConf.moodle&&window.rsDocReaderConf&&window.rsDocReaderConf.proxypath)&&window.rsDocReaderConf.proxypath+"?stage=fetch&url=",useProxyExternal:!1,iconClass:"rspkr_dr_link",iconAttr:{target:"_blank"},matchedClass:"rspkr_dr_added",phrases:{en:decodeURIComponent("Open%20this%20document%20with%20ReadSpeaker%20docReader"),ca_es:decodeURIComponent("Obre%20aquest%20document%20utilitzant%20ReadSpeaker%20docReader"),de_de:decodeURIComponent("Dieses%20Dokument%20mit%20ReadSpeaker%20docReader%20%C3%B6ffnen"),es_es:decodeURIComponent("Abrir%20este%20documento%20utilizando%20ReadSpeaker%20docReader"),es_mx:decodeURIComponent("Abrir%20este%20documento%20utilizando%20el%20ReadSpeaker%20docReader"),eu_es:decodeURIComponent("Ireki%20dokumentu%20hau%20ReadSpeaker%20docReader-en%20bidez"),fi_fi:decodeURIComponent("Avaa%20t%C3%A4m%C3%A4%20dokumentti%20ReadSpeaker%20docReaderill%C3%A4"),fr_fr:decodeURIComponent("Ouvrez%20ce%20document%20avec%20ReadSpeaker%20docReader"),gl_es:decodeURIComponent("Abre%20este%20documento%20con%20ReadSpeaker%20docReader"),it_it:decodeURIComponent("Apri%20questo%20documento%20con%20ReadSpeaker%20docReader"),nl:decodeURIComponent("Open%20dit%20document%20met%20ReadSpeaker%20docReader"),no_nb:decodeURIComponent("%C3%85pne%20dette%20dokumentet%20med%20Readspeaker%20docReader"),pl_pl:decodeURIComponent("Pos%C5%82uchaj%20zawarto%C5%9Bci%20strony"),pt:decodeURIComponent("Abra%20este%20documento%20com%20o%20ReadSpeaker%20docReader"),pt_pt:decodeURIComponent("Abra%20este%20documento%20com%20o%20ReadSpeaker%20docReader"),sv:decodeURIComponent("%C3%96ppna%20detta%20dokument%20med%20ReadSpeaker%20docReader")}}).phrases.en_us=i.phrases.en_au=i.phrases.en_uk=i.phrases.en,i.phrases.nl_nl=i.phrases.nl_be=i.phrases.nl,i.phrases.pt_pt=i.phrases.pt_br=i.phrases.pt,i.phrases.sv_se=i.phrases.sv_fi=i.phrases.sv,rspkr.item("docReader")&&rspkr.pub.c.mergeObj(rspkr.item("docReader"),i),function(){window.rsDocReaderConf&&rspkr.pub.c.mergeObj(window.rsDocReaderConf,i);var e,r={img_alt:"phrases",img_href:"imgHref",drAddedClass:"matchedClass",drBeforeLink:"iconBeforeLink",drClass:"iconClass"};for(e in r)r.hasOwnProperty(e)&&i[e]&&(i[r[e]]=i[e]);if(i.cid&&(i.params.cid=i.cid),i.lang&&(i.params.lang=i.lang),i.doc_list){for(var t=[],a=0;a<i.doc_list.length;a++)t.push('[href$="'+i.doc_list[a].replace("\\","")+'"]');i.documents.push({sel:"a",filter:t.join(", "),hrefAttr:"href"})}}(),t.run()),!0}var i,r=!1,d={getElements:function(e,a){if(0===e.length)return[];var n=[];return e.forEach(function(e){for(var r=a?$rs.findIn(a,e.sel):$rs.arr(e.sel),t=r.length;t--;)($rs.hasClass(r[t],i.matchedClass)||$rs.hasClass(r[t],i.iconClass)||e.filter&&!d.match(r[t],e.filter)||e.excludeFilter&&d.match(r[t],e.excludeFilter)||e.filterText&&!r[t].innerText.match(new RegExp(e.filterText.join("|")),"g")||e.excludeText&&r[t].innerText.match(new RegExp(e.excludeText.join("|")),"g"))&&r.splice(t,1);n=n.concat(r)}),n},match:function(e,r){if(e.matches(r))return!0;var r=$rs.findIn(e,r);return 0<(r=$rs.isArray(r)?r:[r]).length}},o={click:function(e){return window.open(this.href),rspkr.preventDefault(e),!1},addAll:function(){i.documents.forEach(function(r){for(var e,t=d.getElements([r]),a=0;a<t.length;a++)"function"==typeof r.hrefAttr?r.hrefAttr(t[a],function(e){e&&o.add(this,e+(r.addParam||""),r)}.bind(t[a])):(e=$rs.getAttr(t[a],r.hrefAttr),o.add(t[a],e+(r.addParam||""),r))})},add:function(e,r,t){function a(e){return i.phrases[e]||i.phrases.en_us}if($rs.hasClass(e,i.matchedClass))return!1;var n=i.iconAttr,d=!!i.useHrefLang&&$rs.getAttr(e,"hreflang");n.href=o.generateURL(r,d,t);var s=$rs.createElm("a",{cls:i.iconClass,attributes:i.iconAttr,content:i.imgHref?'<img class="rspkr_dr_img" data-rslang="alt:drlisten" alt="'+a(i.params.lang)+'" src="'+i.imgHref+'" />':['<span class="rsbtn_btnlabel" data-rslang="content:drlisten">'+a(i.params.lang)+"</span>",'<span class="rsicn rsicn-listen-icon"></span>'].join("\n")});return $rs.setAttr(s,"aria-label",a(i.params.lang)),$rs.setAttr(s,"title",a(i.params.lang)),$rs.setAttr(s,"data-rslang","title/arialabel:drlisten"),t.addCss&&Object.keys(t.addCss).forEach(function(e){t.addCss.hasOwnProperty(e)&&$rs.css(s,e,t.addCss[e])}),rspkr.Lang&&rspkr.Lang.updateUi(s),$rs.regEvent(s,"click",o.click),i.iconBeforeLink?e.parentElement.insertBefore(s,e):e.parentElement.insertBefore(s,e.nextSibling),$rs.addClass(e,i.matchedClass),!0},generateURL:function(e,r,t){function a(e){if("function"==typeof window.URL)return new URL(e,document.baseURI).href;var r=document.createElement("a");return r.href=e,r.href}var n=i.docReaderLink,d=i.params,s=!0;Object.keys(d).forEach(function(e){d.hasOwnProperty(e)&&(s?s=!1:n+="&",n+=e+"="+("lang"===e&&r?r:d[e]))});var o=document.createElement("a");return o.href=e,i.proxypath&&o.hostname===document.location.hostname||i.proxypath&&i.useProxyExternal&&o.hostname!==document.location.hostname?(i.proxydocument?(n=i.proxydocument+encodeURIComponent(a(e)),o.href=n,n=o.href):n+="&url="+encodeURIComponent(a(e)),n=i.proxypath+"?cid="+i.params.cid+"&lang="+(r||i.params.lang)+"&url="+encodeURIComponent(n)):n+="&url="+encodeURIComponent(a(e)),n}},t={pid:!1,stopTimer:!1,run:function(){o.addAll(),t.stopTimer||(t.pid=setTimeout(t.run,200))}};return ReadSpeaker.p(function(){e()}),ReadSpeaker.q(function(){var e,r={};for(e in i.phrases)i.phrases.hasOwnProperty(e)&&(r[e]={drlisten:i.phrases[e]});rspkr.Lang.extendPhrases(r);var t=$rs.arr(i.iconsClass);0<t.length&&rspkr.Lang.updateUi(t)}),{init:e,addIcon:o.add,addAllIcons:o.addAll,settings:i,stopTimer:function(){t.stopTimer=!0},testConf:function(e){return e?d.getElements(e):d.getElements(i.documents)}}}();